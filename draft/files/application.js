/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */
function withTransitions(){this.hasTransitions=function(){return Modernizr.csstransitions},this.whichTransitionEnd=function(){var t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},e=t[Modernizr.prefixed("transition")];return e},this.whichTransitionDelay=function(){var t={WebkitTransition:"-webkit-transition-delay",MozTransition:"-moz-transition-delay",OTransition:"-o-transition-delay",msTransition:"-ms-transition-delay",transition:"transition-delay"},e=t[Modernizr.prefixed("transition")];return e},this.startTransition=function(t){(t||this.$node).addClass("transition")},this.delayTransition=function(t,e){t.css(this.whichTransitionDelay(),e+"s")},this.endTransition=function(t){(t||this.$node).removeClass("transition").css(this.whichTransitionDelay(),"0s")}}(function(){function t(t,e,i){for(var n=(i||0)-1,s=t?t.length:0;++n<s;)if(t[n]===e)return n;return-1}function e(e,i){var n=typeof i;if(e=e.cache,"boolean"==n||null==i)return e[i]?0:-1;"number"!=n&&"string"!=n&&(n="object");var s="number"==n?i:v+i;return e=(e=e[n])&&e[s],"object"==n?e&&t(e,i)>-1?0:-1:e?0:-1}function i(t){var e=this.cache,i=typeof t;if("boolean"==i||null==t)e[t]=!0;else{"number"!=i&&"string"!=i&&(i="object");var n="number"==i?t:v+t,s=e[i]||(e[i]={});"object"==i?(s[n]||(s[n]=[])).push(t):s[n]=!0}}function n(t){return t.charCodeAt(0)}function s(t,e){for(var i=t.criteria,n=e.criteria,s=-1,o=i.length;++s<o;){var r=i[s],a=n[s];if(r!==a){if(r>a||"undefined"==typeof r)return 1;if(a>r||"undefined"==typeof a)return-1}}return t.index-e.index}function o(t){var e=-1,n=t.length,s=t[0],o=t[n/2|0],r=t[n-1];if(s&&"object"==typeof s&&o&&"object"==typeof o&&r&&"object"==typeof r)return!1;var a=h();a["false"]=a["null"]=a["true"]=a.undefined=!1;var l=h();for(l.array=t,l.cache=a,l.push=i;++e<n;)l.push(t[e]);return l}function r(t){return"\\"+V[t]}function a(){return f.pop()||[]}function h(){return m.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function l(t){t.length=0,f.length<y&&f.push(t)}function c(t){var e=t.cache;e&&c(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,m.length<y&&m.push(t)}function u(t,e,i){e||(e=0),"undefined"==typeof i&&(i=t?t.length:0);for(var n=-1,s=i-e||0,o=Array(0>s?0:s);++n<s;)o[n]=t[e+n];return o}function d(i){function f(t){return t&&"object"==typeof t&&!Kn(t)&&Fn.call(t,"__wrapped__")?t:new m(t)}function m(t,e){this.__chain__=!!e,this.__wrapped__=t}function y(t){function e(){if(n){var t=u(n);Bn.apply(t,arguments)}if(this instanceof e){var o=W(i.prototype),r=i.apply(o,t||arguments);return Me(r)?r:o}return i.apply(s,t||arguments)}var i=t[0],n=t[2],s=t[4];return Qn(e,t),e}function V(t,e,i,n,s){if(i){var o=i(t);if("undefined"!=typeof o)return o}var r=Me(t);if(!r)return t;var h=En.call(t);if(!Y[h])return t;var c=Wn[h];switch(h){case O:case z:return new c(+t);case N:case U:return new c(t);case L:return o=c(t.source,T.exec(t)),o.lastIndex=t.lastIndex,o}var d=Kn(t);if(e){var p=!n;n||(n=a()),s||(s=a());for(var f=n.length;f--;)if(n[f]==t)return s[f];o=d?c(t.length):{}}else o=d?u(t):os({},t);return d&&(Fn.call(t,"index")&&(o.index=t.index),Fn.call(t,"input")&&(o.input=t.input)),e?(n.push(t),s.push(o),(d?Je:hs)(t,function(t,r){o[r]=V(t,e,i,n,s)}),p&&(l(n),l(s)),o):o}function W(t){return Me(t)?Pn(t):{}}function J(t,e,i){if("function"!=typeof t)return Qi;if("undefined"==typeof e||!("prototype"in t))return t;var n=t.__bindData__;if("undefined"==typeof n&&(Jn.funcNames&&(n=!t.name),n=n||!Jn.funcDecomp,!n)){var s=An.call(t);Jn.funcNames||(n=!S.test(s)),n||(n=M.test(s),Qn(t,n))}if(n===!1||n!==!0&&1&n[1])return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)};case 4:return function(i,n,s,o){return t.call(e,i,n,s,o)}}return Fi(t,e)}function Q(t){function e(){var t=h?r:this;if(s){var f=u(s);Bn.apply(f,arguments)}if((o||c)&&(f||(f=u(arguments)),o&&Bn.apply(f,o),c&&f.length<a))return n|=16,Q([i,d?n:-4&n,f,null,r,a]);if(f||(f=arguments),l&&(i=t[p]),this instanceof e){t=W(i.prototype);var m=i.apply(t,f);return Me(m)?m:t}return i.apply(t,f)}var i=t[0],n=t[1],s=t[2],o=t[3],r=t[4],a=t[5],h=1&n,l=2&n,c=4&n,d=8&n,p=i;return Qn(e,t),e}function K(i,n){var s=-1,r=he(),a=i?i.length:0,h=a>=w&&r===t,l=[];if(h){var u=o(n);u?(r=e,n=u):h=!1}for(;++s<a;){var d=i[s];r(n,d)<0&&l.push(d)}return h&&c(n),l}function te(t,e,i,n){for(var s=(n||0)-1,o=t?t.length:0,r=[];++s<o;){var a=t[s];if(a&&"object"==typeof a&&"number"==typeof a.length&&(Kn(a)||de(a))){e||(a=te(a,e,i));var h=-1,l=a.length,c=r.length;for(r.length+=l;++h<l;)r[c++]=a[h]}else i||r.push(a)}return r}function ee(t,e,i,n,s,o){if(i){var r=i(t,e);if("undefined"!=typeof r)return!!r}if(t===e)return 0!==t||1/t==1/e;var h=typeof t,c=typeof e;if(!(t!==t||t&&H[h]||e&&H[c]))return!1;if(null==t||null==e)return t===e;var u=En.call(t),d=En.call(e);if(u==F&&(u=P),d==F&&(d=P),u!=d)return!1;switch(u){case O:case z:return+t==+e;case N:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case L:case U:return t==xn(e)}var p=u==B;if(!p){var f=Fn.call(t,"__wrapped__"),m=Fn.call(e,"__wrapped__");if(f||m)return ee(f?t.__wrapped__:t,m?e.__wrapped__:e,i,n,s,o);if(u!=P)return!1;var g=t.constructor,v=e.constructor;if(g!=v&&!(De(g)&&g instanceof g&&De(v)&&v instanceof v)&&"constructor"in t&&"constructor"in e)return!1}var w=!s;s||(s=a()),o||(o=a());for(var y=s.length;y--;)if(s[y]==t)return o[y]==e;var _=0;if(r=!0,s.push(t),o.push(e),p){if(y=t.length,_=e.length,r=_==y,r||n)for(;_--;){var b=y,x=e[_];if(n)for(;b--&&!(r=ee(t[b],x,i,n,s,o)););else if(!(r=ee(t[_],x,i,n,s,o)))break}}else as(e,function(e,a,h){return Fn.call(h,a)?(_++,r=Fn.call(t,a)&&ee(t[a],e,i,n,s,o)):void 0}),r&&!n&&as(t,function(t,e,i){return Fn.call(i,e)?r=--_>-1:void 0});return s.pop(),o.pop(),w&&(l(s),l(o)),r}function ie(t,e,i,n,s){(Kn(e)?Je:hs)(e,function(e,o){var r,a,h=e,l=t[o];if(e&&((a=Kn(e))||ls(e))){for(var c=n.length;c--;)if(r=n[c]==e){l=s[c];break}if(!r){var u;i&&(h=i(l,e),(u="undefined"!=typeof h)&&(l=h)),u||(l=a?Kn(l)?l:[]:ls(l)?l:{}),n.push(e),s.push(l),u||ie(l,e,i,n,s)}}else i&&(h=i(l,e),"undefined"==typeof h&&(h=e)),"undefined"!=typeof h&&(l=h);t[o]=l})}function ne(t,e){return t+$n(Gn()*(e-t+1))}function se(i,n,s){var r=-1,h=he(),u=i?i.length:0,d=[],p=!n&&u>=w&&h===t,f=s||p?a():d;if(p){var m=o(f);h=e,f=m}for(;++r<u;){var g=i[r],v=s?s(g,r,i):g;(n?!r||f[f.length-1]!==v:h(f,v)<0)&&((s||p)&&f.push(v),d.push(g))}return p?(l(f.array),c(f)):s&&l(f),d}function oe(t){return function(e,i,n){var s={};i=f.createCallback(i,n,3);var o=-1,r=e?e.length:0;if("number"==typeof r)for(;++o<r;){var a=e[o];t(s,a,i(a,o,e),e)}else hs(e,function(e,n,o){t(s,e,i(e,n,o),o)});return s}}function re(t,e,i,n,s,o){var r=1&e,a=2&e,h=4&e,l=16&e,c=32&e;if(!a&&!De(t))throw new Cn;l&&!i.length&&(e&=-17,l=i=!1),c&&!n.length&&(e&=-33,c=n=!1);var d=t&&t.__bindData__;if(d&&d!==!0)return d=u(d),d[2]&&(d[2]=u(d[2])),d[3]&&(d[3]=u(d[3])),!r||1&d[1]||(d[4]=s),!r&&1&d[1]&&(e|=8),!h||4&d[1]||(d[5]=o),l&&Bn.apply(d[2]||(d[2]=[]),i),c&&Rn.apply(d[3]||(d[3]=[]),n),d[1]|=e,re.apply(null,d);var p=1==e||17===e?y:Q;return p([t,e,i,n,s,o])}function ae(t){return es[t]}function he(){var e=(e=f.indexOf)===vi?t:e;return e}function le(t){return"function"==typeof t&&kn.test(t)}function ce(t){var e,i;return t&&En.call(t)==P&&(e=t.constructor,!De(e)||e instanceof e)?(as(t,function(t,e){i=e}),"undefined"==typeof i||Fn.call(t,i)):!1}function ue(t){return is[t]}function de(t){return t&&"object"==typeof t&&"number"==typeof t.length&&En.call(t)==F||!1}function pe(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i=e,e=!1),V(t,e,"function"==typeof i&&J(i,n,1))}function fe(t,e,i){return V(t,!0,"function"==typeof e&&J(e,i,1))}function me(t,e){var i=W(t);return e?os(i,e):i}function ge(t,e,i){var n;return e=f.createCallback(e,i,3),hs(t,function(t,i,s){return e(t,i,s)?(n=i,!1):void 0}),n}function ve(t,e,i){var n;return e=f.createCallback(e,i,3),ye(t,function(t,i,s){return e(t,i,s)?(n=i,!1):void 0}),n}function we(t,e,i){var n=[];as(t,function(t,e){n.push(e,t)});var s=n.length;for(e=J(e,i,3);s--&&e(n[s--],n[s],t)!==!1;);return t}function ye(t,e,i){var n=ts(t),s=n.length;for(e=J(e,i,3);s--;){var o=n[s];if(e(t[o],o,t)===!1)break}return t}function _e(t){var e=[];return as(t,function(t,i){De(t)&&e.push(i)}),e.sort()}function be(t,e){return t?Fn.call(t,e):!1}function xe(t){for(var e=-1,i=ts(t),n=i.length,s={};++e<n;){var o=i[e];s[t[o]]=o}return s}function Ce(t){return t===!0||t===!1||t&&"object"==typeof t&&En.call(t)==O||!1}function je(t){return t&&"object"==typeof t&&En.call(t)==z||!1}function Te(t){return t&&1===t.nodeType||!1}function Se(t){var e=!0;if(!t)return e;var i=En.call(t),n=t.length;return i==B||i==U||i==F||i==P&&"number"==typeof n&&De(t.splice)?!n:(hs(t,function(){return e=!1}),e)}function Ee(t,e,i,n){return ee(t,e,"function"==typeof i&&J(i,n,2))}function ke(t){return Un(t)&&!Yn(parseFloat(t))}function De(t){return"function"==typeof t}function Me(t){return!(!t||!H[typeof t])}function $e(t){return Ie(t)&&t!=+t}function Ae(t){return null===t}function Ie(t){return"number"==typeof t||t&&"object"==typeof t&&En.call(t)==N||!1}function Fe(t){return t&&"object"==typeof t&&En.call(t)==L||!1}function Be(t){return"string"==typeof t||t&&"object"==typeof t&&En.call(t)==U||!1}function Oe(t){return"undefined"==typeof t}function ze(t,e,i){var n={};return e=f.createCallback(e,i,3),hs(t,function(t,i,s){n[i]=e(t,i,s)}),n}function Re(t){var e=arguments,i=2;if(!Me(t))return t;if("number"!=typeof e[2]&&(i=e.length),i>3&&"function"==typeof e[i-2])var n=J(e[--i-1],e[i--],2);else i>2&&"function"==typeof e[i-1]&&(n=e[--i]);for(var s=u(arguments,1,i),o=-1,r=a(),h=a();++o<i;)ie(t,s[o],n,r,h);return l(r),l(h),t}function Ne(t,e,i){var n={};if("function"!=typeof e){var s=[];as(t,function(t,e){s.push(e)}),s=K(s,te(arguments,!0,!1,1));for(var o=-1,r=s.length;++o<r;){var a=s[o];n[a]=t[a]}}else e=f.createCallback(e,i,3),as(t,function(t,i,s){e(t,i,s)||(n[i]=t)});return n}function Pe(t){for(var e=-1,i=ts(t),n=i.length,s=fn(n);++e<n;){var o=i[e];s[e]=[o,t[o]]}return s}function Le(t,e,i){var n={};if("function"!=typeof e)for(var s=-1,o=te(arguments,!0,!1,1),r=Me(t)?o.length:0;++s<r;){var a=o[s];a in t&&(n[a]=t[a])}else e=f.createCallback(e,i,3),as(t,function(t,i,s){e(t,i,s)&&(n[i]=t)});return n}function Ue(t,e,i,n){var s=Kn(t);if(null==i)if(s)i=[];else{var o=t&&t.constructor,r=o&&o.prototype;i=W(r)}return e&&(e=f.createCallback(e,n,4),(s?Je:hs)(t,function(t,n,s){return e(i,t,n,s)})),i}function Ye(t){for(var e=-1,i=ts(t),n=i.length,s=fn(n);++e<n;)s[e]=t[i[e]];return s}function Xe(t){for(var e=arguments,i=-1,n=te(e,!0,!1,1),s=e[2]&&e[2][e[1]]===t?1:n.length,o=fn(s);++i<s;)o[i]=t[n[i]];return o}function qe(t,e,i){var n=-1,s=he(),o=t?t.length:0,r=!1;return i=(0>i?qn(0,o+i):i)||0,Kn(t)?r=s(t,e,i)>-1:"number"==typeof o?r=(Be(t)?t.indexOf(e,i):s(t,e,i))>-1:hs(t,function(t){return++n>=i?!(r=t===e):void 0}),r}function He(t,e,i){var n=!0;e=f.createCallback(e,i,3);var s=-1,o=t?t.length:0;if("number"==typeof o)for(;++s<o&&(n=!!e(t[s],s,t)););else hs(t,function(t,i,s){return n=!!e(t,i,s)});return n}function Ve(t,e,i){var n=[];e=f.createCallback(e,i,3);var s=-1,o=t?t.length:0;if("number"==typeof o)for(;++s<o;){var r=t[s];e(r,s,t)&&n.push(r)}else hs(t,function(t,i,s){e(t,i,s)&&n.push(t)});return n}function Ge(t,e,i){e=f.createCallback(e,i,3);var n=-1,s=t?t.length:0;if("number"!=typeof s){var o;return hs(t,function(t,i,n){return e(t,i,n)?(o=t,!1):void 0}),o}for(;++n<s;){var r=t[n];if(e(r,n,t))return r}}function We(t,e,i){var n;return e=f.createCallback(e,i,3),Qe(t,function(t,i,s){return e(t,i,s)?(n=t,!1):void 0}),n}function Je(t,e,i){var n=-1,s=t?t.length:0;if(e=e&&"undefined"==typeof i?e:J(e,i,3),"number"==typeof s)for(;++n<s&&e(t[n],n,t)!==!1;);else hs(t,e);return t}function Qe(t,e,i){var n=t?t.length:0;if(e=e&&"undefined"==typeof i?e:J(e,i,3),"number"==typeof n)for(;n--&&e(t[n],n,t)!==!1;);else{var s=ts(t);n=s.length,hs(t,function(t,i,o){return i=s?s[--n]:--n,e(o[i],i,o)})}return t}function Ke(t,e){var i=u(arguments,2),n=-1,s="function"==typeof e,o=t?t.length:0,r=fn("number"==typeof o?o:0);return Je(t,function(t){r[++n]=(s?e:t[e]).apply(t,i)}),r}function Ze(t,e,i){var n=-1,s=t?t.length:0;if(e=f.createCallback(e,i,3),"number"==typeof s)for(var o=fn(s);++n<s;)o[n]=e(t[n],n,t);else o=[],hs(t,function(t,i,s){o[++n]=e(t,i,s)});return o}function ti(t,e,i){var s=-1/0,o=s;if("function"!=typeof e&&i&&i[e]===t&&(e=null),null==e&&Kn(t))for(var r=-1,a=t.length;++r<a;){var h=t[r];h>o&&(o=h)}else e=null==e&&Be(t)?n:f.createCallback(e,i,3),Je(t,function(t,i,n){var r=e(t,i,n);r>s&&(s=r,o=t)});return o}function ei(t,e,i){var s=1/0,o=s;if("function"!=typeof e&&i&&i[e]===t&&(e=null),null==e&&Kn(t))for(var r=-1,a=t.length;++r<a;){var h=t[r];o>h&&(o=h)}else e=null==e&&Be(t)?n:f.createCallback(e,i,3),Je(t,function(t,i,n){var r=e(t,i,n);s>r&&(s=r,o=t)});return o}function ii(t,e,i,n){if(!t)return i;var s=arguments.length<3;e=f.createCallback(e,n,4);var o=-1,r=t.length;if("number"==typeof r)for(s&&(i=t[++o]);++o<r;)i=e(i,t[o],o,t);else hs(t,function(t,n,o){i=s?(s=!1,t):e(i,t,n,o)});return i}function ni(t,e,i,n){var s=arguments.length<3;return e=f.createCallback(e,n,4),Qe(t,function(t,n,o){i=s?(s=!1,t):e(i,t,n,o)}),i}function si(t,e,i){return e=f.createCallback(e,i,3),Ve(t,function(t,i,n){return!e(t,i,n)})}function oi(t,e,i){if(t&&"number"!=typeof t.length&&(t=Ye(t)),null==e||i)return t?t[ne(0,t.length-1)]:p;var n=ri(t);return n.length=Hn(qn(0,e),n.length),n}function ri(t){var e=-1,i=t?t.length:0,n=fn("number"==typeof i?i:0);return Je(t,function(t){var i=ne(0,++e);n[e]=n[i],n[i]=t}),n}function ai(t){var e=t?t.length:0;return"number"==typeof e?e:ts(t).length}function hi(t,e,i){var n;e=f.createCallback(e,i,3);var s=-1,o=t?t.length:0;if("number"==typeof o)for(;++s<o&&!(n=e(t[s],s,t)););else hs(t,function(t,i,s){return!(n=e(t,i,s))});return!!n}function li(t,e,i){var n=-1,o=Kn(e),r=t?t.length:0,u=fn("number"==typeof r?r:0);for(o||(e=f.createCallback(e,i,3)),Je(t,function(t,i,s){var r=u[++n]=h();o?r.criteria=Ze(e,function(e){return t[e]}):(r.criteria=a())[0]=e(t,i,s),r.index=n,r.value=t}),r=u.length,u.sort(s);r--;){var d=u[r];u[r]=d.value,o||l(d.criteria),c(d)}return u}function ci(t){return t&&"number"==typeof t.length?u(t):Ye(t)}function ui(t){for(var e=-1,i=t?t.length:0,n=[];++e<i;){var s=t[e];s&&n.push(s)}return n}function di(t){return K(t,te(arguments,!0,!0,1))}function pi(t,e,i){var n=-1,s=t?t.length:0;for(e=f.createCallback(e,i,3);++n<s;)if(e(t[n],n,t))return n;return-1}function fi(t,e,i){var n=t?t.length:0;for(e=f.createCallback(e,i,3);n--;)if(e(t[n],n,t))return n;return-1}function mi(t,e,i){var n=0,s=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=f.createCallback(e,i,3);++o<s&&e(t[o],o,t);)n++}else if(n=e,null==n||i)return t?t[0]:p;return u(t,0,Hn(qn(0,n),s))}function gi(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=i&&(t=Ze(t,i,n)),te(t,e)}function vi(e,i,n){if("number"==typeof n){var s=e?e.length:0;n=0>n?qn(0,s+n):n||0}else if(n){var o=Si(e,i);return e[o]===i?o:-1}return t(e,i,n)}function wi(t,e,i){var n=0,s=t?t.length:0;if("number"!=typeof e&&null!=e){var o=s;for(e=f.createCallback(e,i,3);o--&&e(t[o],o,t);)n++}else n=null==e||i?1:e||n;return u(t,0,Hn(qn(0,s-n),s))}function yi(){for(var i=[],n=-1,s=arguments.length,r=a(),h=he(),u=h===t,d=a();++n<s;){var p=arguments[n];(Kn(p)||de(p))&&(i.push(p),r.push(u&&p.length>=w&&o(n?i[n]:d)))}var f=i[0],m=-1,g=f?f.length:0,v=[];t:for(;++m<g;){var y=r[0];if(p=f[m],(y?e(y,p):h(d,p))<0){for(n=s,(y||d).push(p);--n;)if(y=r[n],(y?e(y,p):h(i[n],p))<0)continue t;v.push(p)}}for(;s--;)y=r[s],y&&c(y);return l(r),l(d),v}function _i(t,e,i){var n=0,s=t?t.length:0;if("number"!=typeof e&&null!=e){var o=s;for(e=f.createCallback(e,i,3);o--&&e(t[o],o,t);)n++}else if(n=e,null==n||i)return t?t[s-1]:p;return u(t,qn(0,s-n))}function bi(t,e,i){var n=t?t.length:0;for("number"==typeof i&&(n=(0>i?qn(0,n+i):Hn(i,n-1))+1);n--;)if(t[n]===e)return n;return-1}function xi(t){for(var e=arguments,i=0,n=e.length,s=t?t.length:0;++i<n;)for(var o=-1,r=e[i];++o<s;)t[o]===r&&(zn.call(t,o--,1),s--);return t}function Ci(t,e,i){t=+t||0,i="number"==typeof i?i:+i||1,null==e&&(e=t,t=0);for(var n=-1,s=qn(0,Dn((e-t)/(i||1))),o=fn(s);++n<s;)o[n]=t,t+=i;return o}function ji(t,e,i){var n=-1,s=t?t.length:0,o=[];for(e=f.createCallback(e,i,3);++n<s;){var r=t[n];e(r,n,t)&&(o.push(r),zn.call(t,n--,1),s--)}return o}function Ti(t,e,i){if("number"!=typeof e&&null!=e){var n=0,s=-1,o=t?t.length:0;for(e=f.createCallback(e,i,3);++s<o&&e(t[s],s,t);)n++}else n=null==e||i?1:qn(0,e);return u(t,n)}function Si(t,e,i,n){var s=0,o=t?t.length:s;for(i=i?f.createCallback(i,n,1):Qi,e=i(e);o>s;){var r=s+o>>>1;i(t[r])<e?s=r+1:o=r}return s}function Ei(){return se(te(arguments,!0,!0))}function ki(t,e,i,n){return"boolean"!=typeof e&&null!=e&&(n=i,i="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=i&&(i=f.createCallback(i,n,3)),se(t,e,i)}function Di(t){return K(t,u(arguments,1))}function Mi(){for(var t=-1,e=arguments.length;++t<e;){var i=arguments[t];if(Kn(i)||de(i))var n=n?se(K(n,i).concat(K(i,n))):i}return n||[]}function $i(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,i=t?ti(ps(t,"length")):0,n=fn(0>i?0:i);++e<i;)n[e]=ps(t,e);return n}function Ai(t,e){var i=-1,n=t?t.length:0,s={};for(e||!n||Kn(t[0])||(e=[]);++i<n;){var o=t[i];e?s[o]=e[i]:o&&(s[o[0]]=o[1])}return s}function Ii(t,e){if(!De(e))throw new Cn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Fi(t,e){return arguments.length>2?re(t,17,u(arguments,2),null,e):re(t,1,null,null,e)}function Bi(t){for(var e=arguments.length>1?te(arguments,!0,!1,1):_e(t),i=-1,n=e.length;++i<n;){var s=e[i];t[s]=re(t[s],1,null,null,t)}return t}function Oi(t,e){return arguments.length>2?re(e,19,u(arguments,2),null,t):re(e,3,null,null,t)}function zi(){for(var t=arguments,e=t.length;e--;)if(!De(t[e]))throw new Cn;return function(){for(var e=arguments,i=t.length;i--;)e=[t[i].apply(this,e)];return e[0]}}function Ri(t,e){return e="number"==typeof e?e:+e||t.length,re(t,4,null,null,null,e)}function Ni(t,e,i){var n,s,o,r,a,h,l,c=0,u=!1,d=!0;if(!De(t))throw new Cn;if(e=qn(0,e)||0,i===!0){var f=!0;d=!1}else Me(i)&&(f=i.leading,u="maxWait"in i&&(qn(e,i.maxWait)||0),d="trailing"in i?i.trailing:d);var m=function(){var i=e-(ms()-r);if(0>=i){s&&Mn(s);var u=l;s=h=l=p,u&&(c=ms(),o=t.apply(a,n),h||s||(n=a=null))}else h=On(m,i)},g=function(){h&&Mn(h),s=h=l=p,(d||u!==e)&&(c=ms(),o=t.apply(a,n),h||s||(n=a=null))};return function(){if(n=arguments,r=ms(),a=this,l=d&&(h||!f),u===!1)var i=f&&!h;else{s||f||(c=r);var p=u-(r-c),v=0>=p;v?(s&&(s=Mn(s)),c=r,o=t.apply(a,n)):s||(s=On(g,p))}return v&&h?h=Mn(h):h||e===u||(h=On(m,e)),i&&(v=!0,o=t.apply(a,n)),!v||h||s||(n=a=null),o}}function Pi(t){if(!De(t))throw new Cn;var e=u(arguments,1);return On(function(){t.apply(p,e)},1)}function Li(t,e){if(!De(t))throw new Cn;var i=u(arguments,2);return On(function(){t.apply(p,i)},e)}function Ui(t,e){if(!De(t))throw new Cn;var i=function(){var n=i.cache,s=e?e.apply(this,arguments):v+arguments[0];return Fn.call(n,s)?n[s]:n[s]=t.apply(this,arguments)};return i.cache={},i}function Yi(t){var e,i;if(!De(t))throw new Cn;return function(){return e?i:(e=!0,i=t.apply(this,arguments),t=null,i)}}function Xi(t){return re(t,16,u(arguments,1))}function qi(t){return re(t,32,null,u(arguments,1))}function Hi(t,e,i){var n=!0,s=!0;if(!De(t))throw new Cn;return i===!1?n=!1:Me(i)&&(n="leading"in i?i.leading:n,s="trailing"in i?i.trailing:s),X.leading=n,X.maxWait=e,X.trailing=s,Ni(t,e,X)}function Vi(t,e){return re(e,16,[t])}function Gi(t){return function(){return t}}function Wi(t,e,i){var n=typeof t;if(null==t||"function"==n)return J(t,e,i);if("object"!=n)return en(t);var s=ts(t),o=s[0],r=t[o];return 1!=s.length||r!==r||Me(r)?function(e){for(var i=s.length,n=!1;i--&&(n=ee(e[s[i]],t[s[i]],null,!0)););return n}:function(t){var e=t[o];return r===e&&(0!==r||1/r==1/e)}}function Ji(t){return null==t?"":xn(t).replace(ss,ae)}function Qi(t){return t}function Ki(t,e,i){var n=!0,s=e&&_e(e);e&&(i||s.length)||(null==i&&(i=e),o=m,e=t,t=f,s=_e(e)),i===!1?n=!1:Me(i)&&"chain"in i&&(n=i.chain);var o=t,r=De(o);Je(s,function(i){var s=t[i]=e[i];r&&(o.prototype[i]=function(){var e=this.__chain__,i=this.__wrapped__,r=[i];Bn.apply(r,arguments);var a=s.apply(t,r);if(n||e){if(i===a&&Me(a))return this;a=new o(a),a.__chain__=e}return a})})}function Zi(){return i._=Sn,this}function tn(){}function en(t){return function(e){return e[t]}}function nn(t,e,i){var n=null==t,s=null==e;if(null==i&&("boolean"==typeof t&&s?(i=t,t=1):s||"boolean"!=typeof e||(i=e,s=!0)),n&&s&&(e=1),t=+t||0,s?(e=t,t=0):e=+e||0,i||t%1||e%1){var o=Gn();return Hn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return ne(t,e)}function sn(t,e){if(t){var i=t[e];return De(i)?t[e]():i}}function on(t,e,i){var n=f.templateSettings;t=xn(t||""),i=rs({},i,n);var s,o=rs({},i.imports,n.imports),a=ts(o),h=Ye(o),l=0,c=i.interpolate||D,u="__p += '",d=bn((i.escape||D).source+"|"+c.source+"|"+(c===E?j:D).source+"|"+(i.evaluate||D).source+"|$","g");t.replace(d,function(e,i,n,o,a,h){return n||(n=o),u+=t.slice(l,h).replace($,r),i&&(u+="' +\n__e("+i+") +\n'"),a&&(s=!0,u+="';\n"+a+";\n__p += '"),n&&(u+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=h+e.length,e}),u+="';\n";var m=i.variable,g=m;g||(m="obj",u="with ("+m+") {\n"+u+"\n}\n"),u=(s?u.replace(b,""):u).replace(x,"$1").replace(C,"$1;"),u="function("+m+") {\n"+(g?"":m+" || ("+m+" = {});\n")+"var __t, __p = '', __e = _.escape"+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}";var v="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+I++ +"]")+"\n*/";try{var w=vn(a,"return "+u+v).apply(p,h)}catch(y){throw y.source=u,y}return e?w(e):(w.source=u,w)}function rn(t,e,i){t=(t=+t)>-1?t:0;var n=-1,s=fn(t);for(e=J(e,i,1);++n<t;)s[n]=e(n);return s}function an(t){return null==t?"":xn(t).replace(ns,ue)}function hn(t){var e=++g;return xn(null==t?"":t)+e}function ln(t){return t=new m(t),t.__chain__=!0,t}function cn(t,e){return e(t),t}function un(){return this.__chain__=!0,this}function dn(){return xn(this.__wrapped__)}function pn(){return this.__wrapped__}i=i?Z.defaults(G.Object(),i,Z.pick(G,A)):G;var fn=i.Array,mn=i.Boolean,gn=i.Date,vn=i.Function,wn=i.Math,yn=i.Number,_n=i.Object,bn=i.RegExp,xn=i.String,Cn=i.TypeError,jn=[],Tn=_n.prototype,Sn=i._,En=Tn.toString,kn=bn("^"+xn(En).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Dn=wn.ceil,Mn=i.clearTimeout,$n=wn.floor,An=vn.prototype.toString,In=le(In=_n.getPrototypeOf)&&In,Fn=Tn.hasOwnProperty,Bn=jn.push,On=i.setTimeout,zn=jn.splice,Rn=jn.unshift,Nn=function(){try{var t={},e=le(e=_n.defineProperty)&&e,i=e(t,t,t)&&e}catch(n){}return i}(),Pn=le(Pn=_n.create)&&Pn,Ln=le(Ln=fn.isArray)&&Ln,Un=i.isFinite,Yn=i.isNaN,Xn=le(Xn=_n.keys)&&Xn,qn=wn.max,Hn=wn.min,Vn=i.parseInt,Gn=wn.random,Wn={};Wn[B]=fn,Wn[O]=mn,Wn[z]=gn,Wn[R]=vn,Wn[P]=_n,Wn[N]=yn,Wn[L]=bn,Wn[U]=xn,m.prototype=f.prototype;var Jn=f.support={};Jn.funcDecomp=!le(i.WinRTError)&&M.test(d),Jn.funcNames="string"==typeof vn.name,f.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:E,variable:"",imports:{_:f}},Pn||(W=function(){function t(){}return function(e){if(Me(e)){t.prototype=e;var n=new t;t.prototype=null}return n||i.Object()}}());var Qn=Nn?function(t,e){q.value=e,Nn(t,"__bindData__",q)}:tn,Kn=Ln||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&En.call(t)==B||!1},Zn=function(t){var e,i=t,n=[];if(!i)return n;if(!H[typeof t])return n;for(e in i)Fn.call(i,e)&&n.push(e);return n},ts=Xn?function(t){return Me(t)?Xn(t):[]}:Zn,es={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},is=xe(es),ns=bn("("+ts(is).join("|")+")","g"),ss=bn("["+ts(es).join("")+"]","g"),os=function(t,e,i){var n,s=t,o=s;if(!s)return o;var r=arguments,a=0,h="number"==typeof i?2:r.length;if(h>3&&"function"==typeof r[h-2])var l=J(r[--h-1],r[h--],2);else h>2&&"function"==typeof r[h-1]&&(l=r[--h]);for(;++a<h;)if(s=r[a],s&&H[typeof s])for(var c=-1,u=H[typeof s]&&ts(s),d=u?u.length:0;++c<d;)n=u[c],o[n]=l?l(o[n],s[n]):s[n];return o},rs=function(t,e,i){var n,s=t,o=s;if(!s)return o;for(var r=arguments,a=0,h="number"==typeof i?2:r.length;++a<h;)if(s=r[a],s&&H[typeof s])for(var l=-1,c=H[typeof s]&&ts(s),u=c?c.length:0;++l<u;)n=c[l],"undefined"==typeof o[n]&&(o[n]=s[n]);return o},as=function(t,e,i){var n,s=t,o=s;if(!s)return o;if(!H[typeof s])return o;e=e&&"undefined"==typeof i?e:J(e,i,3);for(n in s)if(e(s[n],n,t)===!1)return o;return o},hs=function(t,e,i){var n,s=t,o=s;if(!s)return o;if(!H[typeof s])return o;e=e&&"undefined"==typeof i?e:J(e,i,3);for(var r=-1,a=H[typeof s]&&ts(s),h=a?a.length:0;++r<h;)if(n=a[r],e(s[n],n,t)===!1)return o;return o},ls=In?function(t){if(!t||En.call(t)!=P)return!1;var e=t.valueOf,i=le(e)&&(i=In(e))&&In(i);return i?t==i||In(t)==i:ce(t)}:ce,cs=oe(function(t,e,i){Fn.call(t,i)?t[i]++:t[i]=1}),us=oe(function(t,e,i){(Fn.call(t,i)?t[i]:t[i]=[]).push(e)}),ds=oe(function(t,e,i){t[i]=e}),ps=Ze,fs=Ve,ms=le(ms=gn.now)&&ms||function(){return(new gn).getTime()},gs=8==Vn(_+"08")?Vn:function(t,e){return Vn(Be(t)?t.replace(k,""):t,e||0)};return f.after=Ii,f.assign=os,f.at=Xe,f.bind=Fi,f.bindAll=Bi,f.bindKey=Oi,f.chain=ln,f.compact=ui,f.compose=zi,f.constant=Gi,f.countBy=cs,f.create=me,f.createCallback=Wi,f.curry=Ri,f.debounce=Ni,f.defaults=rs,f.defer=Pi,f.delay=Li,f.difference=di,f.filter=Ve,f.flatten=gi,f.forEach=Je,f.forEachRight=Qe,f.forIn=as,f.forInRight=we,f.forOwn=hs,f.forOwnRight=ye,f.functions=_e,f.groupBy=us,f.indexBy=ds,f.initial=wi,f.intersection=yi,f.invert=xe,f.invoke=Ke,f.keys=ts,f.map=Ze,f.mapValues=ze,f.max=ti,f.memoize=Ui,f.merge=Re,f.min=ei,f.omit=Ne,f.once=Yi,f.pairs=Pe,f.partial=Xi,f.partialRight=qi,f.pick=Le,f.pluck=ps,f.property=en,f.pull=xi,f.range=Ci,f.reject=si,f.remove=ji,f.rest=Ti,f.shuffle=ri,f.sortBy=li,f.tap=cn,f.throttle=Hi,f.times=rn,f.toArray=ci,f.transform=Ue,f.union=Ei,f.uniq=ki,f.values=Ye,f.where=fs,f.without=Di,f.wrap=Vi,f.xor=Mi,f.zip=$i,f.zipObject=Ai,f.collect=Ze,f.drop=Ti,f.each=Je,f.eachRight=Qe,f.extend=os,f.methods=_e,f.object=Ai,f.select=Ve,f.tail=Ti,f.unique=ki,f.unzip=$i,Ki(f),f.clone=pe,f.cloneDeep=fe,f.contains=qe,f.escape=Ji,f.every=He,f.find=Ge,f.findIndex=pi,f.findKey=ge,f.findLast=We,f.findLastIndex=fi,f.findLastKey=ve,f.has=be,f.identity=Qi,f.indexOf=vi,f.isArguments=de,f.isArray=Kn,f.isBoolean=Ce,f.isDate=je,f.isElement=Te,f.isEmpty=Se,f.isEqual=Ee,f.isFinite=ke,f.isFunction=De,f.isNaN=$e,f.isNull=Ae,f.isNumber=Ie,f.isObject=Me,f.isPlainObject=ls,f.isRegExp=Fe,f.isString=Be,f.isUndefined=Oe,f.lastIndexOf=bi,f.mixin=Ki,f.noConflict=Zi,f.noop=tn,f.now=ms,f.parseInt=gs,f.random=nn,f.reduce=ii,f.reduceRight=ni,f.result=sn,f.runInContext=d,f.size=ai,f.some=hi,f.sortedIndex=Si,f.template=on,f.unescape=an,f.uniqueId=hn,f.all=He,f.any=hi,f.detect=Ge,f.findWhere=Ge,f.foldl=ii,f.foldr=ni,f.include=qe,f.inject=ii,Ki(function(){var t={};return hs(f,function(e,i){f.prototype[i]||(t[i]=e)}),t}(),!1),f.first=mi,f.last=_i,f.sample=oi,f.take=mi,f.head=mi,hs(f,function(t,e){var i="sample"!==e;f.prototype[e]||(f.prototype[e]=function(e,n){var s=this.__chain__,o=t(this.__wrapped__,e,n);return s||null!=e&&(!n||i&&"function"==typeof e)?new m(o,s):o})}),f.VERSION="2.4.1",f.prototype.chain=un,f.prototype.toString=dn,f.prototype.value=pn,f.prototype.valueOf=pn,Je(["join","pop","shift"],function(t){var e=jn[t];f.prototype[t]=function(){var t=this.__chain__,i=e.apply(this.__wrapped__,arguments);return t?new m(i,t):i}}),Je(["push","reverse","sort","unshift"],function(t){var e=jn[t];f.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Je(["concat","slice","splice"],function(t){var e=jn[t];f.prototype[t]=function(){return new m(e.apply(this.__wrapped__,arguments),this.__chain__)}}),f}var p,f=[],m=[],g=0,v=+new Date+"",w=75,y=40,_=" 	\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000",b=/\b__p \+= '';/g,x=/\b(__p \+=) '' \+/g,C=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,T=/\w*$/,S=/^\s*function[ \n\r\t]+\w/,E=/<%=([\s\S]+?)%>/g,k=RegExp("^["+_+"]*0+(?=.$)"),D=/($^)/,M=/\bthis\b/,$=/['\n\r\t\u2028\u2029\\]/g,A=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],I=0,F="[object Arguments]",B="[object Array]",O="[object Boolean]",z="[object Date]",R="[object Function]",N="[object Number]",P="[object Object]",L="[object RegExp]",U="[object String]",Y={};Y[R]=!1,Y[F]=Y[B]=Y[O]=Y[z]=Y[N]=Y[P]=Y[L]=Y[U]=!0;var X={leading:!1,maxWait:0,trailing:!1},q={configurable:!1,enumerable:!1,value:null,writable:!1},H={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},V={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},G=H[typeof window]&&window||this,W=H[typeof exports]&&exports&&!exports.nodeType&&exports,J=H[typeof module]&&module&&!module.nodeType&&module,Q=J&&J.exports===W&&W,K=H[typeof global]&&global;!K||K.global!==K&&K.window!==K||(G=K);var Z=d();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(G._=Z,define(function(){return Z})):W&&J?Q?(J.exports=Z)._=Z:W._=Z:G._=Z}).call(this),function(t){function e(){var t,e,i=Array.prototype.slice.call(arguments),s=[];"string"==typeof i[0]&&(t=i.shift()),o(i[0])&&(s=i.shift()),e=i.shift(),n[t]=[s,e]}function i(t){function e(e){var i=t.split("/"),n=e.split("/"),s=!1;for(i.pop();".."==n[0]&&i.length;)i.pop(),n.shift(),s=!0;return"."==n[0]&&(n.shift(),s=!0),s&&(n=i.concat(n)),n.join("/")}var o,a,h;return"undefined"==typeof s[t]&&(o=n[t],o&&(h=o[0],a=o[1],s[t]=a.apply(void 0,r(h,function(t){return i(e(t))})))),s[t]}var n={},s={},o=Array.isArray||function(t){return t.constructor==Array},r=Array.map||function(t,e,i){for(var n=0,s=t.length,o=[];s>n;n++)o.push(e.call(i,t[n]));return o};// Copyright 2013 Twitter, Inc
e("lib/utils",[],function(){"use strict";var t=[],e=100,i={isDomObj:function(t){return!(!t.nodeType&&t!==window)},toArray:function(e,i){return t.slice.call(e,i)},merge:function(){for(var t=arguments.length,e=0,i=new Array(t+1);t>e;e++)i[e+1]=arguments[e];return 0===t?{}:(i[0]={},i[i.length-1]===!0&&(i.pop(),i.unshift(!0)),$.extend.apply(void 0,i))},push:function(t,e,i){return t&&Object.keys(e||{}).forEach(function(n){if(t[n]&&i)throw new Error('utils.push attempted to overwrite "'+n+'" while running in protected mode');"object"==typeof t[n]&&"object"==typeof e[n]?this.push(t[n],e[n]):t[n]=e[n]},this),t},isEnumerable:function(t,e){return Object.keys(t).indexOf(e)>-1},compose:function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},uniqueArray:function(t){for(var e={},i=[],n=0,s=t.length;s>n;++n)e.hasOwnProperty(t[n])||(i.push(t[n]),e[t[n]]=1);return i},debounce:function(t,i,n){"number"!=typeof i&&(i=e);var s,o;return function(){var e=this,r=arguments,a=function(){s=null,n||(o=t.apply(e,r))},h=n&&!s;return clearTimeout(s),s=setTimeout(a,i),h&&(o=t.apply(e,r)),o}},throttle:function(t,i){"number"!=typeof i&&(i=e);var n,s,o,r,a,h,l=this.debounce(function(){a=r=!1},i);return function(){n=this,s=arguments;var e=function(){o=null,a&&(h=t.apply(n,s)),l()};return o||(o=setTimeout(e,i)),r?a=!0:(r=!0,h=t.apply(n,s)),l(),h}},countThen:function(t,e){return function(){return--t?void 0:e.apply(this,arguments)}},delegate:function(t){return function(e,i){var n,s=$(e.target);Object.keys(t).forEach(function(o){return!e.isPropagationStopped()&&(n=s.closest(o)).length?(i=i||{},i.el=n[0],t[o].apply(this,[e,i])):void 0},this)}},once:function(t){var e,i;return function(){return e?i:(i=t.apply(this,arguments),e=!0,i)}}};return i}),// Copyright 2013 Twitter, Inc
e("lib/debug",[],function(){"use strict";function t(e,i,n){n=n||{};var s=n.obj||window,o=n.path||(s==window?"window":""),r=Object.keys(s);r.forEach(function(n){(f[e]||e)(i,s,n)&&console.log([o,".",n].join(""),"->",["(",typeof s[n],")"].join(""),s[n]),"[object Object]"==Object.prototype.toString.call(s[n])&&s[n]!=s&&-1==o.split(".").indexOf(n)&&t(e,i,{obj:s[n],path:[o,n].join(".")})})}function e(e,i,n,s){i&&typeof n!=i?console.error([n,"must be",i].join(" ")):t(e,n,s)}function i(t,i){e("name","string",t,i)}function n(t,i){e("nameContains","string",t,i)}function s(t,i){e("type","function",t,i)}function o(t,i){e("value",null,t,i)}function r(t,i){e("valueCoerced",null,t,i)}function a(e,i){t(e,null,i)}function h(){var t=[].slice.call(arguments);w.eventNames.length||(w.eventNames=m),w.actions=t.length?t:m,d()}function l(){var t=[].slice.call(arguments);w.actions.length||(w.actions=m),w.eventNames=t.length?t:m,d()}function c(){w.actions=[],w.eventNames=[],d()}function u(){w.actions=m,w.eventNames=m,d()}function d(){window.localStorage&&(localStorage.setItem("logFilter_eventNames",w.eventNames),localStorage.setItem("logFilter_actions",w.actions))}function p(){var t={eventNames:window.localStorage&&localStorage.getItem("logFilter_eventNames")||g,actions:window.localStorage&&localStorage.getItem("logFilter_actions")||v};return Object.keys(t).forEach(function(e){var i=t[e];"string"==typeof i&&i!==m&&(t[e]=i.split(","))}),t}var f={name:function(t,e,i){return t==i},nameContains:function(t,e,i){return i.indexOf(t)>-1},type:function(t,e,i){return e[i]instanceof t},value:function(t,e,i){return e[i]===t},valueCoerced:function(t,e,i){return e[i]==t}},m="all",g=[],v=[],w=p();return{enable:function(t){this.enabled=!!t,t&&window.console&&(console.info("Booting in DEBUG mode"),console.info("You can configure event logging with DEBUG.events.logAll()/logNone()/logByName()/logByAction()")),window.DEBUG=this},find:{byName:i,byNameContains:n,byType:s,byValue:o,byValueCoerced:r,custom:a},events:{logFilter:w,logByAction:h,logByName:l,logAll:u,logNone:c}}}),// Copyright 2013 Twitter, Inc
e("lib/compose",["./utils","./debug"],function(t,e){"use strict";function i(t,e){if(o){var i=Object.create(null);Object.keys(t).forEach(function(n){if(r.indexOf(n)<0){var s=Object.getOwnPropertyDescriptor(t,n);s.writable=e,i[n]=s}}),Object.defineProperties(t,i)}}function n(t,e,i){var n;return o&&t.hasOwnProperty(e)?(n=Object.getOwnPropertyDescriptor(t,e).writable,Object.defineProperty(t,e,{writable:!0}),i.call(t),void Object.defineProperty(t,e,{writable:n})):void i.call(t)}function s(t,e){t.mixedIn=t.hasOwnProperty("mixedIn")?t.mixedIn:[],e.forEach(function(e){-1==t.mixedIn.indexOf(e)&&(i(t,!1),e.call(t),t.mixedIn.push(e))}),i(t,!0)}var o=e.enabled&&!t.isEnumerable(Object,"getOwnPropertyDescriptor"),r=["mixedIn"];if(o)try{Object.getOwnPropertyDescriptor(Object,"keys")}catch(a){o=!1}return{mixin:s,unlockProperty:n}}),// Copyright 2013 Twitter, Inc
e("lib/advice",["./compose"],function(t){"use strict";var e={around:function(t,e){return function(){var i=0,n=arguments.length,s=new Array(n+1);for(s[0]=t.bind(this);n>i;i++)s[i+1]=arguments[i];return e.apply(this,s)}},before:function(t,e){var i="function"==typeof e?e:e.obj[e.fnName];return function(){return i.apply(this,arguments),t.apply(this,arguments)}},after:function(t,e){var i="function"==typeof e?e:e.obj[e.fnName];return function(){var e=(t.unbound||t).apply(this,arguments);return i.apply(this,arguments),e}},withAdvice:function(){["before","after","around"].forEach(function(i){this[i]=function(n,s){t.unlockProperty(this,n,function(){return this[n]="function"==typeof this[n]?e[i](this[n],s):s,this[n]})}},this)}};return e}),// Copyright 2013 Twitter, Inc
e("lib/registry",[],function(){"use strict";function t(t,e){var i,n,s,o=e.length;return"function"==typeof e[o-1]&&(o-=1,s=e[o]),"object"==typeof e[o-1]&&(o-=1),2==o?(i=e[0],n=e[1]):(i=t.node,n=e[0]),{element:i,type:n,callback:s}}function e(t,e){return t.element==e.element&&t.type==e.type&&(null==e.callback||t.callback==e.callback)}function i(){function i(t){this.component=t,this.attachedTo=[],this.instances={},this.addInstance=function(t){var e=new n(t);return this.instances[t.identity]=e,this.attachedTo.push(t.node),e},this.removeInstance=function(t){delete this.instances[t.identity];var e=this.attachedTo.indexOf(t.node);e>-1&&this.attachedTo.splice(e,1),Object.keys(this.instances).length||s.removeComponentInfo(this)},this.isAttachedTo=function(t){return this.attachedTo.indexOf(t)>-1}}function n(t){this.instance=t,this.events=[],this.addBind=function(t){this.events.push(t),s.events.push(t)},this.removeBind=function(t){for(var i,n=0;i=this.events[n];n++)e(i,t)&&this.events.splice(n,1)}}var s=this;(this.reset=function(){this.components=[],this.allInstances={},this.events=[]}).call(this),this.addInstance=function(t){var e=this.findComponentInfo(t);e||(e=new i(t.constructor),this.components.push(e));var n=e.addInstance(t);return this.allInstances[t.identity]=n,e},this.removeInstance=function(t){var e=(this.findInstanceInfo(t),this.findComponentInfo(t));e&&e.removeInstance(t),delete this.allInstances[t.identity]},this.removeComponentInfo=function(t){var e=this.components.indexOf(t);e>-1&&this.components.splice(e,1)},this.findComponentInfo=function(t){for(var e,i=t.attachTo?t:t.constructor,n=0;e=this.components[n];n++)if(e.component===i)return e;return null},this.findInstanceInfo=function(t){return this.allInstances[t.identity]||null},this.getBoundEventNames=function(t){return this.findInstanceInfo(t).events.map(function(t){return t.type})},this.findInstanceInfoByNode=function(t){var e=[];return Object.keys(this.allInstances).forEach(function(i){var n=this.allInstances[i];n.instance.node===t&&e.push(n)},this),e},this.on=function(e){for(var i,n=s.findInstanceInfo(this),o=arguments.length,r=1,a=new Array(o-1);o>r;r++)a[r-1]=arguments[r];if(n){i=e.apply(null,a),i&&(a[a.length-1]=i);var h=t(this,a);n.addBind(h)}},this.off=function(){var i=t(this,arguments),n=s.findInstanceInfo(this);n&&n.removeBind(i);for(var o,r=0;o=s.events[r];r++)e(o,i)&&s.events.splice(r,1)},s.trigger=function(){},this.teardown=function(){s.removeInstance(this)},this.withRegistration=function(){this.after("initialize",function(){s.addInstance(this)}),this.around("on",s.on),this.after("off",s.off),window.DEBUG&&DEBUG.enabled&&this.after("trigger",s.trigger),this.after("teardown",{obj:s,fnName:"teardown"})}}return new i}),// Copyright 2013 Twitter, Inc
e("lib/base",["./utils","./registry","./debug"],function(t,e,i){"use strict";function n(t){t.events.slice().forEach(function(t){var e=[t.type];t.element&&e.unshift(t.element),"function"==typeof t.callback&&e.push(t.callback),this.off.apply(this,e)},t.instance)}function s(t,e){try{window.postMessage(e,"*")}catch(i){throw console.log("unserializable data for event",t,":",e),new Error(["The event",t,"on component",this.toString(),"was triggered with non-serializable data"].join(" "))}}function o(t){return function(e,i){$(e.target).trigger(t,i)}}function r(){this.trigger=function(){var t,e,n,o,r,a=arguments.length-1,h=arguments[a];return"string"==typeof h||h&&h.defaultBehavior||(a--,n=h),1==a?(t=$(arguments[0]),o=arguments[1]):(t=this.$node,o=arguments[0]),o.defaultBehavior&&(r=o.defaultBehavior,o=$.Event(o.type)),e=o.type||o,i.enabled&&window.postMessage&&s.call(this,e,n),"object"==typeof this.attr.eventData&&(n=$.extend(!0,{},this.attr.eventData,n)),t.trigger(o||e,n),r&&!o.isDefaultPrevented()&&(this[r]||r).call(this),t},this.on=function(){var e,i,n,s,r=arguments.length-1,a=arguments[r];if(s="object"==typeof a?t.delegate(this.resolveDelegateRules(a)):"string"==typeof a?o(a):a,2==r?(e=$(arguments[0]),i=arguments[1]):(e=this.$node,i=arguments[0]),"function"!=typeof s&&"object"!=typeof s)throw new Error('Unable to bind to "'+i+'" because the given callback is not a function or an object');return n=s.bind(this),n.target=s,n.context=this,e.on(i,n),s.bound||(s.bound=[]),s.bound.push(n),n},this.off=function(){var t,e,i,n=arguments.length-1;if("function"==typeof arguments[n]&&(i=arguments[n],n-=1),1==n?(t=$(arguments[0]),e=arguments[1]):(t=this.$node,e=arguments[0]),i){var s=i.target?i.target.bound:i.bound||[];s&&s.some(function(t,e,n){return t.context&&this.identity==t.context.identity?(n.splice(e,1),i=t,!0):void 0},this)}return t.off(e,i)},this.resolveDelegateRules=function(t){var e={};return Object.keys(t).forEach(function(i){if(!(i in this.attr))throw new Error('Component "'+this.toString()+'" wants to listen on "'+i+'" but no such attribute was defined.');e[this.attr[i]]="string"==typeof t[i]?o(t[i]):t[i]},this),e},this.defaultAttrs=function(e){t.push(this.defaults,e,!0)||(this.defaults=e)},this.select=function(t){return this.$node.find(this.attr[t])},this.initialize=function(t,e){if(e||(e={}),this.identity||(this.identity=a++),!t)throw new Error("Component needs a node");t.jquery?(this.node=t[0],this.$node=t):(this.node=t,this.$node=$(t));var i=Object.create(e);for(var n in this.defaults)e.hasOwnProperty(n)||(i[n]=this.defaults[n]);return this.attr=i,Object.keys(this.defaults||{}).forEach(function(t){if(null===this.defaults[t]&&null===this.attr[t])throw new Error('Required attribute "'+t+'" not specified in attachTo for component "'+this.toString()+'".')},this),this},this.teardown=function(){n(e.findInstanceInfo(this))}}var a=0;return r}),// Copyright 2013 Twitter, Inc
e("lib/logger",["./utils"],function(t){"use strict";function e(t){var e=t.tagName?t.tagName.toLowerCase():t.toString(),i=t.className?"."+t.className:"",n=e+i;return t.tagName?["'","'"].join(n):n}function i(t,i,n){if(window.DEBUG&&window.DEBUG.enabled){var o,r,a,h,l,c,u,d,p,f;"function"==typeof n[n.length-1]&&(h=n.pop(),h=h.unbound||h),1==n.length?(a=i.$node[0],r=n[0]):2!=n.length||"object"!=typeof n[1]||n[1].type?(a=n[0],r=n[1],"trigger"==t&&(l=n[2])):(a=i.$node[0],r=n[0],"trigger"==t&&(l=n[1])),o="object"==typeof r?r.type:r,c=DEBUG.events.logFilter,d="all"==c.actions||c.actions.indexOf(t)>-1,u=function(t){return t.test?t:new RegExp("^"+t.replace(/\*/g,".*")+"$")},p="all"==c.eventNames||c.eventNames.some(function(t){return u(t).test(o)}),d&&p&&(f=[s[t],t,"["+o+"]"],l&&f.push(l),f.push(e(a)),f.push(i.constructor.describe.split(" ").slice(0,3).join(" ")),console.info.apply(console,f))}}function n(){this.before("trigger",function(){i("trigger",this,t.toArray(arguments))}),this.before("on",function(){i("on",this,t.toArray(arguments))}),this.before("off",function(){i("off",this,t.toArray(arguments))})}var s={on:"<-",trigger:"->",off:"x "};return n}),// Copyright 2013 Twitter, Inc
e("lib/component",["./advice","./utils","./compose","./base","./registry","./logger","./debug"],function(t,e,i,n,s,o,r){"use strict";function a(){var t=s.findComponentInfo(this);t&&Object.keys(t.instances).forEach(function(e){var i=t.instances[e];i&&i.instance&&i.instance.teardown()})}function h(t){for(var i=arguments.length,n=new Array(i-1),o=1;i>o;o++)n[o-1]=arguments[o];if(!t)throw new Error("Component needs to be attachTo'd a jQuery object, native node or selector string");var r=e.merge.apply(e,n),a=s.findComponentInfo(this);$(t).each(function(t,e){a&&a.isAttachedTo(e)||(new this).initialize(e,r)}.bind(this))}function l(){for(var e=arguments.length,l=new Array(e+3),u=0;e>u;u++)l[u]=arguments[u];var d=function(){};return d.toString=d.prototype.toString=function(){var t=l.map(function(t){if(null==t.name){var e=t.toString().match(c);return e&&e[1]?e[1]:""}return"withBase"!=t.name?t.name:""}).filter(Boolean).join(", ");return t},r.enabled&&(d.describe=d.prototype.describe=d.toString()),d.attachTo=h,d.teardownAll=a,r.enabled&&l.unshift(o),l.unshift(n,t.withAdvice,s.withRegistration),i.mixin(d.prototype,l),d}var c=/function (.*?)\s?\(/;return l.teardownAll=function(){s.components.slice().forEach(function(t){t.component.teardownAll()}),s.reset()},l}),// Copyright 2013 Twitter, Inc
e("lib/index",["./advice","./component","./compose","./logger","./registry","./utils"],function(t,e,i,n,s,o){"use strict";return{advice:t,component:e,compose:i,logger:n,registry:s,utils:o}}),t.flight=i("lib/index")}(this),/*! Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.io/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
function(t,e){"use strict";function i(){n.READY||(w.determineEventTypes(),v.each(n.gestures,function(t){_.register(t)}),w.onTouch(n.DOCUMENT,p,_.detect),w.onTouch(n.DOCUMENT,f,_.detect),n.READY=!0)}var n=function b(t,e){return new b.Instance(t,e||{})};n.VERSION="1.1.3",n.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.DOCUMENT=document,n.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in t,n.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent),n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&n.IS_MOBILE||n.HAS_POINTEREVENTS,n.CALCULATE_INTERVAL=25;var s={},o=n.DIRECTION_DOWN="down",r=n.DIRECTION_LEFT="left",a=n.DIRECTION_UP="up",h=n.DIRECTION_RIGHT="right",l=n.POINTER_MOUSE="mouse",c=n.POINTER_TOUCH="touch",u=n.POINTER_PEN="pen",d=n.EVENT_START="start",p=n.EVENT_MOVE="move",f=n.EVENT_END="end",m=n.EVENT_RELEASE="release",g=n.EVENT_TOUCH="touch";n.READY=!1,n.plugins=n.plugins||{},n.gestures=n.gestures||{};var v=n.utils={extend:function(t,i,n){for(var s in i)!i.hasOwnProperty(s)||t[s]!==e&&n||(t[s]=i[s]);return t},on:function(t,e,i){t.addEventListener(e,i,!1)},off:function(t,e,i){t.removeEventListener(e,i,!1)},each:function(t,i,n){var s,o;if("forEach"in t)t.forEach(i,n);else if(t.length!==e){for(s=0,o=t.length;o>s;s++)if(i.call(n,t[s],s,t)===!1)return}else for(s in t)if(t.hasOwnProperty(s)&&i.call(n,t[s],s,t)===!1)return},inStr:function(t,e){return t.indexOf(e)>-1},inArray:function(t,e){if(t.indexOf){var i=t.indexOf(e);return-1===i?!1:i}for(var n=0,s=t.length;s>n;n++)if(t[n]===e)return n;return!1},toArray:function(t){return Array.prototype.slice.call(t,0)},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],i=[],n=[],s=[],o=Math.min,r=Math.max;return 1===t.length?{pageX:t[0].pageX,pageY:t[0].pageY,clientX:t[0].clientX,clientY:t[0].clientY}:(v.each(t,function(t){e.push(t.pageX),i.push(t.pageY),n.push(t.clientX),s.push(t.clientY)}),{pageX:(o.apply(Math,e)+r.apply(Math,e))/2,pageY:(o.apply(Math,i)+r.apply(Math,i))/2,clientX:(o.apply(Math,n)+r.apply(Math,n))/2,clientY:(o.apply(Math,s)+r.apply(Math,s))/2})},getVelocity:function(t,e,i){return{x:Math.abs(e/t)||0,y:Math.abs(i/t)||0}},getAngle:function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return 180*Math.atan2(n,i)/Math.PI},getDirection:function(t,e){var i=Math.abs(t.clientX-e.clientX),n=Math.abs(t.clientY-e.clientY);return i>=n?t.clientX-e.clientX>0?r:h:t.clientY-e.clientY>0?a:o},getDistance:function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(i*i+n*n)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==a||t==o},setPrefixedCss:function(t,e,i,n){var s=["","Webkit","Moz","O","ms"];e=v.toCamelCase(e);for(var o=0;o<s.length;o++){var r=e;if(s[o]&&(r=s[o]+r.slice(0,1).toUpperCase()+r.slice(1)),r in t.style){t.style[r]=(null==n||n)&&i||"";break}}},toggleBehavior:function(t,e,i){if(e&&t&&t.style){v.each(e,function(e,n){v.setPrefixedCss(t,n,e,i)});var n=i&&function(){return!1};"none"==e.userSelect&&(t.onselectstart=n),"none"==e.userDrag&&(t.ondragstart=n)}},toCamelCase:function(t){return t.replace(/[_-]([a-z])/g,function(t){return t[1].toUpperCase()})}},w=n.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(t,e,i,n){var s=e.split(" ");v.each(s,function(e){v.on(t,e,i),n&&n(e)})},off:function(t,e,i,n){var s=e.split(" ");v.each(s,function(e){v.off(t,e,i),n&&n(e)})},onTouch:function(t,e,i){var o=this,r=function(s){var r,a=s.type.toLowerCase(),h=n.HAS_POINTEREVENTS,l=v.inStr(a,"mouse");l&&o.preventMouseEvents||(l&&e==d&&0===s.button?(o.preventMouseEvents=!1,o.shouldDetect=!0):h&&e==d?o.shouldDetect=1===s.buttons||y.matchType(c,s):l||e!=d||(o.preventMouseEvents=!0,o.shouldDetect=!0),h&&e!=f&&y.updatePointer(e,s),o.shouldDetect&&(r=o.doDetect.call(o,s,e,t,i)),r==f&&(o.preventMouseEvents=!1,o.shouldDetect=!1,y.reset()),h&&e==f&&y.updatePointer(e,s))};return this.on(t,s[e],r),r},doDetect:function(t,e,i,n){var s=this.getTouchList(t,e),o=s.length,r=e,a=s.trigger,h=o;e==d?a=g:e==f&&(a=m,h=s.length-(t.changedTouches?t.changedTouches.length:1)),h>0&&this.started&&(r=p),this.started=!0;var l=this.collectEventData(i,r,s,t);return e!=f&&n.call(_,l),a&&(l.changedLength=h,l.eventType=a,n.call(_,l),l.eventType=r,delete l.changedLength),r==f&&(n.call(_,l),this.started=!1),r},determineEventTypes:function(){var e;return e=n.HAS_POINTEREVENTS?t.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],s[d]=e[0],s[p]=e[1],s[f]=e[2],s},getTouchList:function(t,e){if(n.HAS_POINTEREVENTS)return y.getTouchList();if(t.touches){if(e==p)return t.touches;var i=[],s=[].concat(v.toArray(t.touches),v.toArray(t.changedTouches)),o=[];return v.each(s,function(t){v.inArray(i,t.identifier)===!1&&o.push(t),i.push(t.identifier)}),o}return t.identifier=1,[t]},collectEventData:function(t,e,i,n){var s=c;return v.inStr(n.type,"mouse")||y.matchType(l,n)?s=l:y.matchType(u,n)&&(s=u),{center:v.getCenter(i),timeStamp:Date.now(),target:n.target,touches:i,eventType:e,pointerType:s,srcEvent:n,preventDefault:function(){var t=this.srcEvent;t.preventManipulation&&t.preventManipulation(),t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return _.stopDetect()}}}},y=n.PointerEvent={pointers:{},getTouchList:function(){var t=[];return v.each(this.pointers,function(e){t.push(e)}),t},updatePointer:function(t,e){t==f||t!=f&&1!==e.buttons?delete this.pointers[e.pointerId]:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e)},matchType:function(t,e){if(!e.pointerType)return!1;var i=e.pointerType,n={};return n[l]=i===(e.MSPOINTER_TYPE_MOUSE||l),n[c]=i===(e.MSPOINTER_TYPE_TOUCH||c),n[u]=i===(e.MSPOINTER_TYPE_PEN||u),n[t]},reset:function(){this.pointers={}}},_=n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:v.extend({},e),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst,i=e.options;return v.each(this.gestures,function(n){!this.stopped&&e.enabled&&i[n.name]&&n.handler.call(n,t,e)},this),this.current&&(this.current.lastEvent=t),t.eventType==f&&this.stopDetect(),t}},stopDetect:function(){this.previous=v.extend({},this.current),this.current=null,this.stopped=!0},getCalculatedData:function(t,e,i,s,o){var r=this.current,a=!1,h=r.lastCalcEvent,l=r.lastCalcData;h&&t.timeStamp-h.timeStamp>n.CALCULATE_INTERVAL&&(e=h.center,i=t.timeStamp-h.timeStamp,s=t.center.clientX-h.center.clientX,o=t.center.clientY-h.center.clientY,a=!0),(t.eventType==g||t.eventType==m)&&(r.futureCalcEvent=t),(!r.lastCalcEvent||a)&&(l.velocity=v.getVelocity(i,s,o),l.angle=v.getAngle(e,t.center),l.direction=v.getDirection(e,t.center),r.lastCalcEvent=r.futureCalcEvent||t,r.futureCalcEvent=t),t.velocityX=l.velocity.x,t.velocityY=l.velocity.y,t.interimAngle=l.angle,t.interimDirection=l.direction},extendEventData:function(t){var e=this.current,i=e.startEvent,n=e.lastEvent||i;(t.eventType==g||t.eventType==m)&&(i.touches=[],v.each(t.touches,function(t){i.touches.push({clientX:t.clientX,clientY:t.clientY})}));var s=t.timeStamp-i.timeStamp,o=t.center.clientX-i.center.clientX,r=t.center.clientY-i.center.clientY;return this.getCalculatedData(t,n.center,s,o,r),v.extend(t,{startEvent:i,deltaTime:s,deltaX:o,deltaY:r,distance:v.getDistance(i.center,t.center),angle:v.getAngle(i.center,t.center),direction:v.getDirection(i.center,t.center),scale:v.getScale(i.touches,t.touches),rotation:v.getRotation(i.touches,t.touches)}),t},register:function(t){var i=t.defaults||{};return i[t.name]===e&&(i[t.name]=!0),v.extend(n.defaults,i,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}};n.Instance=function(t,e){var s=this;i(),this.element=t,this.enabled=!0,v.each(e,function(t,i){delete e[i],e[v.toCamelCase(i)]=t}),this.options=v.extend(v.extend({},n.defaults),e||{}),this.options.behavior&&v.toggleBehavior(this.element,this.options.behavior,!0),this.eventStartHandler=w.onTouch(t,d,function(t){s.enabled&&t.eventType==d?_.startDetect(s,t):t.eventType==g&&_.detect(t)}),this.eventHandlers=[]},n.Instance.prototype={on:function(t,e){var i=this;return w.on(i.element,t,e,function(t){i.eventHandlers.push({gesture:t,handler:e})}),i},off:function(t,e){var i=this;return w.off(i.element,t,e,function(t){var n=v.inArray({gesture:t,handler:e});n!==!1&&i.eventHandlers.splice(n,1)}),i},trigger:function(t,e){e||(e={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e;var s=this.element;return v.hasParent(e.target,s)&&(s=e.target),s.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this},dispose:function(){var t,e;for(v.toggleBehavior(this.element,this.options.behavior,!1),t=-1;e=this.eventHandlers[++t];)v.off(this.element,e.gesture,e.handler);return this.eventHandlers=[],w.off(this.element,s[d],this.eventStartHandler),null}},function(t){function e(e,n){var s=_.current;if(!(n.options.dragMaxTouches>0&&e.touches.length>n.options.dragMaxTouches))switch(e.eventType){case d:i=!1;break;case p:if(e.distance<n.options.dragMinDistance&&s.name!=t)return;var l=s.startEvent.center;if(s.name!=t&&(s.name=t,n.options.dragDistanceCorrection&&e.distance>0)){var c=Math.abs(n.options.dragMinDistance/e.distance);l.pageX+=e.deltaX*c,l.pageY+=e.deltaY*c,l.clientX+=e.deltaX*c,l.clientY+=e.deltaY*c,e=_.extendEventData(e)}(s.lastEvent.dragLockToAxis||n.options.dragLockToAxis&&n.options.dragLockMinDistance<=e.distance)&&(e.dragLockToAxis=!0);var u=s.lastEvent.direction;e.dragLockToAxis&&u!==e.direction&&(e.direction=v.isVertical(u)?e.deltaY<0?a:o:e.deltaX<0?r:h),i||(n.trigger(t+"start",e),i=!0),n.trigger(t,e),n.trigger(t+e.direction,e);var g=v.isVertical(e.direction);(n.options.dragBlockVertical&&g||n.options.dragBlockHorizontal&&!g)&&e.preventDefault();break;case m:i&&e.changedLength<=n.options.dragMaxTouches&&(n.trigger(t+"end",e),i=!1);break;case f:i=!1}}var i=!1;n.gestures.Drag={name:t,index:50,handler:e,defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag"),n.gestures.Gesture={name:"gesture",index:1337,handler:function(t,e){e.trigger(this.name,t)}},function(t){function e(e,n){var s=n.options,o=_.current;switch(e.eventType){case d:clearTimeout(i),o.name=t,i=setTimeout(function(){o&&o.name==t&&n.trigger(t,e)},s.holdTimeout);break;case p:e.distance>s.holdThreshold&&clearTimeout(i);break;case m:clearTimeout(i)}}var i;n.gestures.Hold={name:t,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:e}}("hold"),n.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==m&&e.trigger(this.name,t)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(t,e){if(t.eventType==m){var i=t.touches.length,n=e.options;if(i<n.swipeMinTouches||i>n.swipeMaxTouches)return;(t.velocityX>n.swipeVelocityX||t.velocityY>n.swipeVelocityY)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},function(t){function e(e,n){var s,o,r=n.options,a=_.current,h=_.previous;switch(e.eventType){case d:i=!1;break;case p:i=i||e.distance>r.tapMaxDistance;break;case f:!v.inStr(e.srcEvent.type,"cancel")&&e.deltaTime<r.tapMaxTime&&!i&&(s=h&&h.lastEvent&&e.timeStamp-h.lastEvent.timeStamp,o=!1,h&&h.name==t&&s&&s<r.doubleTapInterval&&e.distance<r.doubleTapDistance&&(n.trigger("doubletap",e),o=!0),(!o||r.tapAlways)&&(a.name=t,n.trigger(a.name,e)))}}var i=!1;n.gestures.Tap={name:t,index:100,handler:e,defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap"),n.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(t,e){return e.options.preventMouse&&t.pointerType==l?void t.stopDetect():(e.options.preventDefault&&t.preventDefault(),void(t.eventType==g&&e.trigger("touch",t)))}},function(t){function e(e,n){switch(e.eventType){case d:i=!1;break;case p:if(e.touches.length<2)return;var s=Math.abs(1-e.scale),o=Math.abs(e.rotation);if(s<n.options.transformMinScale&&o<n.options.transformMinRotation)return;_.current.name=t,i||(n.trigger(t+"start",e),i=!0),n.trigger(t,e),o>n.options.transformMinRotation&&n.trigger("rotate",e),s>n.options.transformMinScale&&(n.trigger("pinch",e),n.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case m:i&&e.changedLength<2&&(n.trigger(t+"end",e),i=!1)}}var i=!1;n.gestures.Transform={name:t,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:e}}("transform"),"function"==typeof define&&define.amd?define(function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:t.Hammer=n}(window),/*! jQuery plugin for Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
function(t,e){"use strict";function i(){s.READY||(y.determineEventTypes(),w.each(s.gestures,function(t){b.register(t)}),y.onTouch(s.DOCUMENT,f,b.detect),y.onTouch(s.DOCUMENT,m,b.detect),s.READY=!0)}function n(t,i){Date.now||(Date.now=function(){return(new Date).getTime()}),t.utils.each(["on","off"],function(n){t.utils[n]=function(t,s,o){i(t)[n](s,function(t){var n=i.extend({},t.originalEvent,t);n.button===e&&(n.button=t.which-1),o.call(this,n)})}}),t.Instance.prototype.trigger=function(t,e){var n=i(this.element);return n.has(e.target).length&&(n=i(e.target)),n.trigger({type:t,gesture:e})},i.fn.hammer=function(e){return this.each(function(){var n=i(this),s=n.data("hammer");s?s&&e&&t.utils.extend(s.options,e):n.data("hammer",new t(this,e||{}))})}}var s=function x(t,e){return new x.Instance(t,e||{})};s.VERSION="1.1.3",s.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},s.DOCUMENT=document,s.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,s.HAS_TOUCHEVENTS="ontouchstart"in t,s.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent),s.NO_MOUSEEVENTS=s.HAS_TOUCHEVENTS&&s.IS_MOBILE||s.HAS_POINTEREVENTS,s.CALCULATE_INTERVAL=25;var o={},r=s.DIRECTION_DOWN="down",a=s.DIRECTION_LEFT="left",h=s.DIRECTION_UP="up",l=s.DIRECTION_RIGHT="right",c=s.POINTER_MOUSE="mouse",u=s.POINTER_TOUCH="touch",d=s.POINTER_PEN="pen",p=s.EVENT_START="start",f=s.EVENT_MOVE="move",m=s.EVENT_END="end",g=s.EVENT_RELEASE="release",v=s.EVENT_TOUCH="touch";s.READY=!1,s.plugins=s.plugins||{},s.gestures=s.gestures||{};var w=s.utils={extend:function(t,i,n){for(var s in i)!i.hasOwnProperty(s)||t[s]!==e&&n||(t[s]=i[s]);return t},on:function(t,e,i){t.addEventListener(e,i,!1)},off:function(t,e,i){t.removeEventListener(e,i,!1)},each:function(t,i,n){var s,o;if("forEach"in t)t.forEach(i,n);else if(t.length!==e){for(s=0,o=t.length;o>s;s++)if(i.call(n,t[s],s,t)===!1)return}else for(s in t)if(t.hasOwnProperty(s)&&i.call(n,t[s],s,t)===!1)return},inStr:function(t,e){return t.indexOf(e)>-1},inArray:function(t,e){if(t.indexOf){var i=t.indexOf(e);return-1===i?!1:i}for(var n=0,s=t.length;s>n;n++)if(t[n]===e)return n;return!1},toArray:function(t){return Array.prototype.slice.call(t,0)},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],i=[],n=[],s=[],o=Math.min,r=Math.max;return 1===t.length?{pageX:t[0].pageX,pageY:t[0].pageY,clientX:t[0].clientX,clientY:t[0].clientY}:(w.each(t,function(t){e.push(t.pageX),i.push(t.pageY),n.push(t.clientX),s.push(t.clientY)}),{pageX:(o.apply(Math,e)+r.apply(Math,e))/2,pageY:(o.apply(Math,i)+r.apply(Math,i))/2,clientX:(o.apply(Math,n)+r.apply(Math,n))/2,clientY:(o.apply(Math,s)+r.apply(Math,s))/2})},getVelocity:function(t,e,i){return{x:Math.abs(e/t)||0,y:Math.abs(i/t)||0}},getAngle:function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return 180*Math.atan2(n,i)/Math.PI},getDirection:function(t,e){var i=Math.abs(t.clientX-e.clientX),n=Math.abs(t.clientY-e.clientY);return i>=n?t.clientX-e.clientX>0?a:l:t.clientY-e.clientY>0?h:r},getDistance:function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(i*i+n*n)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==h||t==r},setPrefixedCss:function(t,e,i,n){var s=["","Webkit","Moz","O","ms"];e=w.toCamelCase(e);for(var o=0;o<s.length;o++){var r=e;if(s[o]&&(r=s[o]+r.slice(0,1).toUpperCase()+r.slice(1)),r in t.style){t.style[r]=(null==n||n)&&i||"";break}}},toggleBehavior:function(t,e,i){if(e&&t&&t.style){w.each(e,function(e,n){w.setPrefixedCss(t,n,e,i)});var n=i&&function(){return!1};"none"==e.userSelect&&(t.onselectstart=n),"none"==e.userDrag&&(t.ondragstart=n)}},toCamelCase:function(t){return t.replace(/[_-]([a-z])/g,function(t){return t[1].toUpperCase()})}};s.Instance=function(t,e){var n=this;i(),this.element=t,this.enabled=!0,w.each(e,function(t,i){delete e[i],e[w.toCamelCase(i)]=t}),this.options=w.extend(w.extend({},s.defaults),e||{}),this.options.behavior&&w.toggleBehavior(this.element,this.options.behavior,!0),this.eventStartHandler=y.onTouch(t,p,function(t){n.enabled&&t.eventType==p?b.startDetect(n,t):t.eventType==v&&b.detect(t)}),this.eventHandlers=[]},s.Instance.prototype={on:function(t,e){var i=this;return y.on(i.element,t,e,function(t){i.eventHandlers.push({gesture:t,handler:e})}),i},off:function(t,e){var i=this;return y.off(i.element,t,e,function(t){var n=w.inArray({gesture:t,handler:e});n!==!1&&i.eventHandlers.splice(n,1)}),i},trigger:function(t,e){e||(e={});var i=s.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e;var n=this.element;return w.hasParent(e.target,n)&&(n=e.target),n.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this},dispose:function(){var t,e;for(w.toggleBehavior(this.element,this.options.behavior,!1),t=-1;e=this.eventHandlers[++t];)w.off(this.element,e.gesture,e.handler);return this.eventHandlers=[],y.off(this.element,o[p],this.eventStartHandler),null}};var y=s.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(t,e,i,n){var s=e.split(" ");w.each(s,function(e){w.on(t,e,i),n&&n(e)})},off:function(t,e,i,n){var s=e.split(" ");w.each(s,function(e){w.off(t,e,i),n&&n(e)})},onTouch:function(t,e,i){var n=this,r=function(o){var r,a=o.type.toLowerCase(),h=s.HAS_POINTEREVENTS,l=w.inStr(a,"mouse");l&&n.preventMouseEvents||(l&&e==p&&0===o.button?(n.preventMouseEvents=!1,n.shouldDetect=!0):h&&e==p?n.shouldDetect=1===o.buttons||_.matchType(u,o):l||e!=p||(n.preventMouseEvents=!0,n.shouldDetect=!0),h&&e!=m&&_.updatePointer(e,o),n.shouldDetect&&(r=n.doDetect.call(n,o,e,t,i)),r==m&&(n.preventMouseEvents=!1,n.shouldDetect=!1,_.reset()),h&&e==m&&_.updatePointer(e,o))};return this.on(t,o[e],r),r},doDetect:function(t,e,i,n){var s=this.getTouchList(t,e),o=s.length,r=e,a=s.trigger,h=o;e==p?a=v:e==m&&(a=g,h=s.length-(t.changedTouches?t.changedTouches.length:1)),h>0&&this.started&&(r=f),this.started=!0;var l=this.collectEventData(i,r,s,t);return e!=m&&n.call(b,l),a&&(l.changedLength=h,l.eventType=a,n.call(b,l),l.eventType=r,delete l.changedLength),r==m&&(n.call(b,l),this.started=!1),r},determineEventTypes:function(){var e;return e=s.HAS_POINTEREVENTS?t.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:s.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],o[p]=e[0],o[f]=e[1],o[m]=e[2],o},getTouchList:function(t,e){if(s.HAS_POINTEREVENTS)return _.getTouchList();if(t.touches){if(e==f)return t.touches;var i=[],n=[].concat(w.toArray(t.touches),w.toArray(t.changedTouches)),o=[];return w.each(n,function(t){w.inArray(i,t.identifier)===!1&&o.push(t),i.push(t.identifier)}),o}return t.identifier=1,[t]},collectEventData:function(t,e,i,n){var s=u;return w.inStr(n.type,"mouse")||_.matchType(c,n)?s=c:_.matchType(d,n)&&(s=d),{center:w.getCenter(i),timeStamp:Date.now(),target:n.target,touches:i,eventType:e,pointerType:s,srcEvent:n,preventDefault:function(){var t=this.srcEvent;t.preventManipulation&&t.preventManipulation(),t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return b.stopDetect()}}}},_=s.PointerEvent={pointers:{},getTouchList:function(){var t=[];return w.each(this.pointers,function(e){t.push(e)}),t},updatePointer:function(t,e){t==m||t!=m&&1!==e.buttons?delete this.pointers[e.pointerId]:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e)},matchType:function(t,e){if(!e.pointerType)return!1;var i=e.pointerType,n={};return n[c]=i===(e.MSPOINTER_TYPE_MOUSE||c),n[u]=i===(e.MSPOINTER_TYPE_TOUCH||u),n[d]=i===(e.MSPOINTER_TYPE_PEN||d),n[t]},reset:function(){this.pointers={}}},b=s.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:w.extend({},e),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst,i=e.options;return w.each(this.gestures,function(n){!this.stopped&&e.enabled&&i[n.name]&&n.handler.call(n,t,e)},this),this.current&&(this.current.lastEvent=t),t.eventType==m&&this.stopDetect(),t}},stopDetect:function(){this.previous=w.extend({},this.current),this.current=null,this.stopped=!0},getCalculatedData:function(t,e,i,n,o){var r=this.current,a=!1,h=r.lastCalcEvent,l=r.lastCalcData;h&&t.timeStamp-h.timeStamp>s.CALCULATE_INTERVAL&&(e=h.center,i=t.timeStamp-h.timeStamp,n=t.center.clientX-h.center.clientX,o=t.center.clientY-h.center.clientY,a=!0),(t.eventType==v||t.eventType==g)&&(r.futureCalcEvent=t),(!r.lastCalcEvent||a)&&(l.velocity=w.getVelocity(i,n,o),l.angle=w.getAngle(e,t.center),l.direction=w.getDirection(e,t.center),r.lastCalcEvent=r.futureCalcEvent||t,r.futureCalcEvent=t),t.velocityX=l.velocity.x,t.velocityY=l.velocity.y,t.interimAngle=l.angle,t.interimDirection=l.direction},extendEventData:function(t){var e=this.current,i=e.startEvent,n=e.lastEvent||i;(t.eventType==v||t.eventType==g)&&(i.touches=[],w.each(t.touches,function(t){i.touches.push({clientX:t.clientX,clientY:t.clientY})}));var s=t.timeStamp-i.timeStamp,o=t.center.clientX-i.center.clientX,r=t.center.clientY-i.center.clientY;return this.getCalculatedData(t,n.center,s,o,r),w.extend(t,{startEvent:i,deltaTime:s,deltaX:o,deltaY:r,distance:w.getDistance(i.center,t.center),angle:w.getAngle(i.center,t.center),direction:w.getDirection(i.center,t.center),scale:w.getScale(i.touches,t.touches),rotation:w.getRotation(i.touches,t.touches)}),t},register:function(t){var i=t.defaults||{};return i[t.name]===e&&(i[t.name]=!0),w.extend(s.defaults,i,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}};!function(t){function e(e,n){var s=b.current;if(!(n.options.dragMaxTouches>0&&e.touches.length>n.options.dragMaxTouches))switch(e.eventType){case p:i=!1;break;case f:if(e.distance<n.options.dragMinDistance&&s.name!=t)return;var o=s.startEvent.center;if(s.name!=t&&(s.name=t,n.options.dragDistanceCorrection&&e.distance>0)){var c=Math.abs(n.options.dragMinDistance/e.distance);o.pageX+=e.deltaX*c,o.pageY+=e.deltaY*c,o.clientX+=e.deltaX*c,o.clientY+=e.deltaY*c,e=b.extendEventData(e)}(s.lastEvent.dragLockToAxis||n.options.dragLockToAxis&&n.options.dragLockMinDistance<=e.distance)&&(e.dragLockToAxis=!0);var u=s.lastEvent.direction;e.dragLockToAxis&&u!==e.direction&&(e.direction=w.isVertical(u)?e.deltaY<0?h:r:e.deltaX<0?a:l),i||(n.trigger(t+"start",e),i=!0),n.trigger(t,e),n.trigger(t+e.direction,e);var d=w.isVertical(e.direction);(n.options.dragBlockVertical&&d||n.options.dragBlockHorizontal&&!d)&&e.preventDefault();break;case g:i&&e.changedLength<=n.options.dragMaxTouches&&(n.trigger(t+"end",e),i=!1);break;case m:i=!1}}var i=!1;s.gestures.Drag={name:t,index:50,handler:e,defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag"),s.gestures.Gesture={name:"gesture",index:1337,handler:function(t,e){e.trigger(this.name,t)}},function(t){function e(e,n){var s=n.options,o=b.current;switch(e.eventType){case p:clearTimeout(i),o.name=t,i=setTimeout(function(){o&&o.name==t&&n.trigger(t,e)},s.holdTimeout);break;case f:e.distance>s.holdThreshold&&clearTimeout(i);break;case g:clearTimeout(i)}}var i;s.gestures.Hold={name:t,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:e}}("hold"),s.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==g&&e.trigger(this.name,t)}},s.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(t,e){if(t.eventType==g){var i=t.touches.length,n=e.options;if(i<n.swipeMinTouches||i>n.swipeMaxTouches)return;(t.velocityX>n.swipeVelocityX||t.velocityY>n.swipeVelocityY)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},function(t){function e(e,n){var s,o,r=n.options,a=b.current,h=b.previous;switch(e.eventType){case p:i=!1;break;case f:i=i||e.distance>r.tapMaxDistance;break;case m:!w.inStr(e.srcEvent.type,"cancel")&&e.deltaTime<r.tapMaxTime&&!i&&(s=h&&h.lastEvent&&e.timeStamp-h.lastEvent.timeStamp,o=!1,h&&h.name==t&&s&&s<r.doubleTapInterval&&e.distance<r.doubleTapDistance&&(n.trigger("doubletap",e),o=!0),(!o||r.tapAlways)&&(a.name=t,n.trigger(a.name,e)))}}var i=!1;s.gestures.Tap={name:t,index:100,handler:e,defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap"),s.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(t,e){return e.options.preventMouse&&t.pointerType==c?void t.stopDetect():(e.options.preventDefault&&t.preventDefault(),void(t.eventType==v&&e.trigger("touch",t)))}},function(t){function e(e,n){switch(e.eventType){case p:i=!1;break;case f:if(e.touches.length<2)return;var s=Math.abs(1-e.scale),o=Math.abs(e.rotation);if(s<n.options.transformMinScale&&o<n.options.transformMinRotation)return;b.current.name=t,i||(n.trigger(t+"start",e),i=!0),n.trigger(t,e),o>n.options.transformMinRotation&&n.trigger("rotate",e),s>n.options.transformMinScale&&(n.trigger("pinch",e),n.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case g:i&&e.changedLength<2&&(n.trigger(t+"end",e),i=!1)}}var i=!1;s.gestures.Transform={name:t,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:e}}("transform"),t.Hammer=s,"undefined"!=typeof module&&module.exports&&(module.exports=s),"function"==typeof define&&define.amd?define(["jquery"],function(e){return n(t.Hammer,e)}):n(t.Hammer,t.jQuery||t.Zepto)}(window),function(){"use strict";function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,s=this,o=s.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if(t instanceof RegExp){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,s=this.getListenersAsObject(t),o="object"==typeof i;for(n in s)s.hasOwnProperty(n)&&-1===e(s[n],i)&&s[n].push(o?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,s,o=this.getListenersAsObject(t);for(s in o)o.hasOwnProperty(s)&&(n=e(o[s],i),-1!==n&&o[s].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,s,o=t?this.removeListener:this.addListener,r=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)o.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(s=e[n])&&("function"==typeof s?o.call(this,n,s):r.call(this,n,s));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if(t instanceof RegExp)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){var i,n,s,o,r=this.getListenersAsObject(t);for(s in r)if(r.hasOwnProperty(s))for(n=r[s].length;n--;)i=r[s][n],i.once===!0&&this.removeListener(t,i.listener),o=i.listener.apply(this,e||[]),o===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return s.EventEmitter=o,t},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t){"use strict";function e(e){var i=t.event;return i.target=i.target||i.srcElement||e,i}var i=document.documentElement,n=function(){};i.addEventListener?n=function(t,e,i){t.addEventListener(e,i,!1)}:i.attachEvent&&(n=function(t,i,n){t[i+n]=n.handleEvent?function(){var i=e(t);n.handleEvent.call(n,i)}:function(){var i=e(t);n.call(t,i)},t.attachEvent("on"+i,t[i+n])});var s=function(){};i.removeEventListener?s=function(t,e,i){t.removeEventListener(e,i,!1)}:i.detachEvent&&(s=function(t,e,i){t.detachEvent("on"+e,t[e+i]);try{delete t[e+i]}catch(n){t[e+i]=void 0}});var o={bind:n,unbind:s};"function"==typeof define&&define.amd?define(o):"object"==typeof exports?module.exports=o:t.eventie=o}(this),/*! jQuery Validation Plugin - v1.12.0 - 4/1/2014
 * http://jqueryvalidation.org/
 * Copyright (c) 2014 Jörn Zaefferer; Licensed MIT */
!function(t){t.extend(t.fn,{validate:function(e){if(!this.length)return void(e&&e.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var i=t.data(this[0],"validator");return i?i:(this.attr("novalidate","novalidate"),i=new t.validator(e,this[0]),t.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(e){i.settings.submitHandler&&(i.submitButton=e.target),t(e.target).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==t(e.target).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.submit(function(e){function n(){var n;return i.settings.submitHandler?(i.submitButton&&(n=t("<input type='hidden'/>").attr("name",i.submitButton.name).val(t(i.submitButton).val()).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,e),i.submitButton&&n.remove(),!1):!0}return i.settings.debug&&e.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,n()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):n():(i.focusInvalid(),!1)})),i)},valid:function(){var e,i;return t(this[0]).is("form")?e=this.validate().form():(e=!0,i=t(this[0].form).validate(),this.each(function(){e=i.element(this)&&e})),e},removeAttrs:function(e){var i={},n=this;return t.each(e.split(/\s/),function(t,e){i[e]=n.attr(e),n.removeAttr(e)}),i},rules:function(e,i){var n,s,o,r,a,h,l=this[0];if(e)switch(n=t.data(l.form,"validator").settings,s=n.rules,o=t.validator.staticRules(l),e){case"add":t.extend(o,t.validator.normalizeRule(i)),delete o.messages,s[l.name]=o,i.messages&&(n.messages[l.name]=t.extend(n.messages[l.name],i.messages));break;case"remove":return i?(h={},t.each(i.split(/\s/),function(e,i){h[i]=o[i],delete o[i],"required"===i&&t(l).removeAttr("aria-required")}),h):(delete s[l.name],o)}return r=t.validator.normalizeRules(t.extend({},t.validator.classRules(l),t.validator.attributeRules(l),t.validator.dataRules(l),t.validator.staticRules(l)),l),r.required&&(a=r.required,delete r.required,r=t.extend({required:a},r),t(l).attr("aria-required","true")),r.remote&&(a=r.remote,delete r.remote,r=t.extend(r,{remote:a})),r}}),t.extend(t.expr[":"],{blank:function(e){return!t.trim(""+t(e).val())},filled:function(e){return!!t.trim(""+t(e).val())},unchecked:function(e){return!t(e).prop("checked")}}),t.validator=function(e,i){this.settings=t.extend(!0,{},t.validator.defaults,e),this.currentForm=i,this.init()},t.validator.format=function(e,i){return 1===arguments.length?function(){var i=t.makeArray(arguments);return i.unshift(e),t.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!==Array&&(i=t.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),t.each(i,function(t,i){e=e.replace(new RegExp("\\{"+t+"\\}","g"),function(){return i})}),e)},t.extend(t.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:t([]),errorLabelContainer:t([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t){this.lastActive=t,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(t)).hide())},onfocusout:function(t){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){(9!==e.which||""!==this.elementValue(t))&&(t.name in this.submitted||t===this.lastElement)&&this.element(t)},onclick:function(t){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(e,i,n){"radio"===e.type?this.findByName(e.name).addClass(i).removeClass(n):t(e).addClass(i).removeClass(n)},unhighlight:function(e,i,n){"radio"===e.type?this.findByName(e.name).removeClass(i).addClass(n):t(e).removeClass(i).addClass(n)}},setDefaults:function(e){t.extend(t.validator.defaults,e)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:t.validator.format("Please enter no more than {0} characters."),minlength:t.validator.format("Please enter at least {0} characters."),rangelength:t.validator.format("Please enter a value between {0} and {1} characters long."),range:t.validator.format("Please enter a value between {0} and {1}."),max:t.validator.format("Please enter a value less than or equal to {0}."),min:t.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function e(e){var i=t.data(this[0].form,"validator"),n="on"+e.type.replace(/^validate/,""),s=i.settings;s[n]&&!this.is(s.ignore)&&s[n].call(i,this[0],e)}this.labelContainer=t(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||t(this.currentForm),this.containers=t(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i,n=this.groups={};t.each(this.settings.groups,function(e,i){"string"==typeof i&&(i=i.split(/\s/)),t.each(i,function(t,i){n[i]=e})}),i=this.settings.rules,t.each(i,function(e,n){i[e]=t.validator.normalizeRule(n)}),t(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",e).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",e),this.settings.invalidHandler&&t(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler),t(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),t.extend(this.submitted,this.errorMap),this.invalid=t.extend({},this.errorMap),this.valid()||t(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(e){var i=this.clean(e),n=this.validationTargetFor(i),s=!0;return this.lastElement=n,void 0===n?delete this.invalid[i.name]:(this.prepareElement(n),this.currentElements=t(n),s=this.check(n)!==!1,s?delete this.invalid[n.name]:this.invalid[n.name]=!0),t(e).attr("aria-invalid",!s),this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),s},showErrors:function(e){if(e){t.extend(this.errorMap,e),this.errorList=[];for(var i in e)this.errorList.push({message:e[i],element:this.findByName(i)[0]});this.successList=t.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){t.fn.resetForm&&t(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e,i=0;for(e in t)i++;return i},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{t(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var e=this.lastActive;return e&&1===t.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var e=this,i={};return t(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in i||!e.objectLength(t(this).rules())?!1:(i[this.name]=!0,!0)})},clean:function(e){return t(e)[0]},errors:function(){var e=this.settings.errorClass.split(" ").join(".");return t(this.settings.errorElement+"."+e,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=t([]),this.toHide=t([]),this.currentElements=t([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(e){var i,n=t(e),s=n.attr("type");return"radio"===s||"checkbox"===s?t("input[name='"+n.attr("name")+"']:checked").val():(i=n.val(),"string"==typeof i?i.replace(/\r/g,""):i)},check:function(e){e=this.validationTargetFor(this.clean(e));var i,n,s,o=t(e).rules(),r=t.map(o,function(t,e){return e}).length,a=!1,h=this.elementValue(e);for(n in o){s={method:n,parameters:o[n]};try{if(i=t.validator.methods[n].call(this,h,e,s.parameters),"dependency-mismatch"===i&&1===r){a=!0;continue}if(a=!1,"pending"===i)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!i)return this.formatAndAdd(e,s),!1}catch(l){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+s.method+"' method.",l),l}}return a?void 0:(this.objectLength(o)&&this.successList.push(e),!0)},customDataMessage:function(e,i){return t(e).data("msg"+i[0].toUpperCase()+i.substring(1).toLowerCase())||t(e).data("msg")},customMessage:function(t,e){var i=this.settings.messages[t];return i&&(i.constructor===String?i:i[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t];return void 0},defaultMessage:function(e,i){return this.findDefined(this.customMessage(e.name,i),this.customDataMessage(e,i),!this.settings.ignoreTitle&&e.title||void 0,t.validator.messages[i],"<strong>Warning: No message defined for "+e.name+"</strong>")},formatAndAdd:function(e,i){var n=this.defaultMessage(e,i.method),s=/\$?\{(\d+)\}/g;"function"==typeof n?n=n.call(this,i.parameters,e):s.test(n)&&(n=t.validator.format(n.replace(s,"{$1}"),i.parameters)),this.errorList.push({message:n,element:e,method:i.method}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e,i;for(t=0;this.errorList[t];t++)i=this.errorList[t],this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return t(this.errorList).map(function(){return this.element})},showLabel:function(e,i){var n=this.errorsFor(e);n.length?(n.removeClass(this.settings.validClass).addClass(this.settings.errorClass),n.html(i)):(n=t("<"+this.settings.errorElement+">").attr("for",this.idOrName(e)).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,t(e)):n.insertAfter(e))),!i&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n,e)),this.toShow=this.toShow.add(n)},errorsFor:function(e){var i=this.idOrName(e);return this.errors().filter(function(){return t(this).attr("for")===i})},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name).not(this.settings.ignore)[0]),t},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(e){return t(this.currentForm).find("[name='"+e+"']")},getLength:function(e,i){switch(i.nodeName.toLowerCase()){case"select":return t("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return e.length},depend:function(t,e){return this.dependTypes[typeof t]?this.dependTypes[typeof t](t,e):!0},dependTypes:{"boolean":function(t){return t},string:function(e,i){return!!t(e,i.form).length},"function":function(t,e){return t(e)}},optional:function(e){var i=this.elementValue(e);return!t.validator.methods.required.call(this,i,e)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,this.pending[t.name]=!0)},stopRequest:function(e,i){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(t(this.currentForm).submit(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(t(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(e){return t.data(e,"previousValue")||t.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(e,i){e.constructor===String?this.classRuleSettings[e]=i:t.extend(this.classRuleSettings,e)},classRules:function(e){var i={},n=t(e).attr("class");return n&&t.each(n.split(" "),function(){this in t.validator.classRuleSettings&&t.extend(i,t.validator.classRuleSettings[this])}),i},attributeRules:function(e){var i,n,s={},o=t(e),r=e.getAttribute("type");for(i in t.validator.methods)"required"===i?(n=e.getAttribute(i),""===n&&(n=!0),n=!!n):n=o.attr(i),/min|max/.test(i)&&(null===r||/number|range|text/.test(r))&&(n=Number(n)),n||0===n?s[i]=n:r===i&&"range"!==r&&(s[i]=!0);return s.maxlength&&/-1|2147483647|524288/.test(s.maxlength)&&delete s.maxlength,s},dataRules:function(e){var i,n,s={},o=t(e);for(i in t.validator.methods)n=o.data("rule"+i[0].toUpperCase()+i.substring(1).toLowerCase()),void 0!==n&&(s[i]=n);return s},staticRules:function(e){var i={},n=t.data(e.form,"validator");return n.settings.rules&&(i=t.validator.normalizeRule(n.settings.rules[e.name])||{}),i},normalizeRules:function(e,i){return t.each(e,function(n,s){if(s===!1)return void delete e[n];if(s.param||s.depends){var o=!0;switch(typeof s.depends){case"string":o=!!t(s.depends,i.form).length;break;case"function":o=s.depends.call(i,i)}o?e[n]=void 0!==s.param?s.param:!0:delete e[n]}}),t.each(e,function(n,s){e[n]=t.isFunction(s)?s(i):s}),t.each(["minlength","maxlength"],function(){e[this]&&(e[this]=Number(e[this]))}),t.each(["rangelength","range"],function(){var i;e[this]&&(t.isArray(e[this])?e[this]=[Number(e[this][0]),Number(e[this][1])]:"string"==typeof e[this]&&(i=e[this].split(/[\s,]+/),e[this]=[Number(i[0]),Number(i[1])]))}),t.validator.autoCreateRanges&&(e.min&&e.max&&(e.range=[e.min,e.max],delete e.min,delete e.max),e.minlength&&e.maxlength&&(e.rangelength=[e.minlength,e.maxlength],delete e.minlength,delete e.maxlength)),e},normalizeRule:function(e){if("string"==typeof e){var i={};t.each(e.split(/\s/),function(){i[this]=!0}),e=i}return e},addMethod:function(e,i,n){t.validator.methods[e]=i,t.validator.messages[e]=void 0!==n?n:t.validator.messages[e],i.length<3&&t.validator.addClassRules(e,t.validator.normalizeRule(e))},methods:{required:function(e,i,n){if(!this.depend(n,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var s=t(i).val();return s&&s.length>0}return this.checkable(i)?this.getLength(e,i)>0:t.trim(e).length>0},email:function(t,e){return this.optional(e)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},creditcard:function(t,e){if(this.optional(e))return"dependency-mismatch";if(/[^0-9 \-]+/.test(t))return!1;var i,n,s=0,o=0,r=!1;if(t=t.replace(/\D/g,""),t.length<13||t.length>19)return!1;for(i=t.length-1;i>=0;i--)n=t.charAt(i),o=parseInt(n,10),r&&(o*=2)>9&&(o-=9),s+=o,r=!r;return s%10===0},minlength:function(e,i,n){var s=t.isArray(e)?e.length:this.getLength(t.trim(e),i);return this.optional(i)||s>=n},maxlength:function(e,i,n){var s=t.isArray(e)?e.length:this.getLength(t.trim(e),i);return this.optional(i)||n>=s},rangelength:function(e,i,n){var s=t.isArray(e)?e.length:this.getLength(t.trim(e),i);return this.optional(i)||s>=n[0]&&s<=n[1]},min:function(t,e,i){return this.optional(e)||t>=i},max:function(t,e,i){return this.optional(e)||i>=t},range:function(t,e,i){return this.optional(e)||t>=i[0]&&t<=i[1]},equalTo:function(e,i,n){var s=t(n);return this.settings.onfocusout&&s.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){t(i).valid()}),e===s.val()},remote:function(e,i,n){if(this.optional(i))return"dependency-mismatch";var s,o,r=this.previousValue(i);return this.settings.messages[i.name]||(this.settings.messages[i.name]={}),r.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=r.message,n="string"==typeof n&&{url:n}||n,r.old===e?r.valid:(r.old=e,s=this,this.startRequest(i),o={},o[i.name]=e,t.ajax(t.extend(!0,{url:n,mode:"abort",port:"validate"+i.name,dataType:"json",data:o,context:s.currentForm,success:function(n){var o,a,h,l=n===!0||"true"===n;s.settings.messages[i.name].remote=r.originalMessage,l?(h=s.formSubmitted,s.prepareElement(i),s.formSubmitted=h,s.successList.push(i),delete s.invalid[i.name],s.showErrors()):(o={},a=n||s.defaultMessage(i,"remote"),o[i.name]=r.message=t.isFunction(a)?a(e):a,s.invalid[i.name]=!0,s.showErrors(o)),r.valid=l,s.stopRequest(i,l)}},n)),"pending")}}}),t.format=function(){throw"$.format has been deprecated. Please use $.validator.format instead."}}(jQuery),function(t){var e,i={};t.ajaxPrefilter?t.ajaxPrefilter(function(t,e,n){var s=t.port;"abort"===t.mode&&(i[s]&&i[s].abort(),i[s]=n)}):(e=t.ajax,t.ajax=function(n){var s=("mode"in n?n:t.ajaxSettings).mode,o=("port"in n?n:t.ajaxSettings).port;return"abort"===s?(i[o]&&i[o].abort(),i[o]=e.apply(this,arguments),i[o]):e.apply(this,arguments)})}(jQuery),function(t){t.extend(t.fn,{validateDelegate:function(e,i,n){return this.bind(i,function(i){var s=t(i.target);return s.is(e)?n.apply(s,arguments):void 0})}})}(jQuery),!function(){var t,e,i,n,s,o={}.hasOwnProperty,r=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};n=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,i,n,s,o,r;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:this.escapeExpression(t.label),children:0,disabled:t.disabled}),o=t.childNodes,r=[],n=0,s=o.length;s>n;n++)i=o[n],r.push(this.add_option(i,e,t.disabled));return r},t.prototype.add_option=function(t,e,i){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:i===!0?i:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},t.prototype.escapeExpression=function(t){var e,i;return null==t||t===!1?"":/[\&\<\>\"\'\`]/.test(t)?(e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,t.replace(i,function(t){return e[t]||"&amp;"})):t},t}(),n.select_to_array=function(t){var e,i,s,o,r;for(i=new n,r=t.childNodes,s=0,o=r.length;o>s;s++)e=r[s],i.add_node(e);return i.parsed},e=function(){function t(e,i){this.form_field=e,this.options=null!=i?i:{},t.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return t.prototype.set_default_values=function(){var t=this;return this.click_test_action=function(e){return t.test_active_click(e)},this.activate_action=function(e){return t.activate_field(e)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},t.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},t.prototype.results_option_build=function(t){var e,i,n,s,o;for(e="",o=this.results_data,n=0,s=o.length;s>n;n++)i=o[n],e+=i.group?this.result_add_group(i):this.result_add_option(i),(null!=t?t.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(i.text));return e},t.prototype.result_add_option=function(t){var e,i;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),i=document.createElement("li"),i.className=e.join(" "),i.style.cssText=t.style,i.setAttribute("data-option-array-index",t.array_index),i.innerHTML=t.search_text,this.outerHTML(i)):""},t.prototype.result_add_group=function(t){var e;return(t.search_match||t.group_match)&&t.active_options>0?(e=document.createElement("li"),e.className="group-result",e.innerHTML=t.search_text,this.outerHTML(e)):""},t.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing?this.winnow_results():void 0},t.prototype.reset_single_select_options=function(){var t,e,i,n,s;for(n=this.results_data,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(t.selected?t.selected=!1:void 0);return s},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.winnow_results=function(){var t,e,i,n,s,o,r,a,h,l,c,u,d;for(this.no_results_clear(),s=0,r=this.get_search_text(),t=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=this.search_contains?"":"^",i=new RegExp(n+t,"i"),l=new RegExp(t,"i"),d=this.results_data,c=0,u=d.length;u>c;c++)e=d[c],e.search_match=!1,o=null,this.include_option_in_results(e)&&(e.group&&(e.group_match=!1,e.active_options=0),null!=e.group_array_index&&this.results_data[e.group_array_index]&&(o=this.results_data[e.group_array_index],0===o.active_options&&o.search_match&&(s+=1),o.active_options+=1),(!e.group||this.group_search)&&(e.search_text=e.group?e.label:e.html,e.search_match=this.search_string_match(e.search_text,i),e.search_match&&!e.group&&(s+=1),e.search_match?(r.length&&(a=e.search_text.search(l),h=e.search_text.substr(0,a+r.length)+"</em>"+e.search_text.substr(a+r.length),e.search_text=h.substr(0,a)+"<em>"+h.substr(a)),null!=o&&(o.group_match=!0)):null!=e.group_array_index&&this.results_data[e.group_array_index].search_match&&(e.search_match=!0)));return this.result_clear_highlight(),1>s&&r.length?(this.update_results_content(""),this.no_results(r)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},t.prototype.search_string_match=function(t,e){var i,n,s,o;if(e.test(t))return!0;if(this.enable_split_word_search&&(t.indexOf(" ")>=0||0===t.indexOf("["))&&(n=t.replace(/\[|\]/g,"").split(" "),n.length))for(s=0,o=n.length;o>s;s++)if(i=n[s],e.test(i))return!0},t.prototype.choices_count=function(){var t,e,i,n;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,n=this.form_field.options,e=0,i=n.length;i>e;e++)t=n[e],t.selected&&(this.selected_option_count+=1);return this.selected_option_count},t.prototype.choices_click=function(t){return t.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},t.prototype.keyup_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),e){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(t.preventDefault(),this.results_showing)return this.result_select(t);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},t.prototype.clipboard_event_checker=function(){var t=this;return setTimeout(function(){return t.results_search()},50)},t.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},t.prototype.include_option_in_results=function(t){return this.is_multiple&&!this.display_selected_options&&t.selected?!1:!this.display_disabled_options&&t.disabled?!1:t.empty?!1:!0},t.prototype.search_results_touchstart=function(t){return this.touch_started=!0,this.search_results_mouseover(t)},t.prototype.search_results_touchmove=function(t){return this.touch_started=!1,this.search_results_mouseout(t)},t.prototype.search_results_touchend=function(t){return this.touch_started?this.search_results_mouseup(t):void 0},t.prototype.outerHTML=function(t){var e;return t.outerHTML?t.outerHTML:(e=document.createElement("div"),e.appendChild(t),e.innerHTML)},t.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results match",t}(),t=jQuery,t.fn.extend({chosen:function(n){return e.browser_is_supported()?this.each(function(){var e,s;e=t(this),s=e.data("chosen"),"destroy"===n&&s?s.destroy():s||e.data("chosen",new i(this,n))}):this}}),i=function(e){function i(){return s=i.__super__.constructor.apply(this,arguments)}return r(i,e),i.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},i.prototype.set_up_html=function(){var e,i;return e=["chosen-container"],e.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),i={"class":e.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(i.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=t("<div />",i),this.container.html(this.is_multiple?'<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>':'<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},i.prototype.register_observers=function(){var t=this;return this.container.bind("mousedown.chosen",function(e){t.container_mousedown(e)}),this.container.bind("mouseup.chosen",function(e){t.container_mouseup(e)}),this.container.bind("mouseenter.chosen",function(e){t.mouse_enter(e)
}),this.container.bind("mouseleave.chosen",function(e){t.mouse_leave(e)}),this.search_results.bind("mouseup.chosen",function(e){t.search_results_mouseup(e)}),this.search_results.bind("mouseover.chosen",function(e){t.search_results_mouseover(e)}),this.search_results.bind("mouseout.chosen",function(e){t.search_results_mouseout(e)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(e){t.search_results_mousewheel(e)}),this.search_results.bind("touchstart.chosen",function(e){t.search_results_touchstart(e)}),this.search_results.bind("touchmove.chosen",function(e){t.search_results_touchmove(e)}),this.search_results.bind("touchend.chosen",function(e){t.search_results_touchend(e)}),this.form_field_jq.bind("chosen:updated.chosen",function(e){t.results_update_field(e)}),this.form_field_jq.bind("chosen:activate.chosen",function(e){t.activate_field(e)}),this.form_field_jq.bind("chosen:open.chosen",function(e){t.container_mousedown(e)}),this.form_field_jq.bind("chosen:close.chosen",function(e){t.input_blur(e)}),this.search_field.bind("blur.chosen",function(e){t.input_blur(e)}),this.search_field.bind("keyup.chosen",function(e){t.keyup_checker(e)}),this.search_field.bind("keydown.chosen",function(e){t.keydown_checker(e)}),this.search_field.bind("focus.chosen",function(e){t.input_focus(e)}),this.search_field.bind("cut.chosen",function(e){t.clipboard_event_checker(e)}),this.search_field.bind("paste.chosen",function(e){t.clipboard_event_checker(e)}),this.is_multiple?this.search_choices.bind("click.chosen",function(e){t.choices_click(e)}):this.container.bind("click.chosen",function(t){t.preventDefault()})},i.prototype.destroy=function(){return t(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},i.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},i.prototype.container_mousedown=function(e){return this.is_disabled||(e&&"mousedown"===e.type&&!this.results_showing&&e.preventDefault(),null!=e&&t(e.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!e||t(e.target)[0]!==this.selected_item[0]&&!t(e.target).parents("a.chosen-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},i.prototype.container_mouseup=function(t){return"ABBR"!==t.target.nodeName||this.is_disabled?void 0:this.results_reset(t)},i.prototype.search_results_mousewheel=function(t){var e;return t.originalEvent&&(e=-t.originalEvent.wheelDelta||t.originalEvent.detail),null!=e?(t.preventDefault(),"DOMMouseScroll"===t.type&&(e=40*e),this.search_results.scrollTop(e+this.search_results.scrollTop())):void 0},i.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},i.prototype.close_field=function(){return t(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},i.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},i.prototype.test_active_click=function(e){var i;return i=t(e.target).closest(".chosen-container"),i.length&&this.container[0]===i[0]?this.active_field=!0:this.close_field()},i.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=n.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},i.prototype.result_do_highlight=function(t){var e,i,n,s,o;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),n=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),s=n+o,i=this.result_highlight.position().top+this.search_results.scrollTop(),e=i+this.result_highlight.outerHeight(),e>=s)return this.search_results.scrollTop(e-n>0?e-n:0);if(o>i)return this.search_results.scrollTop(i)}},i.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},i.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},i.prototype.update_results_content=function(t){return this.search_results.html(t)},i.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},i.prototype.set_tab_index=function(){var t;return this.form_field.tabIndex?(t=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=t):void 0},i.prototype.set_label_behavior=function(){var e=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=t("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(t){return e.is_multiple?e.container_mousedown(t):e.activate_field()}):void 0},i.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},i.prototype.search_results_mouseup=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(e),this.search_field.focus()):void 0},i.prototype.search_results_mouseover=function(e){var i;return i=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},i.prototype.search_results_mouseout=function(e){return t(e.target).hasClass("active-result")?this.result_clear_highlight():void 0},i.prototype.choice_build=function(e){var i,n,s=this;return i=t("<li />",{"class":"search-choice"}).html("<span>"+e.html+"</span>"),e.disabled?i.addClass("search-choice-disabled"):(n=t("<a />",{"class":"search-choice-close","data-option-array-index":e.array_index}),n.bind("click.chosen",function(t){return s.choice_destroy_link_click(t)}),i.append(n)),this.search_container.before(i)},i.prototype.choice_destroy_link_click=function(e){return e.preventDefault(),e.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(t(e.target))},i.prototype.choice_destroy=function(t){return this.result_deselect(t[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()):void 0},i.prototype.results_reset=function(){return this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},i.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},i.prototype.result_select=function(t){var e,i;return this.result_highlight?(e=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?e.removeClass("active-result"):this.reset_single_select_options(),i=this.results_data[e[0].getAttribute("data-option-array-index")],i.selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):this.single_set_selected_text(i.text),(t.metaKey||t.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},i.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(t)},i.prototype.result_deselect=function(t){var e;return e=this.results_data[t],this.form_field.options[e.options_index].disabled?!1:(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},i.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},i.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":t("<div/>").text(t.trim(this.search_field.val())).html()},i.prototype.winnow_results_set_highlight=function(){var t,e;return e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),t=e.length?e.first():this.search_results.find(".active-result").first(),null!=t?this.result_do_highlight(t):void 0},i.prototype.no_results=function(e){var i;return i=t('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(e),this.search_results.append(i),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},i.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},i.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result"),t.length?this.result_do_highlight(t.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},i.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last(),t.length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},i.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},i.prototype.keydown_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),8!==e&&this.pending_backstroke&&this.clear_backstroke(),e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},i.prototype.search_field_scale=function(){var e,i,n,s,o,r,a,h,l;if(this.is_multiple){for(n=0,a=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],h=0,l=r.length;l>h;h++)s=r[h],o+=s+":"+this.search_field.css(s)+";";return e=t("<div />",{style:o}),e.text(this.search_field.val()),t("body").append(e),a=e.width()+25,e.remove(),i=this.container.outerWidth(),a>i-10&&(a=i-10),this.search_field.css({width:a+"px"})}},i}(e)}.call(this),/*!
 * hoverIntent v1.8.0 // 2014.06.29 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
function(t){t.fn.hoverIntent=function(e,i,n){var s={interval:100,sensitivity:6,timeout:0};s="object"==typeof e?t.extend(s,e):t.isFunction(i)?t.extend(s,{over:e,out:i,selector:n}):t.extend(s,{over:e,out:e,selector:i});var o,r,a,h,l=function(t){o=t.pageX,r=t.pageY},c=function(e,i){return i.hoverIntent_t=clearTimeout(i.hoverIntent_t),Math.sqrt((a-o)*(a-o)+(h-r)*(h-r))<s.sensitivity?(t(i).off("mousemove.hoverIntent",l),i.hoverIntent_s=!0,s.over.apply(i,[e])):(a=o,h=r,i.hoverIntent_t=setTimeout(function(){c(e,i)},s.interval),void 0)},u=function(t,e){return e.hoverIntent_t=clearTimeout(e.hoverIntent_t),e.hoverIntent_s=!1,s.out.apply(e,[t])},d=function(e){var i=t.extend({},e),n=this;n.hoverIntent_t&&(n.hoverIntent_t=clearTimeout(n.hoverIntent_t)),"mouseenter"===e.type?(a=i.pageX,h=i.pageY,t(n).on("mousemove.hoverIntent",l),n.hoverIntent_s||(n.hoverIntent_t=setTimeout(function(){c(i,n)},s.interval))):(t(n).off("mousemove.hoverIntent",l),n.hoverIntent_s&&(n.hoverIntent_t=setTimeout(function(){u(i,n)},s.timeout)))};return this.on({"mouseenter.hoverIntent":d,"mouseleave.hoverIntent":d},s.selector)}}(jQuery),function(t,e){function i(){return new Date(Date.UTC.apply(Date,arguments))}function n(){var t=new Date;return i(t.getFullYear(),t.getMonth(),t.getDate())}function s(t){return function(){return this[t].apply(this,arguments)}}function o(e,i){function n(t,e){return e.toLowerCase()}var s,o=t(e).data(),r={},a=new RegExp("^"+i.toLowerCase()+"([A-Z])");i=new RegExp("^"+i.toLowerCase());for(var h in o)i.test(h)&&(s=h.replace(a,n),r[s]=o[h]);return r}function r(e){var i={};if(f[e]||(e=e.split("-")[0],f[e])){var n=f[e];return t.each(p,function(t,e){e in n&&(i[e]=n[e])}),i}}var a=t(window),h=function(){var e={get:function(t){return this.slice(t)[0]},contains:function(t){for(var e=t&&t.valueOf(),i=0,n=this.length;n>i;i++)if(this[i].valueOf()===e)return i;return-1},remove:function(t){this.splice(t,1)},replace:function(e){e&&(t.isArray(e)||(e=[e]),this.clear(),this.push.apply(this,e))},clear:function(){this.splice(0)},copy:function(){var t=new h;return t.replace(this),t}};return function(){var i=[];return i.push.apply(i,arguments),t.extend(i,e),i}}(),l=function(e,i){this.dates=new h,this.viewDate=n(),this.focusDate=null,this._process_options(i),this.element=t(e),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=t(m.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(t,e){return parseInt(e)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};l.prototype={constructor:l,_process_options:function(e){this._o=t.extend({},this._o,e);var i=this.o=t.extend({},this._o),n=i.language;switch(f[n]||(n=n.split("-")[0],f[n]||(n=d.language)),i.language=n,i.startView){case 2:case"decade":i.startView=2;break;case 1:case"year":i.startView=1;break;default:i.startView=0}switch(i.minViewMode){case 1:case"months":i.minViewMode=1;break;case 2:case"years":i.minViewMode=2;break;default:i.minViewMode=0}i.startView=Math.max(i.startView,i.minViewMode),i.multidate!==!0&&(i.multidate=Number(i.multidate)||!1,i.multidate=i.multidate!==!1?Math.max(0,i.multidate):1),i.multidateSeparator=String(i.multidateSeparator),i.weekStart%=7,i.weekEnd=(i.weekStart+6)%7;var s=m.parseFormat(i.format);i.startDate!==-1/0&&(i.startDate=i.startDate?i.startDate instanceof Date?this._local_to_utc(this._zero_time(i.startDate)):m.parseDate(i.startDate,s,i.language):-1/0),1/0!==i.endDate&&(i.endDate=i.endDate?i.endDate instanceof Date?this._local_to_utc(this._zero_time(i.endDate)):m.parseDate(i.endDate,s,i.language):1/0),i.daysOfWeekDisabled=i.daysOfWeekDisabled||[],t.isArray(i.daysOfWeekDisabled)||(i.daysOfWeekDisabled=i.daysOfWeekDisabled.split(/[,\s]*/)),i.daysOfWeekDisabled=t.map(i.daysOfWeekDisabled,function(t){return parseInt(t,10)});var o=String(i.orientation).toLowerCase().split(/\s+/g),r=i.orientation.toLowerCase();if(o=t.grep(o,function(t){return/^auto|left|right|top|bottom$/.test(t)}),i.orientation={x:"auto",y:"auto"},r&&"auto"!==r)if(1===o.length)switch(o[0]){case"top":case"bottom":i.orientation.y=o[0];break;case"left":case"right":i.orientation.x=o[0]}else r=t.grep(o,function(t){return/^left|right$/.test(t)}),i.orientation.x=r[0]||"auto",r=t.grep(o,function(t){return/^top|bottom$/.test(t)}),i.orientation.y=r[0]||"auto";else;},_events:[],_secondaryEvents:[],_applyEvents:function(t){for(var i,n,s,o=0;o<t.length;o++)i=t[o][0],2===t[o].length?(n=e,s=t[o][1]):3===t[o].length&&(n=t[o][1],s=t[o][2]),i.on(s,n)},_unapplyEvents:function(t){for(var i,n,s,o=0;o<t.length;o++)i=t[o][0],2===t[o].length?(s=e,n=t[o][1]):3===t[o].length&&(s=t[o][1],n=t[o][2]),i.off(n,s)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:t.proxy(this.show,this),keyup:t.proxy(function(e){-1===t.inArray(e.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:t.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:t.proxy(this.show,this),keyup:t.proxy(function(e){-1===t.inArray(e.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:t.proxy(this.keydown,this)}],[this.component,{click:t.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:t.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:t.proxy(function(t){this._focused_from=t.target},this)}],[this.element,{blur:t.proxy(function(t){this._focused_from=t.target},this)}]),this._secondaryEvents=[[this.picker,{click:t.proxy(this.click,this)}],[t(window),{resize:t.proxy(this.place,this)}],[t(document),{"mousedown touchstart":t.proxy(function(t){this.element.is(t.target)||this.element.find(t.target).length||this.picker.is(t.target)||this.picker.find(t.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(e,i){var n=i||this.dates.get(-1),s=this._utc_to_local(n);this.element.trigger({type:e,date:s,dates:t.map(this.dates,this._utc_to_local),format:t.proxy(function(t,e){0===arguments.length?(t=this.dates.length-1,e=this.o.format):"string"==typeof t&&(e=t,t=this.dates.length-1),e=e||this.o.format;var i=this.dates.get(t);return m.formatDate(i,e,this.o.language)},this)})},show:function(){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){this.isInline||this.picker.is(":visible")&&(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(t){return t&&new Date(t.getTime()+6e4*t.getTimezoneOffset())},_local_to_utc:function(t){return t&&new Date(t.getTime()-6e4*t.getTimezoneOffset())},_zero_time:function(t){return t&&new Date(t.getFullYear(),t.getMonth(),t.getDate())},_zero_utc_time:function(t){return t&&new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()))},getDates:function(){return t.map(this.dates,this._utc_to_local)},getUTCDates:function(){return t.map(this.dates,function(t){return new Date(t)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){var e=t.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,e),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){var e=t.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,t.map(e,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var t=this.getFormattedDate();this.isInput?this.element.val(t).change():this.component&&this.element.find("input").val(t).change()},getFormattedDate:function(i){i===e&&(i=this.o.format);var n=this.o.language;return t.map(this.dates,function(t){return m.formatDate(t,i,n)}).join(this.o.multidateSeparator)},setStartDate:function(t){this._process_options({startDate:t}),this.update(),this.updateNavArrows()},setEndDate:function(t){this._process_options({endDate:t}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(t){this._process_options({daysOfWeekDisabled:t}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var e=this.picker.outerWidth(),i=this.picker.outerHeight(),n=10,s=a.width(),o=a.height(),r=a.scrollTop(),h=parseInt(this.element.parents().filter(function(){return"auto"!==t(this).css("z-index")}).first().css("z-index"))+10,l=this.component?this.component.parent().offset():this.element.offset(),c=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),u=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),d=l.left,p=l.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(d-=e-u)):(this.picker.addClass("datepicker-orient-left"),l.left<0?d-=l.left-n:l.left+e>s&&(d=s-e-n));var f,m,g=this.o.orientation.y;"auto"===g&&(f=-r+l.top-i,m=r+o-(l.top+c+i),g=Math.max(f,m)===m?"top":"bottom"),this.picker.addClass("datepicker-orient-"+g),"top"===g?p+=c:p-=i+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:d,zIndex:h})}},_allow_update:!0,update:function(){if(this._allow_update){var e=this.dates.copy(),i=[],n=!1;arguments.length?(t.each(arguments,t.proxy(function(t,e){e instanceof Date&&(e=this._local_to_utc(e)),i.push(e)},this)),n=!0):(i=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),i=i&&this.o.multidate?i.split(this.o.multidateSeparator):[i],delete this.element.data().date),i=t.map(i,t.proxy(function(t){return m.parseDate(t,this.o.format,this.o.language)},this)),i=t.grep(i,t.proxy(function(t){return t<this.o.startDate||t>this.o.endDate||!t},this),!0),this.dates.replace(i),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),n?this.setValue():i.length&&String(e)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&e.length&&this._trigger("clearDate"),this.fill()}},fillDow:function(){var t=this.o.weekStart,e="<tr>";if(this.o.calendarWeeks){var i='<th class="cw">&nbsp;</th>';e+=i,this.picker.find(".datepicker-days thead tr:first-child").prepend(i)}for(;t<this.o.weekStart+7;)e+='<th class="dow">'+f[this.o.language].daysMin[t++%7]+"</th>";e+="</tr>",this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){for(var t="",e=0;12>e;)t+='<span class="month">'+f[this.o.language].monthsShort[e++]+"</span>";this.picker.find(".datepicker-months td").html(t)},setRange:function(e){e&&e.length?this.range=t.map(e,function(t){return t.valueOf()}):delete this.range,this.fill()},getClassNames:function(e){var i=[],n=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),o=new Date;return e.getUTCFullYear()<n||e.getUTCFullYear()===n&&e.getUTCMonth()<s?i.push("old"):(e.getUTCFullYear()>n||e.getUTCFullYear()===n&&e.getUTCMonth()>s)&&i.push("new"),this.focusDate&&e.valueOf()===this.focusDate.valueOf()&&i.push("focused"),this.o.todayHighlight&&e.getUTCFullYear()===o.getFullYear()&&e.getUTCMonth()===o.getMonth()&&e.getUTCDate()===o.getDate()&&i.push("today"),-1!==this.dates.contains(e)&&i.push("active"),(e.valueOf()<this.o.startDate||e.valueOf()>this.o.endDate||-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled))&&i.push("disabled"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&i.push("range"),-1!==t.inArray(e.valueOf(),this.range)&&i.push("selected")),i},fill:function(){var n,s=new Date(this.viewDate),o=s.getUTCFullYear(),r=s.getUTCMonth(),a=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,h=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,l=1/0!==this.o.endDate?this.o.endDate.getUTCFullYear():1/0,c=1/0!==this.o.endDate?this.o.endDate.getUTCMonth():1/0,u=f[this.o.language].today||f.en.today||"",d=f[this.o.language].clear||f.en.clear||"";this.picker.find(".datepicker-days thead th.datepicker-switch").text(f[this.o.language].months[r]+" "+o),this.picker.find("tfoot th.today").text(u).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.clear").text(d).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var p=i(o,r-1,28),g=m.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(g),p.setUTCDate(g-(p.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(p);v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();for(var w,y=[];p.valueOf()<v;){if(p.getUTCDay()===this.o.weekStart&&(y.push("<tr>"),this.o.calendarWeeks)){var _=new Date(+p+(this.o.weekStart-p.getUTCDay()-7)%7*864e5),b=new Date(Number(_)+(11-_.getUTCDay())%7*864e5),x=new Date(Number(x=i(b.getUTCFullYear(),0,1))+(11-x.getUTCDay())%7*864e5),C=(b-x)/864e5/7+1;y.push('<td class="cw">'+C+"</td>")}if(w=this.getClassNames(p),w.push("day"),this.o.beforeShowDay!==t.noop){var j=this.o.beforeShowDay(this._utc_to_local(p));j===e?j={}:"boolean"==typeof j?j={enabled:j}:"string"==typeof j&&(j={classes:j}),j.enabled===!1&&w.push("disabled"),j.classes&&(w=w.concat(j.classes.split(/\s+/))),j.tooltip&&(n=j.tooltip)}w=t.unique(w),y.push('<td class="'+w.join(" ")+'"'+(n?' title="'+n+'"':"")+">"+p.getUTCDate()+"</td>"),p.getUTCDay()===this.o.weekEnd&&y.push("</tr>"),p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(y.join(""));var T=this.picker.find(".datepicker-months").find("th:eq(1)").text(o).end().find("span").removeClass("active");t.each(this.dates,function(t,e){e.getUTCFullYear()===o&&T.eq(e.getUTCMonth()).addClass("active")}),(a>o||o>l)&&T.addClass("disabled"),o===a&&T.slice(0,h).addClass("disabled"),o===l&&T.slice(c+1).addClass("disabled"),y="",o=10*parseInt(o/10,10);var S=this.picker.find(".datepicker-years").find("th:eq(1)").text(o+"-"+(o+9)).end().find("td");o-=1;for(var E,k=t.map(this.dates,function(t){return t.getUTCFullYear()}),D=-1;11>D;D++)E=["year"],-1===D?E.push("old"):10===D&&E.push("new"),-1!==t.inArray(o,k)&&E.push("active"),(a>o||o>l)&&E.push("disabled"),y+='<span class="'+E.join(" ")+'">'+o+"</span>",o+=1;S.html(y)},updateNavArrows:function(){if(this._allow_update){var t=new Date(this.viewDate),e=t.getUTCFullYear(),i=t.getUTCMonth();switch(this.viewMode){case 0:this.picker.find(".prev").css(this.o.startDate!==-1/0&&e<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(1/0!==this.o.endDate&&e>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"});break;case 1:case 2:this.picker.find(".prev").css(this.o.startDate!==-1/0&&e<=this.o.startDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(1/0!==this.o.endDate&&e>=this.o.endDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"})}}},click:function(e){e.preventDefault();var n,s,o,r=t(e.target).closest("span, td, th");if(1===r.length)switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var a=m.modes[this.viewMode].navStep*("prev"===r[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,a),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,a),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var h=new Date;h=i(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0),this.showMode(-2);var l="linked"===this.o.todayBtn?null:"view";this._setDate(h,l);break;case"clear":var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input")),c&&c.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":r.is(".disabled")||(this.viewDate.setUTCDate(1),r.is(".month")?(o=1,s=r.parent().find("span").index(r),n=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(i(n,s,o))):(o=1,s=0,n=parseInt(r.text(),10)||0,this.viewDate.setUTCFullYear(n),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(i(n,s,o))),this.showMode(-1),this.fill());break;case"td":r.is(".day")&&!r.is(".disabled")&&(o=parseInt(r.text(),10)||1,n=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),r.is(".old")?0===s?(s=11,n-=1):s-=1:r.is(".new")&&(11===s?(s=0,n+=1):s+=1),this._setDate(i(n,s,o)))}this.picker.is(":visible")&&this._focused_from&&t(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(t){var e=this.dates.contains(t);if(t?-1!==e?this.dates.remove(e):this.dates.push(t):this.dates.clear(),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(t,e){e&&"date"!==e||this._toggle_multidate(t&&new Date(t)),e&&"view"!==e||(this.viewDate=t&&new Date(t)),this.fill(),this.setValue(),this._trigger("changeDate");var i;this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&i.change(),!this.o.autoclose||e&&"date"!==e||this.hide()},moveMonth:function(t,i){if(!t)return e;if(!i)return t;var n,s,o=new Date(t.valueOf()),r=o.getUTCDate(),a=o.getUTCMonth(),h=Math.abs(i);if(i=i>0?1:-1,1===h)s=-1===i?function(){return o.getUTCMonth()===a}:function(){return o.getUTCMonth()!==n},n=a+i,o.setUTCMonth(n),(0>n||n>11)&&(n=(n+12)%12);else{for(var l=0;h>l;l++)o=this.moveMonth(o,i);n=o.getUTCMonth(),o.setUTCDate(r),s=function(){return n!==o.getUTCMonth()}}for(;s();)o.setUTCDate(--r),o.setUTCMonth(n);return o},moveYear:function(t,e){return this.moveMonth(t,12*e)},dateWithinRange:function(t){return t>=this.o.startDate&&t<=this.o.endDate},keydown:function(t){if(this.picker.is(":not(:visible)"))return void(27===t.keyCode&&this.show());var e,i,s,o=!1,r=this.focusDate||this.viewDate;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;e=37===t.keyCode?-1:1,t.ctrlKey?(i=this.moveYear(this.dates.get(-1)||n(),e),s=this.moveYear(r,e),this._trigger("changeYear",this.viewDate)):t.shiftKey?(i=this.moveMonth(this.dates.get(-1)||n(),e),s=this.moveMonth(r,e),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||n()),i.setUTCDate(i.getUTCDate()+e),s=new Date(r),s.setUTCDate(r.getUTCDate()+e)),this.dateWithinRange(i)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),t.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;e=38===t.keyCode?-1:1,t.ctrlKey?(i=this.moveYear(this.dates.get(-1)||n(),e),s=this.moveYear(r,e),this._trigger("changeYear",this.viewDate)):t.shiftKey?(i=this.moveMonth(this.dates.get(-1)||n(),e),s=this.moveMonth(r,e),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||n()),i.setUTCDate(i.getUTCDate()+7*e),s=new Date(r),s.setUTCDate(r.getUTCDate()+7*e)),this.dateWithinRange(i)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),t.preventDefault());break;case 32:break;case 13:r=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(r),o=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(t.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(o){this._trigger(this.dates.length?"changeDate":"clearDate");var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.change()}},showMode:function(t){t&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+t))),this.picker.find(">div").hide().filter(".datepicker-"+m.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var c=function(e,i){this.element=t(e),this.inputs=t.map(i.inputs,function(t){return t.jquery?t[0]:t}),delete i.inputs,t(this.inputs).datepicker(i).bind("changeDate",t.proxy(this.dateUpdated,this)),this.pickers=t.map(this.inputs,function(e){return t(e).data("datepicker")}),this.updateDates()};c.prototype={updateDates:function(){this.dates=t.map(this.pickers,function(t){return t.getUTCDate()}),this.updateRanges()},updateRanges:function(){var e=t.map(this.dates,function(t){return t.valueOf()});t.each(this.pickers,function(t,i){i.setRange(e)})},dateUpdated:function(e){if(!this.updating){this.updating=!0;var i=t(e.target).data("datepicker"),n=i.getUTCDate(),s=t.inArray(e.target,this.inputs),o=this.inputs.length;if(-1!==s){if(t.each(this.pickers,function(t,e){e.getUTCDate()||e.setUTCDate(n)}),n<this.dates[s])for(;s>=0&&n<this.dates[s];)this.pickers[s--].setUTCDate(n);else if(n>this.dates[s])for(;o>s&&n>this.dates[s];)this.pickers[s++].setUTCDate(n);this.updateDates(),delete this.updating}}},remove:function(){t.map(this.pickers,function(t){t.remove()}),delete this.element.data().datepicker}};var u=t.fn.datepicker;t.fn.datepicker=function(i){var n=Array.apply(null,arguments);n.shift();var s;return this.each(function(){var a=t(this),h=a.data("datepicker"),u="object"==typeof i&&i;if(!h){var p=o(this,"date"),f=t.extend({},d,p,u),m=r(f.language),g=t.extend({},d,m,p,u);if(a.is(".input-daterange")||g.inputs){var v={inputs:g.inputs||a.find("input").toArray()};a.data("datepicker",h=new c(this,t.extend(g,v)))}else a.data("datepicker",h=new l(this,g))}return"string"==typeof i&&"function"==typeof h[i]&&(s=h[i].apply(h,n),s!==e)?!1:void 0}),s!==e?s:this};var d=t.fn.datepicker.defaults={autoclose:!1,beforeShowDay:t.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=t.fn.datepicker.locale_opts=["format","rtl","weekStart"];t.fn.datepicker.Constructor=l;var f=t.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},m={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(t){return t%4===0&&t%100!==0||t%400===0},getDaysInMonth:function(t,e){return[31,m.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(t){var e=t.replace(this.validParts,"\x00").split("\x00"),i=t.match(this.validParts);if(!e||!e.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:e,parts:i}},parseDate:function(n,s,o){function r(){var t=this.slice(0,d[c].length),e=d[c].slice(0,t.length);return t===e}if(!n)return e;if(n instanceof Date)return n;"string"==typeof s&&(s=m.parseFormat(s));var a,h,c,u=/([\-+]\d+)([dmwy])/,d=n.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(n)){for(n=new Date,c=0;c<d.length;c++)switch(a=u.exec(d[c]),h=parseInt(a[1]),a[2]){case"d":n.setUTCDate(n.getUTCDate()+h);break;case"m":n=l.prototype.moveMonth.call(l.prototype,n,h);break;case"w":n.setUTCDate(n.getUTCDate()+7*h);break;case"y":n=l.prototype.moveYear.call(l.prototype,n,h)}return i(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0,0,0)}d=n&&n.match(this.nonpunctuation)||[],n=new Date;var p,g,v={},w=["yyyy","yy","M","MM","m","mm","d","dd"],y={yyyy:function(t,e){return t.setUTCFullYear(e)},yy:function(t,e){return t.setUTCFullYear(2e3+e)},m:function(t,e){if(isNaN(t))return t;for(e-=1;0>e;)e+=12;for(e%=12,t.setUTCMonth(e);t.getUTCMonth()!==e;)t.setUTCDate(t.getUTCDate()-1);return t},d:function(t,e){return t.setUTCDate(e)}};y.M=y.MM=y.mm=y.m,y.dd=y.d,n=i(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var _=s.parts.slice();if(d.length!==_.length&&(_=t(_).filter(function(e,i){return-1!==t.inArray(i,w)}).toArray()),d.length===_.length){var b;for(c=0,b=_.length;b>c;c++){if(p=parseInt(d[c],10),a=_[c],isNaN(p))switch(a){case"MM":g=t(f[o].months).filter(r),p=t.inArray(g[0],f[o].months)+1;break;case"M":g=t(f[o].monthsShort).filter(r),p=t.inArray(g[0],f[o].monthsShort)+1}v[a]=p}var x,C;for(c=0;c<w.length;c++)C=w[c],C in v&&!isNaN(v[C])&&(x=new Date(n),y[C](x,v[C]),isNaN(x)||(n=x))}return n},formatDate:function(e,i,n){if(!e)return"";"string"==typeof i&&(i=m.parseFormat(i));var s={d:e.getUTCDate(),D:f[n].daysShort[e.getUTCDay()],DD:f[n].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:f[n].monthsShort[e.getUTCMonth()],MM:f[n].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m,e=[];for(var o=t.extend([],i.separators),r=0,a=i.parts.length;a>=r;r++)o.length&&e.push(o.shift()),e.push(s[i.parts[r]]);return e.join("")},headTemplate:'<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};m.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+m.headTemplate+"<tbody></tbody>"+m.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+m.headTemplate+m.contTemplate+m.footTemplate+"</table></div></div>",t.fn.datepicker.DPGlobal=m,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=u,this},t(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(e){var i=t(this);i.data("datepicker")||(e.preventDefault(),i.datepicker("show"))}),t(function(){t('[data-provide="datepicker-inline"]').datepicker()})}(window.jQuery),function(t){t.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam","Son"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa","So"],months:["Januar","Februar","M\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","M\xe4r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",clear:"L\xf6schen",weekStart:1,format:"dd.mm.yyyy"}}(jQuery),function(t){"use strict";function e(e,i){var n=this,s=e.attr("name")||i.name||"";e.parent().hide();var o=e.css("width");e.parent().show(),"0px"==o&&(o=e.outerWidth()+20),this.$el=e.hide(),this.options=i,this.$parent=t("<div"+t.map(["class","title"],function(t){var e=n.$el.attr(t)||"";return e=("class"===t?"ms-parent"+(e?" ":""):"")+e,e?" "+t+'="'+e+'"':""}).join("")+" />"),this.$choice=t('<button type="button" class="ms-choice"><span class="placeholder">'+i.placeholder+"</span><div></div></button>"),this.$drop=t('<div class="ms-drop '+i.position+'"></div>'),this.$el.after(this.$parent),this.$parent.append(this.$choice),this.$parent.append(this.$drop),this.$el.prop("disabled")&&this.$choice.addClass("disabled"),this.$parent.css("width",i.width||o),this.options.keepOpen||t("body").click(function(e){t(e.target)[0]!==n.$choice[0]&&t(e.target).parents(".ms-choice")[0]!==n.$choice[0]&&(t(e.target)[0]!==n.$drop[0]&&t(e.target).parents(".ms-drop")[0]===n.$drop[0]||!n.options.isOpen||n.close())}),this.selectAllName='name="selectAll'+s+'"',this.selectGroupName='name="selectGroup'+s+'"',this.selectItemName='name="selectItem'+s+'"'}e.prototype={constructor:e,init:function(){var e=this,i=[];this.options.filter&&i.push('<div class="ms-search">','<input type="text" autocomplete="off" autocorrect="off" autocapitilize="off" spellcheck="false">',"</div>"),i.push("<ul>"),this.options.selectAll&&!this.options.single&&i.push('<li class="ms-select-all">',"<label>",'<input type="checkbox" '+this.selectAllName+" /> ",this.options.selectAllDelimiter[0]+this.options.selectAllText+this.options.selectAllDelimiter[1],"</label>","</li>"),t.each(this.$el.children(),function(t,n){i.push(e.optionToHtml(t,n))}),i.push('<li class="ms-no-results">'+this.options.noMatchesFound+"</li>"),i.push("</ul>"),this.$drop.html(i.join("")),this.$drop.find("ul").css("max-height",this.options.maxHeight+"px"),this.$drop.find(".multiple").css("width",this.options.multipleWidth+"px"),this.$searchInput=this.$drop.find(".ms-search input"),this.$selectAll=this.$drop.find("input["+this.selectAllName+"]"),this.$selectGroups=this.$drop.find("input["+this.selectGroupName+"]"),this.$selectItems=this.$drop.find("input["+this.selectItemName+"]:enabled"),this.$disableItems=this.$drop.find("input["+this.selectItemName+"]:disabled"),this.$noResults=this.$drop.find(".ms-no-results"),this.events(),this.updateSelectAll(!0),this.update(!0),this.options.isOpen&&this.open()},optionToHtml:function(e,i,n,s){var o,r=this,a=t(i),h=[],l=this.options.multiple,c=["class","title"],u=t.map(c,function(t){var e="class"===t&&l,i=a.attr(t)||"";return e||i?" "+t+'="'+(e?"multiple"+(i?" ":""):"")+i+'"':""}).join(""),d=this.options.single?"radio":"checkbox";if(a.is("option")){var p=a.val(),f=r.options.textTemplate(a),m=void 0!=r.$el.attr("multiple")?a.prop("selected"):"selected"==a.attr("selected"),g=this.options.styler(p)?' style="'+this.options.styler(p)+'"':"";o=s||a.prop("disabled"),this.options.blockSeparator>""&&this.options.blockSeparator==a.val()?h.push("<li"+u+g+">",'<label class="'+this.options.blockSeparator+(o?"disabled":"")+'">',f,"</label>","</li>"):h.push("<li"+u+g+">","<label"+(o?' class="disabled"':"")+">",'<input type="'+d+'" '+this.selectItemName+' value="'+p+'"'+(m?' checked="checked"':"")+(o?' disabled="disabled"':"")+(n?' data-group="'+n+'"':"")+"/> ",f,"</label>","</li>")}else if(!n&&a.is("optgroup")){var v="group_"+e,w=a.attr("label");o=a.prop("disabled"),h.push('<li class="group">','<label class="optgroup'+(o?" disabled":"")+'" data-group="'+v+'">',this.options.hideOptgroupCheckboxes?"":'<input type="checkbox" '+this.selectGroupName+(o?' disabled="disabled"':"")+" /> ",w,"</label>","</li>"),t.each(a.children(),function(t,e){h.push(r.optionToHtml(t,e,v,o))})}return h.join("")},events:function(){function e(t){t.preventDefault(),i[i.options.isOpen?"close":"open"]()}var i=this,n=this.$el.parent().closest("label")[0]||t("label[for="+this.$el.attr("id")+"]")[0];n&&t(n).off("click").on("click",function(t){"label"===t.target.nodeName.toLowerCase()&&t.target===this&&(e(t),i.options.filter&&i.options.isOpen||i.focus(),t.stopPropagation())}),this.$choice.off("click").on("click",e).off("focus").on("focus",this.options.onFocus).off("blur").on("blur",this.options.onBlur),this.$parent.off("keydown").on("keydown",function(t){switch(t.which){case 27:i.close(),i.$choice.focus()}}),this.$searchInput.off("keydown").on("keydown",function(t){9===t.keyCode&&t.shiftKey&&i.close()
}).off("keyup").on("keyup",function(t){return i.options.filterAcceptOnEnter&&(13===t.which||32==t.which)&&i.$searchInput.val()?(i.$selectAll.click(),i.close(),void i.focus()):void i.filter()}),this.$selectAll.off("click").on("click",function(){var e=t(this).prop("checked"),n=i.$selectItems.filter(":visible");n.length===i.$selectItems.length?i[e?"checkAll":"uncheckAll"]():(i.$selectGroups.prop("checked",e),n.prop("checked",e),i.options[e?"onCheckAll":"onUncheckAll"](),i.update())}),this.$selectGroups.off("click").on("click",function(){var e=t(this).parent().attr("data-group"),n=i.$selectItems.filter(":visible"),s=n.filter('[data-group="'+e+'"]'),o=s.length!==s.filter(":checked").length;s.prop("checked",o),i.updateSelectAll(),i.update(),i.options.onOptgroupClick({label:t(this).parent().text(),checked:o,children:s.get()})}),this.$selectItems.off("click").on("click",function(){i.updateSelectAll(),i.update(),i.updateOptGroupSelect(),i.options.onClick({label:t(this).parent().text(),value:t(this).val(),checked:t(this).prop("checked")}),i.options.single&&i.options.isOpen&&!i.options.keepOpen&&i.close()})},open:function(){if(!this.$choice.hasClass("disabled")){if(this.options.isOpen=!0,this.$choice.find(">div").addClass("open"),this.$drop.show(),this.$selectAll.parent().show(),this.$noResults.hide(),0===this.$el.children().length&&(this.$selectAll.parent().hide(),this.$noResults.show()),this.options.container){var e=this.$drop.offset();this.$drop.appendTo(t(this.options.container)),this.$drop.offset({top:e.top,left:e.left})}this.options.filter&&(this.$searchInput.val(""),this.$searchInput.focus(),this.filter()),this.options.onOpen()}},close:function(){this.options.isOpen=!1,this.$choice.find(">div").removeClass("open"),this.$drop.hide(),this.options.container&&(this.$parent.append(this.$drop),this.$drop.css({top:"auto",left:"auto"})),this.options.onClose()},update:function(e){var i=this.getSelects(),n=this.$choice.find(">span");0===i.length?n.addClass("placeholder").html(this.options.placeholder):n.removeClass("placeholder").html(this.options.countSelected&&i.length<this.options.minimumCountSelected?(this.options.displayValues?i:this.getSelects("text")).join(this.options.delimiter):this.options.allSelected&&i.length===this.$selectItems.length+this.$disableItems.length?this.options.allSelected:(this.options.countSelected||this.options.etcaetera)&&i.length>this.options.minimumCountSelected?this.options.etcaetera?(this.options.displayValues?i:this.getSelects("text").slice(0,this.options.minimumCountSelected)).join(this.options.delimiter)+"...":this.options.countSelected.replace("#",i.length).replace("%",this.$selectItems.length+this.$disableItems.length):(this.options.displayValues?i:this.getSelects("text")).join(this.options.delimiter)),this.$el.val(this.getSelects()),this.$drop.find("li").removeClass("selected"),this.$drop.find("input["+this.selectItemName+"]:checked").each(function(){t(this).parents("li").first().addClass("selected")}),e||this.$el.trigger("change")},updateSelectAll:function(t){var e=this.$selectItems;t||(e=e.filter(":visible")),this.$selectAll.prop("checked",e.length&&e.length===e.filter(":checked").length),this.$selectAll.prop("checked")&&this.options.onCheckAll()},updateOptGroupSelect:function(){var e=this.$selectItems.filter(":visible");t.each(this.$selectGroups,function(i,n){var s=t(n).parent().attr("data-group"),o=e.filter('[data-group="'+s+'"]');t(n).prop("checked",o.length&&o.length===o.filter(":checked").length)})},getSelects:function(e){var i=this,n=[],s=[];return this.$drop.find("input["+this.selectItemName+"]:checked").each(function(){n.push(t(this).parents("li").first().text()),s.push(t(this).val())}),"text"===e&&this.$selectGroups.length&&(n=[],this.$selectGroups.each(function(){var e=[],s=t.trim(t(this).parent().text()),o=t(this).parent().data("group"),r=i.$drop.find("["+i.selectItemName+'][data-group="'+o+'"]'),a=r.filter(":checked");if(0!==a.length){if(e.push("["),e.push(s),r.length>a.length){var h=[];a.each(function(){h.push(t(this).parent().text())}),e.push(": "+h.join(", "))}e.push("]"),n.push(e.join(""))}})),"text"===e?n:s},setSelects:function(e){var i=this;this.$selectItems.prop("checked",!1),t.each(e,function(t,e){i.$selectItems.filter('[value="'+e+'"]').prop("checked",!0)}),this.$selectAll.prop("checked",this.$selectItems.length===this.$selectItems.filter(":checked").length),this.update()},enable:function(){this.$choice.removeClass("disabled")},disable:function(){this.$choice.addClass("disabled")},checkAll:function(){this.$selectItems.prop("checked",!0),this.$selectGroups.prop("checked",!0),this.$selectAll.prop("checked",!0),this.update(),this.options.onCheckAll()},uncheckAll:function(){this.$selectItems.prop("checked",!1),this.$selectGroups.prop("checked",!1),this.$selectAll.prop("checked",!1),this.update(),this.options.onUncheckAll()},focus:function(){this.$choice.focus(),this.options.onFocus()},blur:function(){this.$choice.blur(),this.options.onBlur()},refresh:function(){this.init()},filter:function(){var e=this,i=t.trim(this.$searchInput.val()).toLowerCase();0===i.length?(this.$selectItems.parent().show(),this.$disableItems.parent().show(),this.$selectGroups.parent().show()):(this.$selectItems.each(function(){var e=t(this).parent();e[e.text().toLowerCase().indexOf(i)<0?"hide":"show"]()}),this.$disableItems.parent().hide(),this.$selectGroups.each(function(){var i=t(this).parent(),n=i.attr("data-group"),s=e.$selectItems.filter(":visible");i[0===s.filter('[data-group="'+n+'"]').length?"hide":"show"]()}),this.$selectItems.filter(":visible").length?(this.$selectAll.parent().show(),this.$noResults.hide()):(this.$selectAll.parent().hide(),this.$noResults.show())),this.updateOptGroupSelect(),this.updateSelectAll()}},t.fn.multipleSelect=function(){var i,n=arguments[0],s=arguments,o=["getSelects","setSelects","enable","disable","checkAll","uncheckAll","focus","blur","refresh"];return this.each(function(){var r=t(this),a=r.data("multipleSelect"),h=t.extend({},t.fn.multipleSelect.defaults,r.data(),"object"==typeof n&&n);if(a||(a=new e(r,h),r.data("multipleSelect",a)),"string"==typeof n){if(t.inArray(n,o)<0)throw"Unknown method: "+n;i=a[n](s[1])}else a.init(),s[1]&&(i=a[s[1]].apply(a,[].slice.call(s,2)))}),i?i:this},t.fn.multipleSelect.defaults={name:"",isOpen:!1,placeholder:"",selectAll:!0,selectAllText:"Select all",selectAllDelimiter:["[","]"],allSelected:"All selected",minimumCountSelected:3,countSelected:"# of % selected",noMatchesFound:"No matches found",multiple:!1,multipleWidth:80,single:!1,filter:!1,width:void 0,maxHeight:250,container:null,position:"bottom",keepOpen:!1,blockSeparator:"",displayValues:!1,delimiter:", ",styler:function(){return!1},textTemplate:function(t){return t.text()},onOpen:function(){return!1},onClose:function(){return!1},onCheckAll:function(){return!1},onUncheckAll:function(){return!1},onFocus:function(){return!1},onBlur:function(){return!1},onOptgroupClick:function(){return!1},onClick:function(){return!1}}}(jQuery);var Magic360=function(){function t(t){var e=[],i=null;return t&&(i=s(t))&&(e=f.tools.filter(function(t){return t.o===i})),e.length?e[0]:null}var e,i;e=i=function(){function t(t){var e=t.charAt(0).toUpperCase()+t.slice(1);return t in a||"Webkit"+e in a||"Moz"+e in a||"ms"+e in a||"O"+e in a}function e(t){var e;return!(t in a)&&(e=n.jBrowser.cssDomPrefix+t.charAt(0).toUpperCase()+t.slice(1),e in a)?e:t}{var i={version:"v3.3.b1",UUID:0,storage:{},$uuid:function(t){return t.$J_UUID||(t.$J_UUID=++n.UUID)},getStorage:function(t){return n.storage[t]||(n.storage[t]={})},$F:function(){},$false:function(){return!1},$true:function(){return!0},stylesId:"mjs-"+Math.floor(Math.random()*(new Date).getTime()),defined:function(t){return void 0!=t},ifndef:function(t,e){return void 0!=t?t:e},exists:function(t){return!!t},jTypeOf:function(t){if(!n.defined(t))return!1;if(t.$J_TYPE)return t.$J_TYPE;if(t.nodeType){if(1==t.nodeType)return"element";if(3==t.nodeType)return"textnode"}if(t.length&&t.item)return"collection";if(t.length&&t.callee)return"arguments";if((t instanceof window.Object||t instanceof window.Function)&&t.constructor===n.Class)return"class";if(t instanceof window.Array)return"array";if(t instanceof window.Function)return"function";if(t instanceof window.String)return"string";if(n.jBrowser.trident){if(n.defined(t.cancelBubble))return"event"}else if(t===window.event||t.constructor==window.Event||t.constructor==window.MouseEvent||t.constructor==window.UIEvent||t.constructor==window.KeyboardEvent||t.constructor==window.KeyEvent)return"event";return t instanceof window.Date?"date":t instanceof window.RegExp?"regexp":t===window?"window":t===document?"document":typeof t},extend:function(t,e){t instanceof window.Array||(t=[t]);for(var i=0,s=t.length;s>i;i++)if(n.defined(t))for(var o in e||{})try{t[i][o]=e[o]}catch(r){}return t[0]},implement:function(t,e){t instanceof window.Array||(t=[t]);for(var i=0,s=t.length;s>i;i++)if(n.defined(t[i])&&t[i].prototype)for(var o in e||{})t[i].prototype[o]||(t[i].prototype[o]=e[o]);return t[0]},nativize:function(t,e){if(!n.defined(t))return t;for(var i in e||{})t[i]||(t[i]=e[i]);return t},$try:function(){for(var t=0,e=arguments.length;e>t;t++)try{return arguments[t]()}catch(i){}return null},$A:function(t){if(!n.defined(t))return n.$([]);if(t.toArray)return n.$(t.toArray());if(t.item){for(var e=t.length||0,i=new Array(e);e--;)i[e]=t[e];return n.$(i)}return n.$(Array.prototype.slice.call(t))},now:function(){return(new Date).getTime()},detach:function(t){var e;switch(n.jTypeOf(t)){case"object":e={};for(var i in t)e[i]=n.detach(t[i]);break;case"array":e=[];for(var s=0,o=t.length;o>s;s++)e[s]=n.detach(t[s]);break;default:return t}return n.$(e)},$:function(t){if(!n.defined(t))return null;if(t.$J_EXT)return t;switch(n.jTypeOf(t)){case"array":return t=n.nativize(t,n.extend(n.Array,{$J_EXT:n.$F})),t.jEach=t.forEach,t;case"string":if(t){var e=document.getElementById(t);return n.defined(e)?n.$(e):null}break;case"window":case"document":n.$uuid(t),t=n.extend(t,n.Doc);break;case"element":n.$uuid(t),t=n.extend(t,n.Element);break;case"event":t=n.extend(t,n.Event);break;case"textnode":return t;case"function":case"array":case"date":}return n.extend(t,{$J_EXT:n.$F})},$new:function(t,e,i){return n.$(n.doc.createElement(t)).setProps(e||{}).jSetCss(i||{})},addCSS:function(t,e,i){var s,o,r,a=[],h=-1;if(i||(i=n.stylesId),s=n.$(i)||(document.head||document.body).appendChild(n.$new("style",{id:i,type:"text/css"})),o=s.sheet||s.styleSheet,"string"!=n.jTypeOf(e)){for(var r in e)a.push(r+":"+e[r]);e=a.join(";")}return h=o.insertRule?o.insertRule(t+" {"+e+"}",o.cssRules.length):o.addRule(t,e)},removeCSS:function(t,e){var i,s;i=n.$(t),"element"===n.jTypeOf(i)&&(s=i.sheet||i.styleSheet,s.deleteRule?s.deleteRule(e):s.removeRule&&s.removeRule(e))},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)}).toUpperCase()},getAbsoluteURL:function(t){if(/^http(s)?:\/\//.test(t))return t;var e=document.createElement("div");return e.innerHTML='<a href="'+t+'">x</a>',e.firstChild.href},getHashCode:function(t){for(var e=0,i=t.length,n=0;i>n;++n)e=31*e+t.charCodeAt(n),e%=4294967296;return e}},n=i;i.$}window.magicJS||(window.magicJS=i,window.$mjs=i.$),n.Array={$J_TYPE:"array",indexOf:function(t,e){for(var i=(this.length,this.length),n=0>e?Math.max(0,i+e):e||0;i>n;n++)if(this[n]===t)return n;return-1},contains:function(t,e){return-1!=this.indexOf(t,e)},forEach:function(t,e){for(var i=0,n=this.length;n>i;i++)i in this&&t.call(e,this[i],i,this)},filter:function(t,e){for(var i=[],n=0,s=this.length;s>n;n++)if(n in this){var o=this[n];t.call(e,this[n],n,this)&&i.push(o)}return i},map:function(t,e){for(var i=[],n=0,s=this.length;s>n;n++)n in this&&(i[n]=t.call(e,this[n],n,this));return i}},n.implement(String,{$J_TYPE:"string",jTrim:function(){return this.replace(/^\s+|\s+$/g,"")},eq:function(t,e){return e?this.toString()===t.toString():this.toLowerCase().toString()===t.toLowerCase().toString()},jCamelize:function(){return this.replace(/-\D/g,function(t){return t.charAt(1).toUpperCase()})},dashize:function(){return this.replace(/[A-Z]/g,function(t){return"-"+t.charAt(0).toLowerCase()})},jToInt:function(t){return parseInt(this,t||10)},toFloat:function(){return parseFloat(this)},jToBool:function(){return!this.replace(/true/i,"").jTrim()},has:function(t,e){return e=e||"",(e+this+e).indexOf(e+t+e)>-1}}),i.implement(Function,{$J_TYPE:"function",jBind:function(){var t=n.$A(arguments),e=this,i=t.shift();return function(){return e.apply(i||null,t.concat(n.$A(arguments)))}},jBindAsEvent:function(){var t=n.$A(arguments),e=this,i=t.shift();return function(s){return e.apply(i||null,n.$([s||window.event]).concat(t))}},jDelay:function(){var t=n.$A(arguments),e=this,i=t.shift();return window.setTimeout(function(){return e.apply(e,t)},i||0)},jDefer:function(){var t=n.$A(arguments),e=this;return function(){return e.jDelay.apply(e,t)}},interval:function(){var t=n.$A(arguments),e=this,i=t.shift();return window.setInterval(function(){return e.apply(e,t)},i||0)}});var s=navigator.userAgent.toLowerCase(),o=s.match(/(webkit|gecko|trident|presto)\/(\d+\.?\d*)/i),r=s.match(/(chrome|safari|firefox|opera)\/(\d+\.?\d*)/i),a=document.documentElement.style;n.jBrowser={features:{xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector,fullScreen:!!(document.fullscreenEnabled||document.msFullscreenEnabled||document.exitFullscreen||document.cancelFullScreen||document.webkitexitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||document.oCancelFullScreen||document.msCancelFullScreen),xhr2:!!window.ProgressEvent&&!!window.FormData&&window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,transition:t("transition"),transform:t("transform"),animation:t("animation"),multibackground:!1,requestAnimationFrame:!1},touchScreen:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}(),mobile:s.match(/(android|bb\d+|meego).+|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(jBrowser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/)?!0:!1,engine:o&&o[1]?o[1].toLowerCase():window.opera?"presto":window.ActiveXObject?"trident":void 0!==document.getBoxObjectFor||null!=window.mozInnerScreenY?"gecko":null===window.WebKitPoint&&navigator.taintEnabled?"unknown":"webkit",version:o&&o[2]?parseFloat(o[2]):0,cssPrefix:"",cssDomPrefix:"",domPrefix:"",ieMode:0,platform:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),backCompat:document.compatMode&&"backcompat"==document.compatMode.toLowerCase(),scrollbarsWidth:0,getDoc:function(){return document.compatMode&&"backcompat"==document.compatMode.toLowerCase()?document.body:document.documentElement},requestAnimationFrame:window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||void 0,cancelAnimationFrame:window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||void 0,ready:!1,onready:function(){if(!n.jBrowser.ready){var t,e;n.jBrowser.ready=!0,n.body=n.$(document.body),n.win=n.$(window);try{var i=n.$new("div").jSetCss({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999}).jAppendTo(n.body);n.jBrowser.scrollbarsWidth=i.offsetWidth-i.clientWidth,i.jRemove()}catch(s){}try{t=n.$new("div"),e=t.style,e.cssText="background:url(https://),url(https://),red url(https://)",n.jBrowser.features.multibackground=/(url\s*\(.*?){3}/.test(e.background),e=null,t=null}catch(s){}n.Doc.jCallEvent.call(n.$(document),"domready")}}},function(){var t,e,i,s=[];switch(n.jBrowser.engine){case"trident":n.jBrowser.version||(n.jBrowser.version=window.XMLHttpRequest?3:2);break;case"gecko":n.jBrowser.version=r&&r[2]?parseFloat(r[2]):0}if(n.jBrowser[n.jBrowser.engine]=!0,window.chrome&&(n.jBrowser.chrome=!0),t={gecko:["-moz-","Moz","moz"],webkit:["-webkit-","Webkit","webkit"],trident:["-ms-","ms","ms"],presto:["-o-","O","o"]}[n.jBrowser.engine]||["","",""],n.jBrowser.cssPrefix=t[0],n.jBrowser.cssDomPrefix=t[1],n.jBrowser.domPrefix=t[2],n.jBrowser.ieMode=n.jBrowser.trident?document.documentMode?document.documentMode:function(){var t=0;if(n.jBrowser.backCompat)return 5;switch(n.jBrowser.version){case 2:t=6;break;case 3:t=7}return t}():0,n.jBrowser.ieMode){for(s.push("ie"+n.jBrowser.ieMode+"-magic"),e=11;e>n.jBrowser.ieMode;e--)s.push("lt-ie"+e+"-magic");i=(document.documentElement.className||"").match(/\S+/g)||[],document.documentElement.className=n.$(i).concat(s).join(" ")}n.jBrowser.webkit&&n.jBrowser.version<536&&(n.jBrowser.features.fullScreen=!1),n.jBrowser.requestAnimationFrame&&n.jBrowser.requestAnimationFrame.call(window,function(){n.jBrowser.features.requestAnimationFrame=!0})}(),function(){n.jBrowser.fullScreen={capable:n.jBrowser.features.fullScreen,enabled:function(){return!!(document.fullscreenElement||document[n.jBrowser.domPrefix+"FullscreenElement"]||document.fullScreen||document.webkitIsFullScreen||document[n.jBrowser.domPrefix+"FullScreen"])},request:function(t,e){e||(e={}),this.capable?(n.$(document).jAddEvent(this.changeEventName,this.onchange=function(){this.enabled()?e.onEnter&&e.onEnter():(n.$(document).jRemoveEvent(this.changeEventName,this.onchange),e.onExit&&e.onExit())}.jBindAsEvent(this)),n.$(document).jAddEvent(this.errorEventName,this.onerror=function(){e.fallback&&e.fallback(),n.$(document).jRemoveEvent(this.errorEventName,this.onerror)}.jBindAsEvent(this)),(t[n.jBrowser.domPrefix+"RequestFullscreen"]||t[n.jBrowser.domPrefix+"RequestFullScreen"]||t.requestFullscreen||function(){}).call(t)):e.fallback&&e.fallback()},cancel:(document.exitFullscreen||document.cancelFullScreen||document[n.jBrowser.domPrefix+"ExitFullscreen"]||document[n.jBrowser.domPrefix+"CancelFullScreen"]||function(){}).jBind(document),changeEventName:document.msExitFullscreen?"MSFullscreenChange":(document.exitFullscreen?"":n.jBrowser.domPrefix)+"fullscreenchange",errorEventName:document.msExitFullscreen?"MSFullscreenError":(document.exitFullscreen?"":n.jBrowser.domPrefix)+"fullscreenerror",prefix:n.jBrowser.domPrefix,activeElement:null}}();var h=/\S+/g,l=/^(border(Top|Bottom|Left|Right)Width)|((padding|margin)(Top|Bottom|Left|Right))$/,c={"float":"undefined"==typeof a.styleFloat?"cssFloat":"styleFloat"},u={fontWeight:!0,lineHeight:!0,opacity:!0,zIndex:!0,zoom:!0},d=window.getComputedStyle?function(t,e){var i=window.getComputedStyle(t,null);return i?i.getPropertyValue(e)||i[e]:null}:function(t,e){var i=this.currentStyle,n=null;return n=i?i[e]:null,null==n&&t.style&&t.style[e]&&(n=t.style[e]),n};return n.normalizeCSS=e,n.Element={jHasClass:function(t){return!(t||"").has(" ")&&(this.className||"").has(t," ")},jAddClass:function(t){for(var e=(this.className||"").match(h)||[],i=(t||"").match(h)||[],s=i.length,o=0;s>o;o++)n.$(e).contains(i[o])||e.push(i[o]);return this.className=e.join(" "),this},jRemoveClass:function(t){for(var e,i=(this.className||"").match(h)||[],s=(t||"").match(h)||[],o=s.length,r=0;o>r;r++)(e=n.$(i).indexOf(s[r]))>-1&&i.splice(e,1);return this.className=t?i.join(" "):"",this},jToggleClass:function(t){return this.jHasClass(t)?this.jRemoveClass(t):this.jAddClass(t)},jGetCss:function(t){var i=t.jCamelize(),s=null;if(t=c[i]||(c[i]=e(i)),s=d(this,t),"auto"===s&&(s=null),null!==s){if("opacity"==t)return n.defined(s)?parseFloat(s):1;l.test(t)&&(s=parseInt(s,10)?s:"0px")}return s},jSetCssProp:function(t,i){var s=t.jCamelize();try{if("opacity"==t)return this.jSetOpacity(i),this;t=c[s]||(c[s]=e(s)),this.style[t]=i+("number"!=n.jTypeOf(i)||u[s]?"":"px")}catch(o){}return this},jSetCss:function(t){for(var e in t)this.jSetCssProp(e,t[e]);return this},jGetStyles:function(){var t={};return n.$A(arguments).jEach(function(e){t[e]=this.jGetCss(e)},this),t},jSetOpacity:function(t,e){var i;if(e=e||!1,t=parseFloat(t),e&&(0===t?"hidden"!=this.style.visibility&&(this.style.visibility="hidden"):"visible"!=this.style.visibility&&(this.style.visibility="visible")),n.jBrowser.ieMode&&n.jBrowser.ieMode<9){this.currentStyle&&this.currentStyle.hasLayout||(this.style.zoom=1);try{i=this.filters.item("DXImageTransform.Microsoft.Alpha"),i.enabled=1!=t,i.opacity=100*t}catch(s){i=this.currentStyle&&this.currentStyle.filter||this.style.filter||"",i+=1==t?"":" progid:DXImageTransform.Microsoft.Alpha(enabled=true,opacity="+100*t+")",this.style.filter=i}}return this.style.opacity=t,this},setProps:function(t){for(var e in t)"class"===e?this.jAddClass(""+t[e]):this.setAttribute(e,""+t[e]);return this},hide:function(){return this.jSetCss({display:"none",visibility:"hidden"})},show:function(){return this.jSetCss({display:"",visibility:"visible"})},jGetSize:function(){return{width:this.offsetWidth,height:this.offsetHeight}},getInnerSize:function(t){var e=this.jGetSize();return e.width-=parseFloat(this.jGetCss("border-left-width")||0)+parseFloat(this.jGetCss("border-right-width")||0),e.height-=parseFloat(this.jGetCss("border-top-width")||0)+parseFloat(this.jGetCss("border-bottom-width")||0),t||(e.width-=parseFloat(this.jGetCss("padding-left")||0)+parseFloat(this.jGetCss("padding-right")||0),e.height-=parseFloat(this.jGetCss("padding-top")||0)+parseFloat(this.jGetCss("padding-bottom")||0)),e},jGetScroll:function(){return{top:this.scrollTop,left:this.scrollLeft}},jGetFullScroll:function(){var t=this,e={top:0,left:0};do e.left+=t.scrollLeft||0,e.top+=t.scrollTop||0,t=t.parentNode;while(t);return e},jGetPosition:function(){var t=this,e=0,i=0;if(n.defined(document.documentElement.getBoundingClientRect)){var s=this.getBoundingClientRect(),o=n.$(document).jGetScroll(),r=n.jBrowser.getDoc();return{top:s.top+o.y-r.clientTop,left:s.left+o.x-r.clientLeft}}do e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.offsetParent;while(t&&!/^(?:body|html)$/i.test(t.tagName));return{top:i,left:e}},jGetRect:function(){var t=this.jGetPosition(),e=this.jGetSize();return{top:t.top,bottom:t.top+e.height,left:t.left,right:t.left+e.width}},changeContent:function(t){try{this.innerHTML=t}catch(e){this.innerText=t}return this},jRemove:function(){return this.parentNode?this.parentNode.removeChild(this):this},kill:function(){return n.$A(this.childNodes).jEach(function(t){3!=t.nodeType&&8!=t.nodeType&&n.$(t).kill()}),this.jRemove(),this.jClearEvents(),this.$J_UUID&&(n.storage[this.$J_UUID]=null,delete n.storage[this.$J_UUID]),null},append:function(t,e){e=e||"bottom";var i=this.firstChild;return"top"==e&&i?this.insertBefore(t,i):this.appendChild(t),this},jAppendTo:function(t,e){n.$(t).append(this,e);return this},enclose:function(t){return this.append(t.parentNode.replaceChild(this,t)),this},hasChild:function(t){return"element"!==n.jTypeOf("string"==n.jTypeOf(t)?t=document.getElementById(t):t)?!1:this==t?!1:this.contains&&!n.jBrowser.webkit419?this.contains(t):this.compareDocumentPosition?!!(16&this.compareDocumentPosition(t)):n.$A(this.byTag(t.tagName)).contains(t)}},n.Element.jGetStyle=n.Element.jGetCss,n.Element.jSetStyle=n.Element.jSetCss,window.Element||(window.Element=n.$F,n.jBrowser.engine.webkit&&window.document.createElement("iframe"),window.Element.prototype=n.jBrowser.engine.webkit?window["[[DOMElement.prototype]]"]:{}),n.implement(window.Element,{$J_TYPE:"element"}),n.Doc={jGetSize:function(){return n.jBrowser.touchScreen||n.jBrowser.presto925||n.jBrowser.webkit419?{width:window.innerWidth,height:window.innerHeight}:{width:n.jBrowser.getDoc().clientWidth,height:n.jBrowser.getDoc().clientHeight}},jGetScroll:function(){return{x:window.pageXOffset||n.jBrowser.getDoc().scrollLeft,y:window.pageYOffset||n.jBrowser.getDoc().scrollTop}},jGetFullSize:function(){var t=this.jGetSize();return{width:Math.max(n.jBrowser.getDoc().scrollWidth,t.width),height:Math.max(n.jBrowser.getDoc().scrollHeight,t.height)}}},n.extend(document,{$J_TYPE:"document"}),n.extend(window,{$J_TYPE:"window"}),n.extend([n.Element,n.Doc],{jFetch:function(t,e){var i=n.getStorage(this.$J_UUID),s=i[t];return void 0!==e&&void 0===s&&(s=i[t]=e),n.defined(s)?s:null},jStore:function(t,e){var i=n.getStorage(this.$J_UUID);return i[t]=e,this},jDel:function(t){var e=n.getStorage(this.$J_UUID);return delete e[t],this}}),window.HTMLElement&&window.HTMLElement.prototype&&window.HTMLElement.prototype.getElementsByClassName||n.extend([n.Element,n.Doc],{getElementsByClassName:function(t){return n.$A(this.getElementsByTagName("*")).filter(function(e){try{return 1==e.nodeType&&e.className.has(t," ")}catch(i){}})}}),n.extend([n.Element,n.Doc],{byClass:function(){return this.getElementsByClassName(arguments[0])},byTag:function(){return this.getElementsByTagName(arguments[0])}}),n.jBrowser.fullScreen.capable&&!document.requestFullScreen&&(n.Element.requestFullScreen=function(){n.jBrowser.fullScreen.request(this)}),n.Event={$J_TYPE:"event",isQueueStopped:n.$false,stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.stopPropagation?this.stopPropagation():this.cancelBubble=!0,this},stopDefaults:function(){return this.preventDefault?this.preventDefault():this.returnValue=!1,this},stopQueue:function(){return this.isQueueStopped=n.$true,this},jGetPageXY:function(){var t;return t=/touch/i.test(this.type)?this.changedTouches[0]:this,n.defined(t)?{x:t.pageX||t.clientX+n.jBrowser.getDoc().scrollLeft,y:t.pageY||t.clientY+n.jBrowser.getDoc().scrollTop}:{x:0,y:0}},getTarget:function(){for(var t=this.target||this.srcElement;t&&3==t.nodeType;)t=t.parentNode;return t},getRelated:function(){var t=null;switch(this.type){case"mouseover":case"pointerover":case"MSPointerOver":t=this.relatedTarget||this.fromElement;break;case"mouseout":case"pointerout":case"MSPointerOut":t=this.relatedTarget||this.toElement;break;default:return t}try{for(;t&&3==t.nodeType;)t=t.parentNode}catch(e){t=null}return t},getButton:function(){return this.which||void 0===this.button?this.which:1&this.button?1:2&this.button?3:4&this.button?2:0}},n._event_add_="addEventListener",n._event_del_="removeEventListener",n._event_prefix_="",document.addEventListener||(n._event_add_="attachEvent",n._event_del_="detachEvent",n._event_prefix_="on"),n.Event.Custom={type:"",x:null,y:null,timeStamp:null,button:null,target:null,relatedTarget:null,$J_TYPE:"event.custom",isQueueStopped:n.$false,events:n.$([]),pushToEvents:function(t){var e=t;this.events.push(e)},stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.events.jEach(function(t){try{t.stopDistribution()}catch(e){}}),this},stopDefaults:function(){return this.events.jEach(function(t){try{t.stopDefaults()}catch(e){}}),this},stopQueue:function(){return this.isQueueStopped=n.$true,this},jGetPageXY:function(){return{x:this.x,y:this.y}},getTarget:function(){return this.target},getRelated:function(){return this.relatedTarget},getButton:function(){return this.button},getOriginalTarget:function(){return this.events.length>0?this.events[0].getTarget():void 0}},n.extend([n.Element,n.Doc],{jAddEvent:function(t,e,i,s){var o,r,a,h,l;return"string"==n.jTypeOf(t)&&(l=t.split(" "),l.length>1&&(t=l)),"array"==n.jTypeOf(t)?(n.$(t).jEach(this.jAddEvent.jBindAsEvent(this,e,i,s)),this):t&&e&&"string"==n.jTypeOf(t)&&"function"==n.jTypeOf(e)?"domready"==t&&n.jBrowser.ready?(e.call(this),this):(i=parseInt(i||50),e.$J_EUID||(e.$J_EUID=Math.floor(Math.random()*n.now())),o=n.Doc.jFetch.call(this,"_EVENTS_",{}),r=o[t],r||(o[t]=r=n.$([]),a=this,n.Event.Custom[t]?n.Event.Custom[t].handler.add.call(this,s):(r.handle=function(e){e=n.extend(e||window.e,{$J_TYPE:"event"}),n.Doc.jCallEvent.call(a,t,n.$(e))},this[n._event_add_](n._event_prefix_+t,r.handle,!1))),h={type:t,fn:e,priority:i,euid:e.$J_EUID},r.push(h),r.sort(function(t,e){return t.priority-e.priority}),this):this},jRemoveEvent:function(t){var e,i,s,o,r,a,h=n.Doc.jFetch.call(this,"_EVENTS_",{});if("string"==n.jTypeOf(t)&&(a=t.split(" "),a.length>1&&(t=a)),"array"==n.jTypeOf(t))return n.$(t).jEach(this.jRemoveEvent.jBindAsEvent(this,arguments[1])),this;if(!t||"string"!=n.jTypeOf(t)||!h||!h[t])return this;for(e=h[t]||[],r=arguments[1]||null,s=0;s<e.length;s++)i=e[s],r&&r.$J_EUID!==i.euid||(o=e.splice(s--,1));return 0===e.length&&(n.Event.Custom[t]?n.Event.Custom[t].handler.jRemove.call(this):this[n._event_del_](n._event_prefix_+t,e.handle,!1),delete h[t]),this},jCallEvent:function(t,e){var i,s,o=n.Doc.jFetch.call(this,"_EVENTS_",{});if(!t||"string"!=n.jTypeOf(t)||!o||!o[t])return this;try{e=n.extend(e||{},{type:t})}catch(r){}for(void 0===e.timeStamp&&(e.timeStamp=n.now()),i=o[t]||[],s=0;s<i.length&&(!e.isQueueStopped||!e.isQueueStopped());s++)i[s].fn.call(this,e)},jRaiseEvent:function(t,e){var i,s="domready"==t?!1:!0,o=this;return s?(o===document&&document.createEvent&&!o.dispatchEvent&&(o=document.documentElement),document.createEvent?(i=document.createEvent(t),i.initEvent(e,!0,!0)):(i=document.createEventObject(),i.eventType=t),document.createEvent?o.dispatchEvent(i):o.fireEvent("on"+e,i),i):(n.Doc.jCallEvent.call(this,t),this)},jClearEvents:function(){var t=n.Doc.jFetch.call(this,"_EVENTS_");if(!t)return this;for(var e in t)n.Doc.jRemoveEvent.call(this,e);return n.Doc.jDel.call(this,"_EVENTS_"),this}}),function(t){return"complete"===document.readyState?t.jBrowser.onready.jDelay(1):void(t.jBrowser.webkit&&t.jBrowser.version<420?!function(){t.$(["loaded","complete"]).contains(document.readyState)?t.jBrowser.onready():arguments.callee.jDelay(50)}():t.jBrowser.trident&&t.jBrowser.ieMode<9&&window==top?!function(){t.$try(function(){return t.jBrowser.getDoc().doScroll("left"),!0})?t.jBrowser.onready():arguments.callee.jDelay(50)}():(t.Doc.jAddEvent.call(t.$(document),"DOMContentLoaded",t.jBrowser.onready),t.Doc.jAddEvent.call(t.$(window),"load",t.jBrowser.onready)))}(i),n.Class=function(){var t=null,e=n.$A(arguments);"class"==n.jTypeOf(e[0])&&(t=e.shift());var i=function(){for(var t in this)this[t]=n.detach(this[t]);if(this.constructor.$parent){this.$parent={};var e=this.constructor.$parent;for(var i in e){var s=e[i];switch(n.jTypeOf(s)){case"function":this.$parent[i]=n.Class.wrap(this,s);break;case"object":this.$parent[i]=n.detach(s);break;case"array":this.$parent[i]=n.detach(s)}}}var o=this.init?this.init.apply(this,arguments):this;return delete this.caller,o};if(i.prototype.init||(i.prototype.init=n.$F),t){var s=function(){};s.prototype=t.prototype,i.prototype=new s,i.$parent={};for(var o in t.prototype)i.$parent[o]=t.prototype[o]}else i.$parent=null;return i.constructor=n.Class,i.prototype.constructor=i,n.extend(i.prototype,e[0]),n.extend(i,{$J_TYPE:"class"}),i},i.Class.wrap=function(t,e){return function(){var i=(this.caller,e.apply(t,arguments));return i}},n.Event.Custom.btnclick=new n.Class(n.extend(n.Event.Custom,{type:"btnclick",init:function(t,e){var i=e.jGetPageXY();this.x=i.x,this.y=i.y,this.timeStamp=e.timeStamp,this.button=e.getButton(),this.target=t,this.pushToEvents(e)}})),n.Event.Custom.btnclick.handler={options:{threshold:200,button:1},add:function(t){this.jStore("event:btnclick:options",n.extend(n.detach(n.Event.Custom.btnclick.handler.options),t||{})),this.jAddEvent("mousedown",n.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("mouseup",n.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("click",n.Event.Custom.btnclick.handler.onclick,1),n.jBrowser.trident&&n.jBrowser.ieMode<9&&this.jAddEvent("dblclick",n.Event.Custom.btnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("mousedown",n.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("mouseup",n.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("click",n.Event.Custom.btnclick.handler.onclick),n.jBrowser.trident&&n.jBrowser.ieMode<9&&this.jRemoveEvent("dblclick",n.Event.Custom.btnclick.handler.handle)},onclick:function(t){t.stopDefaults()},handle:function(t){var e,i,s;if(i=this.jFetch("event:btnclick:options"),"dblclick"==t.type||t.getButton()==i.button)if("mousedown"==t.type)e=new n.Event.Custom.btnclick(this,t),this.jStore("event:btnclick:btnclickEvent",e);else if("mouseup"==t.type){if(e=this.jFetch("event:btnclick:btnclickEvent"),!e)return;s=t.jGetPageXY(),this.jDel("event:btnclick:btnclickEvent"),e.pushToEvents(t),t.timeStamp-e.timeStamp<=i.threshold&&e.x==s.x&&e.y==s.y&&this.jCallEvent("btnclick",e)}else"dblclick"==t.type&&(e=new n.Event.Custom.btnclick(this,t),this.jCallEvent("btnclick",e))}},n.Event.Custom.mousedrag=new n.Class(n.extend(n.Event.Custom,{type:"mousedrag",state:"dragstart",init:function(t,e,i){var n=e.jGetPageXY();
this.x=n.x,this.y=n.y,this.timeStamp=e.timeStamp,this.button=e.getButton(),this.target=t,this.pushToEvents(e),this.state=i}})),n.Event.Custom.mousedrag.handler={add:function(){this.jAddEvent("mousedown",n.Event.Custom.mousedrag.handler.handleMouseDown,1),this.jAddEvent("mouseup",n.Event.Custom.mousedrag.handler.handleMouseUp,1),this.jAddEvent("mousemove",n.Event.Custom.mousedrag.handler.handleMouseMove,1),document.jAddEvent("mouseup",n.Event.Custom.mousedrag.handler.handleMouseUp.jBindAsEvent(this),1)},jRemove:function(){this.jRemoveEvent("mousedown",n.Event.Custom.mousedrag.handler.handleMouseDown),this.jRemoveEvent("mouseup",n.Event.Custom.mousedrag.handler.handleMouseUp),this.jRemoveEvent("mousemove",n.Event.Custom.mousedrag.handler.handleMouseMove),document.jRemoveEvent("mouseup",n.Event.Custom.mousedrag.handler.handleMouseUp)},handleMouseDown:function(t){var e;t.stopDefaults(),e=new n.Event.Custom.mousedrag(this,t,"dragstart"),this.jStore("event:mousedrag:dragstart",e),this.jCallEvent("mousedrag",e)},handleMouseUp:function(t){var e;t.stopDefaults(),e=this.jFetch("event:mousedrag:dragstart"),e&&(e=new n.Event.Custom.mousedrag(this,t,"dragend"),this.jDel("event:mousedrag:dragstart"),this.jCallEvent("mousedrag",e))},handleMouseMove:function(t){var e;t.stopDefaults(),e=this.jFetch("event:mousedrag:dragstart"),e&&(e=new n.Event.Custom.mousedrag(this,t,"dragmove"),this.jCallEvent("mousedrag",e))}},n.Event.Custom.dblbtnclick=new n.Class(n.extend(n.Event.Custom,{type:"dblbtnclick",timedout:!1,tm:null,init:function(t,e){var i=e.jGetPageXY();this.x=i.x,this.y=i.y,this.timeStamp=e.timeStamp,this.button=e.getButton(),this.target=t,this.pushToEvents(e)}})),n.Event.Custom.dblbtnclick.handler={options:{threshold:200},add:function(t){this.jStore("event:dblbtnclick:options",n.extend(n.detach(n.Event.Custom.dblbtnclick.handler.options),t||{})),this.jAddEvent("btnclick",n.Event.Custom.dblbtnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("btnclick",n.Event.Custom.dblbtnclick.handler.handle)},handle:function(t){var e,i;e=this.jFetch("event:dblbtnclick:event"),i=this.jFetch("event:dblbtnclick:options"),e?(clearTimeout(e.tm),this.jDel("event:dblbtnclick:event"),e.timedout||(e.pushToEvents(t),t.stopQueue().stop(),this.jCallEvent("dblbtnclick",e))):(e=new n.Event.Custom.dblbtnclick(this,t),e.tm=setTimeout(function(){e.timedout=!0,t.isQueueStopped=n.$false,this.jCallEvent("btnclick",t)}.jBind(this),i.threshold+10),this.jStore("event:dblbtnclick:event",e),t.stopQueue())}},function(t){function e(t){return t.pointerType?("touch"===t.pointerType||t.MSPOINTER_TYPE_TOUCH===t.pointerType)&&t.isPrimary:1===t.changedTouches.length&&(t.targetTouches.length?t.targetTouches[0].identifier==t.changedTouches[0].identifier:!0)}function i(t){return t.pointerType?"touch"===t.pointerType||t.MSPOINTER_TYPE_TOUCH===t.pointerType?t.pointerId:null:t.changedTouches[0].identifier}function n(t){return t.pointerType?"touch"===t.pointerType||t.MSPOINTER_TYPE_TOUCH===t.pointerType?t:null:t.changedTouches[0]}t.$;t.Event.Custom.tap=new t.Class(t.extend(t.Event.Custom,{type:"tap",id:null,init:function(t,e){var i=n(e);this.id=i.pointerId||i.identifier,this.x=i.pageX,this.y=i.pageY,this.pageX=i.pageX,this.pageY=i.pageY,this.clientX=i.clientX,this.clientY=i.clientY,this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.pushToEvents(e)}}));var s=10,o=200;t.Event.Custom.tap.handler={add:function(){this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],t.Event.Custom.tap.handler.onTouchStart,1),this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],t.Event.Custom.tap.handler.onTouchEnd,1),this.jAddEvent("click",t.Event.Custom.tap.handler.onClick,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],t.Event.Custom.tap.handler.onTouchStart),this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],t.Event.Custom.tap.handler.onTouchEnd),this.jRemoveEvent("click",t.Event.Custom.tap.handler.onClick)},onClick:function(t){t.stopDefaults()},onTouchStart:function(i){return e(i)?(i.stopDefaults(),void this.jStore("event:tap:event",new t.Event.Custom.tap(this,i))):void this.jDel("event:tap:event")},onTouchEnd:function(r){{var a=(t.now(),this.jFetch("event:tap:event"));this.jFetch("event:tap:options")}a&&e(r)&&(this.jDel("event:tap:event"),a.id==i(r)&&r.timeStamp-a.timeStamp<=o&&Math.sqrt(Math.pow(n(r).pageX-a.x,2)+Math.pow(n(r).pageY-a.y,2))<=s&&(this.jDel("event:btnclick:btnclickEvent"),r.stop(),a.pushToEvents(r),this.jCallEvent("tap",a)))}}}(i),n.Event.Custom.dbltap=new n.Class(n.extend(n.Event.Custom,{type:"dbltap",timedout:!1,tm:null,init:function(t,e){this.x=e.x,this.y=e.y,this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.pushToEvents(e)}})),n.Event.Custom.dbltap.handler={options:{threshold:300},add:function(t){this.jStore("event:dbltap:options",n.extend(n.detach(n.Event.Custom.dbltap.handler.options),t||{})),this.jAddEvent("tap",n.Event.Custom.dbltap.handler.handle,1)},jRemove:function(){this.jRemoveEvent("tap",n.Event.Custom.dbltap.handler.handle)},handle:function(t){var e,i;e=this.jFetch("event:dbltap:event"),i=this.jFetch("event:dbltap:options"),e?(clearTimeout(e.tm),this.jDel("event:dbltap:event"),e.timedout||(e.pushToEvents(t),t.stopQueue().stop(),this.jCallEvent("dbltap",e))):(e=new n.Event.Custom.dbltap(this,t),e.tm=setTimeout(function(){e.timedout=!0,t.isQueueStopped=n.$false,this.jCallEvent("tap",t)}.jBind(this),i.threshold+10),this.jStore("event:dbltap:event",e),t.stopQueue())}},function(t){function e(t){return t.pointerType?("touch"===t.pointerType||t.MSPOINTER_TYPE_TOUCH===t.pointerType)&&t.isPrimary:1===t.changedTouches.length&&(t.targetTouches.length?t.targetTouches[0].identifier==t.changedTouches[0].identifier:!0)}function i(t){return t.pointerType?"touch"===t.pointerType||t.MSPOINTER_TYPE_TOUCH===t.pointerType?t.pointerId:null:t.changedTouches[0].identifier}function n(t){return t.pointerType?"touch"===t.pointerType||t.MSPOINTER_TYPE_TOUCH===t.pointerType?t:null:t.changedTouches[0]}var s=t.$,o=10;t.Event.Custom.touchdrag=new t.Class(t.extend(t.Event.Custom,{type:"touchdrag",state:"dragstart",id:null,dragged:!1,init:function(t,e,i){var s=n(e);this.id=s.pointerId||s.identifier,this.clientX=s.clientX,this.clientY=s.clientY,this.pageX=s.pageX,this.pageY=s.pageY,this.x=s.pageX,this.y=s.pageY,this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.pushToEvents(e),this.state=i}})),t.Event.Custom.touchdrag.handler={add:function(){var e=t.Event.Custom.touchdrag.handler.onTouchMove.jBind(this),i=t.Event.Custom.touchdrag.handler.onTouchEnd.jBind(this);this.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],t.Event.Custom.touchdrag.handler.onTouchStart,1),this.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],t.Event.Custom.touchdrag.handler.onTouchEnd,1),this.jAddEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],t.Event.Custom.touchdrag.handler.onTouchMove,1),this.jStore("event:touchdrag:listeners:document:move",e),this.jStore("event:touchdrag:listeners:document:end",i),s(document).jAddEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",e,1),s(document).jAddEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",i,1)},jRemove:function(){this.jRemoveEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],t.Event.Custom.touchdrag.handler.onTouchStart),this.jRemoveEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],t.Event.Custom.touchdrag.handler.onTouchEnd),this.jRemoveEvent(["touchmove",window.navigator.pointerEnabled?"pointermove":"MSPointerMove"],t.Event.Custom.touchdrag.handler.onTouchMove),s(document).jRemoveEvent(window.navigator.pointerEnabled?"pointermove":"MSPointerMove",this.jFetch("event:touchdrag:listeners:document:move")||t.$F,1),s(document).jRemoveEvent(window.navigator.pointerEnabled?"pointerup":"MSPointerUp",this.jFetch("event:touchdrag:listeners:document:end")||t.$F,1),this.jDel("event:touchdrag:listeners:document:move"),this.jDel("event:touchdrag:listeners:document:end")},onTouchStart:function(i){var n;e(i)&&(n=new t.Event.Custom.touchdrag(this,i,"dragstart"),this.jStore("event:touchdrag:dragstart",n))},onTouchEnd:function(e){var n;n=this.jFetch("event:touchdrag:dragstart"),n&&n.dragged&&n.id==i(e)&&(n=new t.Event.Custom.touchdrag(this,e,"dragend"),this.jDel("event:touchdrag:dragstart"),this.jCallEvent("touchdrag",n))},onTouchMove:function(s){var r;if(r=this.jFetch("event:touchdrag:dragstart"),r&&e(s)){if(r.id!=i(s))return void this.jDel("event:touchdrag:dragstart");!r.dragged&&Math.sqrt(Math.pow(n(s).pageX-r.x,2)+Math.pow(n(s).pageY-r.y,2))>o&&(r.dragged=!0,this.jCallEvent("touchdrag",r)),r.dragged&&(r=new t.Event.Custom.touchdrag(this,s,"dragmove"),this.jCallEvent("touchdrag",r))}}}}(i),n.Event.Custom.touchpinch=new n.Class(n.extend(n.Event.Custom,{type:"touchpinch",scale:1,previousScale:1,curScale:1,state:"pinchstart",init:function(t,e){this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.x=e.touches[0].clientX+(e.touches[1].clientX-e.touches[0].clientX)/2,this.y=e.touches[0].clientY+(e.touches[1].clientY-e.touches[0].clientY)/2,this._initialDistance=Math.sqrt(Math.pow(e.touches[0].clientX-e.touches[1].clientX,2)+Math.pow(e.touches[0].clientY-e.touches[1].clientY,2)),this.pushToEvents(e)},update:function(t){var e;this.state="pinchupdate",t.changedTouches[0].identifier==this.events[0].touches[0].identifier&&t.changedTouches[1].identifier==this.events[0].touches[1].identifier&&(e=Math.sqrt(Math.pow(t.changedTouches[0].clientX-t.changedTouches[1].clientX,2)+Math.pow(t.changedTouches[0].clientY-t.changedTouches[1].clientY,2)),this.previousScale=this.scale,this.scale=e/this._initialDistance,this.curScale=this.scale/this.previousScale,this.x=t.changedTouches[0].clientX+(t.changedTouches[1].clientX-t.changedTouches[0].clientX)/2,this.y=t.changedTouches[0].clientY+(t.changedTouches[1].clientY-t.changedTouches[0].clientY)/2,this.pushToEvents(t))}})),n.Event.Custom.touchpinch.handler={add:function(){this.jAddEvent("touchstart",n.Event.Custom.touchpinch.handler.handleTouchStart,1),this.jAddEvent("touchend",n.Event.Custom.touchpinch.handler.handleTouchEnd,1),this.jAddEvent("touchmove",n.Event.Custom.touchpinch.handler.handleTouchMove,1)},jRemove:function(){this.jRemoveEvent("touchstart",n.Event.Custom.touchpinch.handler.handleTouchStart),this.jRemoveEvent("touchend",n.Event.Custom.touchpinch.handler.handleTouchEnd),this.jRemoveEvent("touchmove",n.Event.Custom.touchpinch.handler.handleTouchMove)},handleTouchStart:function(t){var e;2==t.touches.length&&(t.stopDefaults(),e=new n.Event.Custom.touchpinch(this,t),this.jStore("event:touchpinch:event",e))},handleTouchEnd:function(t){var e;e=this.jFetch("event:touchpinch:event"),e&&(t.stopDefaults(),this.jDel("event:touchpinch:event"))},handleTouchMove:function(t){var e;e=this.jFetch("event:touchpinch:event"),e&&(t.stopDefaults(),e.update(t),this.jCallEvent("touchpinch",e))}},function(t){function e(){n=null}function i(e,i){return e>50||1===i&&!("win"==t.jBrowser.platform&&1>e)||0===e%12||0==e%4.000244140625}t.$;t.Event.Custom.mousescroll=new t.Class(t.extend(t.Event.Custom,{type:"mousescroll",init:function(t,e,i,n,s,o,r){var a=e.jGetPageXY();this.x=a.x,this.y=a.y,this.timeStamp=e.timeStamp,this.target=t,this.delta=i||0,this.deltaX=n||0,this.deltaY=s||0,this.deltaZ=o||0,this.deltaFactor=r||0,this.deltaMode=e.deltaMode||0,this.isMouse=!1,this.pushToEvents(e)}}));var n,s;t.Event.Custom.mousescroll.handler={eventType:"onwheel"in document||t.jBrowser.ieMode>8?"wheel":"mousewheel",add:function(){this.jAddEvent(t.Event.Custom.mousescroll.handler.eventType,t.Event.Custom.mousescroll.handler.handle,1)},jRemove:function(){this.jRemoveEvent(t.Event.Custom.mousescroll.handler.eventType,t.Event.Custom.mousescroll.handler.handle,1)},handle:function(o){var r,a,h=0,l=0,c=0,u=0;o.detail&&(c=-1*o.detail),void 0!==o.wheelDelta&&(c=o.wheelDelta),void 0!==o.wheelDeltaY&&(c=o.wheelDeltaY),void 0!==o.wheelDeltaX&&(l=-1*o.wheelDeltaX),o.deltaY&&(c=-1*o.deltaY),o.deltaX&&(l=o.deltaX),(0!==c||0!==l)&&(h=0===c?l:c,u=Math.max(Math.abs(c),Math.abs(l)),(!n||n>u)&&(n=u),r=h>0?"floor":"ceil",h=Math[r](h/n),l=Math[r](l/n),c=Math[r](c/n),s&&clearTimeout(s),s=setTimeout(e,200),a=new t.Event.Custom.mousescroll(this,o,h,l,c,0,n),a.isMouse=i(n,o.deltaMode||0),this.jCallEvent("mousescroll",a))}}}(i),i.extend(i,{getAbsoluteURL:n.jBrowser.ieMode&&n.jBrowser.ieMode<8?function(t){if(/^http(s)?:\/\//.test(t))return t;var e=document.createElement("div");return e.innerHTML='<a href="'+t+'">x</a>',e.firstChild.href}:function(t){return/^http(s)?:\/\//.test(t)?t:n.$new("a",{href:t}).href}}),n.win=n.$(window),n.doc=n.$(document),i}(),function(t){if(!t)throw"MagicJS not found";if(!t.FX){{t.$}t.FX=new t.Class({init:function(e,i){this.el=t.$(e),this.options=t.extend(this.options,i),this.timer=!1,"string"==t.jTypeOf(this.options.transition)&&(this.options.transition=t.FX.Transition[this.options.transition]||t.FX.Transition.sineIn),"string"==t.jTypeOf(this.options.cycles)&&(this.options.cycles="infinite"===this.options.cycles?1/0:parseInt(this.options.cycles)||1)},options:{fps:60,duration:500,transition:function(t){return-(Math.cos(Math.PI*t)-1)/2},cycles:1,direction:"normal",onStart:t.$F,onComplete:t.$F,onBeforeRender:t.$F,onAfterRender:t.$F,forceAnimation:!1,roundCss:!0},styles:null,start:function(e){var i,n=/\%$/;this.styles=e,this.cycle=0,this.state=0,this.curFrame=0,this.pStyles={},this.alternate="alternate"===this.options.direction||"alternate-reverse"===this.options.direction,this.continuous="continuous"===this.options.direction||"continuous-reverse"===this.options.direction;for(i in this.styles)n.test(this.styles[i][0])&&(this.pStyles[i]=!0),("reverse"===this.options.direction||"alternate-reverse"===this.options.direction||"continuous-reverse"===this.options.direction)&&this.styles[i].reverse();return this.startTime=t.now(),this.finishTime=this.startTime+this.options.duration,this.options.onStart.call(),0===this.options.duration?(this.render(1),this.options.onComplete.call()):(this.loopBind=this.loop.jBind(this),this.timer=!this.options.forceAnimation&&t.jBrowser.features.requestAnimationFrame?t.jBrowser.requestAnimationFrame.call(window,this.loopBind):this.loopBind.interval(Math.round(1e3/this.options.fps))),this},stopAnimation:function(){this.timer&&(!this.options.forceAnimation&&t.jBrowser.features.requestAnimationFrame&&t.jBrowser.cancelAnimationFrame?t.jBrowser.cancelAnimationFrame.call(window,this.timer):clearInterval(this.timer),this.timer=!1)},stop:function(e){return e=t.defined(e)?e:!1,this.stopAnimation(),e&&(this.render(1),this.options.onComplete.jDelay(10)),this},calc:function(t,e,i){return t=parseFloat(t),e=parseFloat(e),(e-t)*i+t},loop:function(){var e=t.now(),i=(e-this.startTime)/this.options.duration,n=Math.floor(i);if(e>=this.finishTime&&n>=this.options.cycles)return this.stopAnimation(),this.render(1),this.options.onComplete.jDelay(10),this;if(this.alternate&&this.cycle<n)for(var s in this.styles)this.styles[s].reverse();this.cycle=n,!this.options.forceAnimation&&t.jBrowser.features.requestAnimationFrame&&(this.timer=t.jBrowser.requestAnimationFrame.call(window,this.loopBind)),this.render((this.continuous?n:0)+this.options.transition(i%1))},render:function(t){var e={};for(var i in this.styles)"opacity"===i?e[i]=Math.round(100*this.calc(this.styles[i][0],this.styles[i][1],t))/100:(e[i]=this.calc(this.styles[i][0],this.styles[i][1],t),this.options.roundCss&&(e[i]=Math.round(e[i])),this.pStyles[i]&&(e[i]+="%"));this.options.onBeforeRender(e,this.el),this.set(e),this.options.onAfterRender(e,this.el)},set:function(t){return this.el.jSetCss(t)}}),t.FX.Transition={linear:function(t){return t},sineIn:function(t){return-(Math.cos(Math.PI*t)-1)/2},sineOut:function(e){return 1-t.FX.Transition.sineIn(1-e)},expoIn:function(t){return Math.pow(2,8*(t-1))},expoOut:function(e){return 1-t.FX.Transition.expoIn(1-e)},quadIn:function(t){return Math.pow(t,2)},quadOut:function(e){return 1-t.FX.Transition.quadIn(1-e)},cubicIn:function(t){return Math.pow(t,3)},cubicOut:function(e){return 1-t.FX.Transition.cubicIn(1-e)},backIn:function(t,e){return e=e||1.618,Math.pow(t,2)*((e+1)*t-e)},backOut:function(e){return 1-t.FX.Transition.backIn(1-e)},elasticIn:function(t,e){return e=e||[],Math.pow(2,10*--t)*Math.cos(20*t*Math.PI*(e[0]||1)/3)},elasticOut:function(e,i){return 1-t.FX.Transition.elasticIn(1-e,i)},bounceIn:function(t){for(var e=0,i=1;1;e+=i,i/=2)if(t>=(7-4*e)/11)return i*i-Math.pow((11-6*e-11*t)/4,2)},bounceOut:function(e){return 1-t.FX.Transition.bounceIn(1-e)},none:function(){return 0}}}}(e),function(t){if(!t)throw"MagicJS not found";if(!t.FX)throw"MagicJS.FX not found";if(!t.FX.Slide){{t.$}t.FX.Slide=new t.Class(t.FX,{options:{mode:"vertical"},init:function(e,i){this.el=t.$(e),this.options=t.extend(this.$parent.options,this.options),this.$parent.init(e,i),this.wrapper=this.el.jFetch("slide:wrapper"),this.wrapper=this.wrapper||t.$new("DIV").jSetCss(t.extend(this.el.jGetStyles("margin-top","margin-left","margin-right","margin-bottom","position","top","float"),{overflow:"hidden"})).enclose(this.el),this.el.jStore("slide:wrapper",this.wrapper).jSetCss({margin:0})},vertical:function(){this.margin="margin-top",this.layout="height",this.offset=this.el.offsetHeight},horizontal:function(t){this.margin="margin-"+(t||"left"),this.layout="width",this.offset=this.el.offsetWidth},right:function(){this.horizontal()},left:function(){this.horizontal("right")},start:function(t,e){this[e||this.options.mode]();var i,n=this.el.jGetCss(this.margin).jToInt(),s=this.wrapper.jGetCss(this.layout).jToInt(),o={},r={};switch(o[this.margin]=[n,0],o[this.layout]=[0,this.offset],r[this.margin]=[n,-this.offset],r[this.layout]=[s,0],t){case"in":i=o;break;case"out":i=r;break;case"toggle":i=0==s?o:r}return this.$parent.start(i),this},set:function(t){return this.el.jSetCssProp(this.margin,t[this.margin]),this.wrapper.jSetCssProp(this.layout,t[this.layout]),this},slideIn:function(t){return this.start("in",t)},slideOut:function(t){return this.start("out",t)},hide:function(t){this[t||this.options.mode]();var e={};return e[this.layout]=0,e[this.margin]=-this.offset,this.set(e)},show:function(t){this[t||this.options.mode]();var e={};return e[this.layout]=this.offset,e[this.margin]=0,this.set(e)},toggle:function(t){return this.start("toggle",t)}})}}(e),function(t){if(!t)throw"MagicJS not found";if(!t.PFX){{t.$}t.PFX=new t.Class(t.FX,{init:function(e,i){this.el_arr=e,this.options=t.extend(this.options,i),this.timer=!1},start:function(t){var e,i,n=/\%$/,s=t.length;for(this.styles_arr=t,this.pStyles_arr=new Array(s),i=0;s>i;i++){this.pStyles_arr[i]={};for(e in t[i])n.test(t[i][e][0])&&(this.pStyles_arr[i][e]=!0)}return this.$parent.start([]),this},render:function(e){for(var i=0;i<this.el_arr.length;i++)this.el=t.$(this.el_arr[i]),this.styles=this.styles_arr[i],this.pStyles=this.pStyles_arr[i],this.$parent.render(e)}})}}(e),function(t){if(!t)throw"MagicJS not found";var i=t.$,n=window.URL||window.webkitURL||null;e.ImageLoader=new t.Class({img:null,ready:!1,options:{onprogress:t.$F,onload:t.$F,onabort:t.$F,onerror:t.$F,oncomplete:t.$F,onxhrerror:t.$F,xhr:!1,progressiveLoad:!0},size:null,_timer:null,loadedBytes:0,_handlers:{onprogress:function(t){t.target&&(200===t.target.status||304===t.target.status)&&t.lengthComputable&&(this.options.onprogress.jBind(null,(t.loaded-(this.options.progressiveLoad?this.loadedBytes:0))/t.total).jDelay(1),this.loadedBytes=t.loaded)},onload:function(){this._unbind(),this.ready||(this.ready=!0,this._cleanup(),!this.options.xhr&&this.options.onprogress.jBind(null,1).jDelay(1),this.options.onload.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1))},onabort:function(){this._unbind(),this.ready=!1,this._cleanup(),this.options.onabort.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)},onerror:function(){this._unbind(),this.ready=!1,this._cleanup(),this.options.onerror.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)}},_bind:function(){i(["load","abort","error"]).jEach(function(t){this.img.jAddEvent(t,this._handlers["on"+t].jBindAsEvent(this).jDefer(1))},this)},_unbind:function(){if(this._timer){try{clearTimeout(this._timer)}catch(t){}this._timer=null}i(["load","abort","error"]).jEach(function(t){this.img.jRemoveEvent(t)},this)},_cleanup:function(){if(this.jGetSize(),this.img.jFetch("new")){var t=this.img.parentNode;this.img.jRemove().jDel("new").jSetCss({position:"static",top:"auto"}),t.kill()}},loadBlob:function(e){var s,o=new XMLHttpRequest;i(["abort","progress"]).jEach(function(t){o["on"+t]=i(function(e){this._handlers["on"+t].call(this,e)}).jBind(this)},this),o.onerror=i(function(){this.options.onxhrerror.jBind(null,this).jDelay(1),this.options.xhr=!1,this._bind(),this.img.src=e}).jBind(this),o.onload=i(function(){return 200!==o.status&&304!==o.status?void this._handlers.onerror.call(this):(s=o.response,this._bind(),void(!n||t.jBrowser.trident||"ios"===t.jBrowser.platform&&t.jBrowser.version<537?this.img.src=e:this.img.setAttribute("src",n.createObjectURL(s))))}).jBind(this),o.open("GET",e),o.responseType="blob",o.send()},init:function(e,n){if(this.options=t.extend(this.options,n),this.img=i(e)||t.$new("img",{},{"max-width":"none","max-height":"none"}).jAppendTo(t.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-1e4,width:10,height:10,overflow:"hidden"}).jAppendTo(t.body)).jStore("new",!0),t.jBrowser.features.xhr2&&this.options.xhr&&"string"==t.jTypeOf(e))return void this.loadBlob(e);var s=function(){this.isReady()?this._handlers.onload.call(this):this._handlers.onerror.call(this),s=null}.jBind(this);this._bind(),"string"==t.jTypeOf(e)?this.img.src=e:(t.jBrowser.trident&&5==t.jBrowser.version&&t.jBrowser.ieMode<9&&(this.img.onreadystatechange=function(){/loaded|complete/.test(this.img.readyState)&&(this.img.onreadystatechange=null,s&&s())}.jBind(this)),this.img.src=e.getAttribute("src")),this.img&&this.img.complete&&s&&(this._timer=s.jDelay(100))},destroy:function(){return this._unbind(),this._cleanup(),this.ready=!1,this},isReady:function(){var t=this.img;return t.naturalWidth?t.naturalWidth>0:t.readyState?"complete"==t.readyState:t.width>0},jGetSize:function(){return this.size||(this.size={width:this.img.naturalWidth||this.img.width,height:this.img.naturalHeight||this.img.height})}})}(e),function(t){if(!t)throw"MagicJS not found";if(!t.Tooltip){{t.$}t.Tooltip=function(e,i){var n=this.tooltip=t.$new("div",null,{position:"absolute","z-index":999}).jAddClass("MagicToolboxTooltip");t.$(e).jAddEvent("mouseover",function(){n.jAppendTo(document.body)}),t.$(e).jAddEvent("mouseout",function(){n.jRemove()}),t.$(e).jAddEvent("mousemove",function(e){function i(t,e,i){return(t-e)/2>i?i:i>(t+e)/2?i-e:(t-e)/2}var s=20,o=t.$(e).jGetPageXY(),r=n.jGetSize(),a=t.$(window).jGetSize(),h=t.$(window).jGetScroll();n.jSetCss({left:h.x+i(a.width,r.width+2*s,o.x-h.x)+s,top:h.y+i(a.height,r.height+2*s,o.y-h.y)+s})}),this.text(i)},t.Tooltip.prototype.text=function(t){this.tooltip.firstChild&&this.tooltip.removeChild(this.tooltip.firstChild),this.tooltip.append(document.createTextNode(t))}}}(e),function(t){if(!t)throw"MagicJS not found";if(!t.MessageBox){{t.$}t.Message=function(e,i,n,s){this.hideTimer=null,this.messageBox=t.$new("span",null,{position:"absolute","z-index":999,visibility:"hidden",opacity:.8}).jAddClass(s||"").jAppendTo(n||t.body),this.setMessage(e),this.show(i)},t.Message.prototype.show=function(e){this.messageBox.show(),this.hideTimer=this.hide.jBind(this).jDelay(t.ifndef(e,5e3))},t.Message.prototype.hide=function(i){clearTimeout(this.hideTimer),this.hideTimer=null,this.messageBox&&!this.hideFX&&(this.hideFX=new e.FX(this.messageBox,{duration:t.ifndef(i,500),onComplete:function(){this.messageBox.kill(),delete this.messageBox,this.hideFX=null}.jBind(this)}).start({opacity:[this.messageBox.jGetCss("opacity"),0]}))},t.Message.prototype.setMessage=function(t){this.messageBox.firstChild&&this.tooltip.removeChild(this.messageBox.firstChild),this.messageBox.append(document.createTextNode(t))}}}(e),e.Options=function(t){if(!t)throw"MagicJS not found";var e=t.$,i=function(t){this.defaults=t,this.options={}};return i.prototype.get=function(e){return t.defined(this.options[e])?this.options[e]:this.defaults[e]},i.prototype.set=function(e,i){e=e.jTrim(),e&&("string"===t.jTypeOf(i)&&(i=i.jTrim()),"true"===i&&(i=!0),"false"===i&&(i=!1),parseInt(i)==i&&(i=parseInt(i)),this.options[e]=i)},i.prototype.fromRel=function(t){var i=this;e(t.split(";")).jEach(function(t){t=t.split(":"),i.set(t.shift(),t.join(":"))})},i.prototype.fromJSON=function(t){for(var e in t)t.hasOwnProperty(e)&&this.set(e,t[e])},i.prototype.exists=function(e){return t.defined(this.options[e])?!0:!1},i}(e);var n={rows:1,columns:36,speed:50,"start-row":"auto","start-column":"auto","reverse-row":!1,"reverse-column":!1,"row-increment":1,"column-increment":1,"loop-row":!1,"loop-column":!0,autospin:"once","autospin-start":"load","autospin-stop":"click","autospin-speed":3600,"autospin-direction":"clockwise",spin:"drag",smoothing:!0,magnify:!0,"magnifier-width":"80%","magnifier-shape":"inner",fullscreen:!0,hint:!0,"initialize-on":"load","mousewheel-step":3,"right-click":!1,onready:i.$F,onstart:i.$F,onstop:i.$F,onzoomin:i.$F,onzoomout:i.$F,onspin:i.$F};n=i.extend(n,{filename:"auto",filepath:"auto","large-filename":"auto","large-filepath":"auto","row-digits":2,"column-digits":2,images:"","large-images":""});var s=i.$,o={mousedown:window.navigator.pointerEnabled?"pointerdown":window.navigator.msPointerEnabled?"MSPointerDown":"mousedown",mouseup:window.navigator.pointerEnabled?"pointerup":window.navigator.msPointerEnabled?"MSPointerUp":"mouseup",mousemove:window.navigator.pointerEnabled?"pointermove":window.navigator.msPointerEnabled?"MSPointerMove":"mousemove",mouseover:window.navigator.pointerEnabled?"pointerover":window.navigator.msPointerEnabled?"MSPointerOver":"mouseover",mouseout:window.navigator.pointerEnabled?"pointerout":window.navigator.msPointerEnabled?"MSPointerOut":"mouseout"},r=function(t){return t.replace(/[!'()\s]/g,escape).replace(/\*/g,"%2A")},a=function(t,e){var n=i.$new(t),o=e.split(",");s(o).jEach(function(t){n.jAddClass(t.jTrim())}),n.jSetCss({position:"absolute",top:-1e4,left:0,visibility:"hidden"}),document.body.appendChild(n),s(function(){this.jRemove()}).jBind(n).jDelay(100)},h="ios"===i.jBrowser.platform&&/CriOS\//.test(navigator.userAgent),l=function(){var t=navigator.userAgent.match(/windows nt ([0-9]{1,}[\.0-9]{0,})/i);return t?parseFloat(t[1]):-1}(),c=!0,u=!1,d=150,p=function(t){for(this.o=s(t);t.firstChild&&"IMG"!==t.firstChild.tagName;)t.removeChild(t.firstChild);if("IMG"!==t.firstChild.tagName)throw"Error loading Magic 360. Cannot find image.";i.jBrowser.ieMode&&this.o.jAddClass("magic-for-ie"+i.jBrowser.ieMode),this.oi=t.replaceChild(t.firstChild.cloneNode(!1),t.firstChild),this._o=new i.Options(n),this.op=s(this._o.get).jBind(this._o),this._o.fromJSON(i.extend(window.Magic360Options||{},Magic360.options)),this._o.fromRel(t.getAttribute("data-magic360-options")||t.rel),this.lang=new i.Options({"loading-text":"Loading...","fullscreen-loading-text":"Loading large spin...","hint-text":"Drag to spin","mobile-hint-text":"Swipe to spin"}),this.lang.fromJSON(i.extend(window.Magic360Lang||{},Magic360.lang)),this.localString=s(this.lang.get).jBind(this.lang),this.currentFrame={row:0,col:0},this.concurrentImages=6,this.images={small:s([]),fullscreen:s([])},this.imageQueue={small:s([]),fullscreen:s([]),zoom:s([])},this.imageMap={},this.loadedRows={count:0,indexes:s([])},this.pendingImages={small:0,fullscreen:0,zoom:0},this.bgImages={url:s([]),position:s([])},this.bgURL=null,this.lastBgSize={width:0,height:0},this.useMultiBackground=c&&i.jBrowser.features.multibackground,this.useXHR=u&&i.jBrowser.features.xhr2,this.canMagnify=!0,this.imageLoadStarted={small:0,fullscreen:0,zoom:0},this.isFullScreen=!1,this.fullScreenSize={width:0,height:0},this.fullScreenBox=null,this.fullscreenIcon=null,this.fullScreenImage=null,this.fullScreenFX=null,this.fullScreenExitFX=null,this.firstFullScreenRun=!0,this.resizeCallback=null,this.boundaries={top:0,left:0,bottom:0,right:0},this.normalSize={width:0,height:0},this.size={width:0,height:0},this.spinStarted=!1,this.isVerticalSpin=!1,this.borders=0,this.boxSize={width:0,height:0},this.boxBoundaries={width:0,height:0},this.imgCacheBox=i.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-1e3,width:10,height:10,overflow:"hidden"}).jAppendTo(i.body),this.addedCSS=[],this.ppf={x:60,y:60};this.sis=s(s(this.op("images").jTrim().split(" ")).filter(function(t){return""!==t})),this.bis=s(s(this.op("large-images").jTrim().split(" ")).filter(function(t){return""!==t})),isNaN(parseInt(this.op("row-increment")))&&this._o.set("row-increment",this._o.defaults["row-increment"]),isNaN(parseInt(this.op("column-increment")))&&this._o.set("column-increment",this._o.defaults["column-increment"]),this._o.set("columns",Math.floor(this.op("columns")/this.op("column-increment"))),this._o.set("rows",Math.floor(this.op("rows")/this.op("row-increment"))),isNaN(parseInt(this.op("speed")))&&this._o.set("speed",this._o.defaults.speed),this._o.set("autospin-start",this.op("autospin-start").split(",")),i.jBrowser.touchScreen&&"hover"===this.op("autospin-stop")&&this._o.set("autospin-stop","click"),this._o.exists("autospin-speed")&&isFinite(this.op("autospin-speed"))||this._o.set("autospin-speed",Math.min(d*parseInt(this.op("columns"),10),this._o.defaults["autospin-speed"])),isNaN(parseInt(this.op("mousewheel-step"),10))&&this._o.set("mousewheel-step",3),"infinite"===this.op("autospin")&&"hover"===this.op("autospin-stop")&&this._o.set("hint",!1),!this._o.exists("hint")&&"infinite"===this.op("autospin")&&"click"===this.op("autospin-stop")&&s(this.op("autospin-start")).contains("click")&&this._o.set("hint",!1),"string"==i.jTypeOf(this.op("onready"))&&"function"==i.jTypeOf(window[this.op("onready")])&&this._o.set("onready",window[this.op("onready")]),"string"==i.jTypeOf(this.op("onspin"))&&"function"===i.jTypeOf(window[this.op("onspin")])&&this._o.set("onspin",window[this.op("onspin")]),"string"==i.jTypeOf(this.op("onzoomin"))&&"function"===i.jTypeOf(window[this.op("onzoomin")])&&this._o.set("onzoomin",window[this.op("onzoomin")]),"string"==i.jTypeOf(this.op("onzoomout"))&&"function"===i.jTypeOf(window[this.op("onzoomout")])&&this._o.set("onzoomout",window[this.op("onzoomout")]),"function"!==i.jTypeOf(this.op("onspin"))&&this.op.set("onspin",i.F),"function"!==i.jTypeOf(this.op("onzoomin"))&&this.op.set("onzoomin",i.F),"function"!==i.jTypeOf(this.op("onzoomout"))&&this.op.set("onzoomout",i.F),this.o.jAddEvent("click",function(t){t.stop()}).jAddEvent("dragstart",function(t){t.stop()}).jAddEvent("selectstart",function(t){t.stop()}).jSetCss({"-webkit-user-select":"none","-webkit-touch-callout":"none","-webkit-tap-highlight-color":"transparent","ms-user-select":"none","ms-touch-action":"none"}),!0!==this.op("right-click")&&this.o.jAddEvent("contextmenu",function(t){return t.stop(),!1}),this.op("hint")&&a("span","Magic360-hint-side"),a("div","Magic360-progress-bar-state"),a("div","Magic360-wait"),this.op("fullscreen")&&a("div","Magic360-button,fullscreen"),function e(){var n;return t.firstChild.getAttribute("src")?(this.sis.length||(n=this.prepareFilename(t.firstChild.getAttribute("src"),this.op("filepath"),this.op("filename"),!0),this._o.set("filepath",n.path),this._o.set("filename",n.tpl),n=this.prepareFilename(t.getAttribute("href")||"",this.op("large-filepath"),this.op("large-filename")),this._o.set("large-filepath",n.path),this._o.set("large-filename",n.tpl),"auto"==this.op("large-filename")&&(this._o.set("fullscreen",!1),this._o.set("magnify",!1))),!parseInt(this.op("start-row"),10)&&this._o.set("start-row",1),!parseInt(this.op("start-column"),10)&&this._o.set("start-column",1),parseInt(this.op("start-row"),10)>parseInt(this.op("rows"),10)&&this._o.set("start-row",this.op("rows")),parseInt(this.op("start-column"),10)>parseInt(this.op("columns"),10)&&this._o.set("start-column",this.op("columns")),!0===this.op("reverse-row")&&this._o.set("start-row",this.op("rows")+1-this.op("start-row")),!0===this.op("reverse-column")&&this._o.set("start-column",this.op("columns")+1-this.op("start-column")),void new i.ImageLoader(t.firstChild,{onload:s(function(t){var e,n=!1,o=s(function(){n||(n=!0,s(this.preInit).call(this))}).jBind(this),r=s(function(){switch(this.normalSize=e.jGetSize(),e.parentNode.jRemove(),this.normalSize.width<50&&(this.normalSize=t.jGetSize()),s(this.o).jGetSize().width<50&&this.o.jSetCssProp("max-width","none"),this.op("initialize-on")){case"hover":this.o.jAddEvent("mouseover",o);
break;case"click":this.o.jAddEvent("click",o);break;default:o()}}).jBind(this);e=s(t.img.cloneNode(!1)).jAppendTo(i.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-1e4,width:10,height:10,overflow:"hidden"}).jAppendTo(i.body)),r.jDelay(1)}).jBind(this)})):void e.jBind(this).jDelay(100)}.call(this)};p.prototype.prepareFilename=function(t,e,i,n){var o,r,a={path:e,tpl:i.replace(/(\/|\\)/gi,"")},h=0,l=0,c=0,u="1",d="1";return t?(t=t.split("/"),i=t.pop().split("."),e=(t.join("/")+"/").replace(/^\/$/,""),o=i.length>1?"."+i.pop():"",i=i.join("."),n||(n=!1),a.path="auto"==a.path?e:a.path.replace(/\/$/,"")+"/","auto"==a.tpl?a.tpl=i.replace(/(\d?\d{1,})\-?(\d?\d{1,})?$/,function(t,e,i){var n;return void 0!==i&&null!==i&&""!==i?(u=e,d=i,n="{row}-{col}"):(d=e,n="{col}"),n})+o:(r=new RegExp(a.tpl.replace(/(\$|\?)/g,"\\$1").replace(/({row}|{col})/g,s(function(t,e){return"{row}"===e&&(l=++h),"{col}"===e&&(c=++h),"(0{0,}[1-9]{1,"+("{row}"===e&&this._o.exists("row-digits")?this.op("row-digits"):"{col}"===e&&this._o.exists("column-digits")?this.op("column-digits"):"")+"})"}).jBind(this))).exec(i+o))?(l&&(u=r[l]),c&&(d=r[c])):(r=new RegExp(a.tpl.replace(/(\$|\?)/g,"\\$1").replace(/({row}|{col})/g,s(function(t,e){return"(\\d{1,"+("{row}"===e&&this._o.exists("row-digits")?this.op("row-digits"):"{col}"===e&&this._o.exists("column-digits")?this.op("column-digits"):"")+"})"}).jBind(this))).exec(i+o))&&(l&&(u=r[l]),c&&(d=r[c])),n&&(this._o.exists("row-digits")||this._o.set("row-digits",u.length),this._o.exists("column-digits")||this._o.set("column-digits",d.length)),"auto"==this.op("start-row")&&this._o.set("start-row",u.jToInt()),"auto"==this.op("start-column")&&this._o.set("start-column",d.jToInt()),a):a},p.prototype.prepareUrl=function(t,e,i){function n(t,e){return Array(e-(""+t).length+1).join("0")+t}return i=i===!0?"large-":"",this.sis.length?i&&!this.bis.length?"":this[i?"bis":"sis"][(t-1)*this.op("columns")+e-1]:(t=n(1+(t-1)*this.op("row-increment"),this.op("row-digits")),e=n(1+(e-1)*this.op("column-increment"),this.op("column-digits")),r(this.op(i+"filepath")+this.op(i+"filename").split("{row}").join(t).split("{col}").join(e)))},p.prototype.getImageURL=function(t,e,i){var n=null,s="";return i||(i="small"),n=this.getImageInfo(t,e,i),n&&(s=n.url),s},p.prototype.getImageInfo=function(t,e,i){var n={};return i||(i="small"),!0===this.op("reverse-row")&&(t=this.op("rows")+1-t),!0===this.op("reverse-column")&&(e=this.op("columns")+1-e),n[i]={url:this.prepareUrl(t,e,"fullscreen"===i||"zoom"===i),left:0,top:0},n[i]||null},p.prototype.onImageLoadProgress=function(t,e,i){s(this.imageMap[e]).filter(function(e){return"small"!==t||this.isVerticalSpin||e.row===this.op("start-row")-1},this).length&&this.progressBar.increment(i*this.progressBar.step)},p.prototype.onImageLoaded=function(t,e,n){var o=s([]),r=1,a=function(t,e){return t-e};return this.pendingImages[t]--,n.ready&&(this.useMultiBackground&&(r=this.bgImages.url.push("url('"+n.img.getAttribute("src")+"')"),this.bgImages.position.push("0px -10000px"),h&&"fullscreen"===t||(this.bgURL=this.bgImages.url.join(","))),this.useMultiBackground||this.imageMap[e].URLCached||(this.imgCacheBox.append(n.img),this.imageMap[e].URLCached=!0),s(s(this.imageMap[e]).filter(function(e){return e.type===t})).jEach(function(t,e,i){t.img.framesOnImage=i.length,t.img.bgIndex=r-1,t.img.bgURL="url('"+n.img.getAttribute("src")+"')",t.img.loaded=!0,o.contains(t.row)||o.push(t.row)}),"small"==t&&s(o).jEach(function(e){s(this.images[t][e]).filter(function(t){return t.loaded!==!0}).length||(this.loadedRows.count++,this.loadedRows.indexes.push(e),this.loadedRows.indexes.sort(a),this.C&&this.checkJumpRowCol(this.currentFrame.row,this.currentFrame.col),(h||this.isVerticalSpin?this.imageQueue[t].length||0!==this.pendingImages[t]:e!==this.op("start-row")-1)||setTimeout(function(){this.progressBar.hide(),this.init()}.jBind(this),1))},this),!h&&this.isFullScreen&&"fullscreen"==t&&this.jump_(this.currentFrame.row,this.currentFrame.col)),this.imageQueue[t].length?void(this.pendingImages[t]<this.concurrentImages&&this.imageQueue[t].length&&(this.pendingImages[t]++,e=this.imageQueue[t].shift(),new i.ImageLoader(e,{xhr:this.useXHR,oncomplete:this.onImageLoaded.jBind(this,t,e),onprogress:this.onImageLoadProgress.jBind(this,t,e)}))):void(h&&this.isFullScreen&&"fullscreen"==t&&0===this.pendingImages[t]&&(this.bgURL=this.bgImages.url.join(","),this.jump_(this.currentFrame.row,this.currentFrame.col)))},p.prototype.preloadImages=function(t,e,n){t||(t="small");var o,r,a,h,l=this.op("columns"),c=this.op("rows"),u=0;r=e,o=n,this.images[t]=new Array(c);do{this.images[t][r-1]=new Array(l);do a=this.getImageInfo(r,o,t),this.imageQueue[t].contains(a.url)||("small"==t&&(r==e||this.isVerticalSpin)&&u++,this.imageQueue[t].push(a.url)),a.left*=-1,a.top*=-1,a.bgIndex=0,a.framesOnImage=1,a.loaded=!1,this.images[t][r-1][o-1]=a,this.imageMap[a.url]||(this.imageMap[a.url]=s([])),this.imageMap[a.url].push({row:r-1,type:t,img:this.images[t][r-1][o-1]}),--o<1&&(o=l);while(o!=n);--r<1&&(r=c)}while(r!=e);for(this.imageQueue[t].length===c*l&&(this.useXHR=!1),this.progressBar.step=100/("small"==t?u:this.imageQueue[t].length),this.progressBar.show("small"===t?"center":"auto",this.useXHR||100!==this.progressBar.step?!0:!1),this.imageLoadStarted[t]=i.now();this.pendingImages[t]<this.concurrentImages&&this.imageQueue[t].length;)h=this.imageQueue[t].shift(),new i.ImageLoader(h,{xhr:this.useXHR,oncomplete:this.onImageLoaded.jBind(this,t,h),onprogress:this.onImageLoadProgress.jBind(this,t,h),onxhrerror:s(function(){100===this.progressBar.step&&this.progressBar.setIncrementalStyle(!1)}).jBind(this)}),this.pendingImages[t]++},p.prototype.preInit=function(t){var e="m360-box-"+Math.floor(Math.random()*i.now()),n=null;return t||!this.op("fullscreen")&&!this.op("magnify")?(this.isVerticalSpin=1===this.op("columns")&&this.op("rows")>1,this.size=s(this.o.firstChild).jGetSize(),0===this.size.height?void this.preInit.jBind(this).jDelay(500):(n=i.addCSS("#"+e+":after",{"padding-bottom":this.normalSize.height/this.normalSize.width*100+"% !important"},"magic360-css"),n>-1&&this.addedCSS.push(n),this.wrapper=i.$new("div",{id:e}).jAddClass("Magic360-box").jAddClass(i.jBrowser.ieMode?"magic-for-ie"+i.jBrowser.ieMode:"").jSetCss({display:"inline-block",overflow:"hidden",position:"relative","text-align":"center",width:"100%","max-width":this.normalSize.width}).enclose(this.o.jSetCss({display:"inline-block",visibility:"visible",overflow:"hidden",position:"relative","vertical-align":"middle","text-decoration":"none",color:"#000","background-repeat":"no-repeat"})),this.o.firstChild.jSetCss({width:"100%"}),i.jBrowser.trident&&i.jBrowser.ieMode<9&&this.o.jSetCss({"background-image":"none",filter:'progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod="scale", src="'+r(this.o.firstChild.getAttribute("src"))+'")'}),this.size=s(this.o).jGetSize(),this.boundaries=this.o.jGetRect(),this.borders=5===i.jBrowser.ieMode||"border-box"===(this.o.jGetCss("box-sizing")||this.o.jGetCss("box-sizing"))?parseFloat(this.o.jGetCss("border-right-width"))+parseFloat(this.o.jGetCss("border-left-width")):0,5===i.jBrowser.ieMode&&this.wrapper.jSetCss({width:this.normalSize.width+this.borders,display:"inline"}),this.boxSize=this.wrapper.jGetSize(),this.boxBoundaries=this.wrapper.jGetRect(),this.resizeCallback=function(){var t,e,n;this.boundaries=this.o.jGetRect(),this.boxSize=this.wrapper.jGetSize(),this.boxBoundaries=this.wrapper.jGetRect(),this.isFullScreen&&(e=s(document).jGetSize(),n=this.fullScreenSize.width/this.fullScreenSize.height,i.jBrowser.trident&&i.jBrowser.backCompat&&this.fullScreenBox.jSetCss({width:e.width,height:e.height}),this.o.jSetCss(this.adjustFSSize(e))),t=s(this.o).jGetSize(),t.width<=0||t.height<=0||(this.size=t,this.op("magnify")&&(this.size.width*this.size.height/(this.zoomSize.width*this.zoomSize.height)>.8?(this._hideM&&this._hideM(),this.canMagnify=!1,this.o.jRemoveClass("zoom-in")):(this.canMagnify=!0,this.o.jAddClass("zoom-in"))),this.ppf={x:this.size.width/this.op("columns")/Math.pow(this.op("speed")/50,2),y:this.size.height/this.op("rows")/Math.pow(this.op("speed")/50,2)},this.C&&this.jump_(this.C.row,this.C.col))}.jBind(this),s(window).jAddEvent("resize",this.resizeCallback),i.jBrowser.touchScreen&&i.jBrowser.mobile||(this.wrapper.jAddClass("desktop"),this.o.jAddClass("desktop")),this.progressBar={box:i.$new("DIV",null,{position:"absolute",cursor:"default"}).append(i.$new("DIV").jAddClass("Magic360-progress-text").append(i.doc.createTextNode(this.localString("loading-text")))).append(i.$new("DIV").jAddClass("Magic360-progress-bar").append(i.$new("DIV").jAddClass("Magic360-progress-bar-state"))).jAddClass("Magic360-loading-box"),incremental:!1,barBox:null,stateBox:null,textBox:null,parent:this.o,size:{width:0,height:0},step:0,value:0,showTimer:null,fx:null,show:function(t,e){this.value=0,this.incremental=e,this.textBox=s(this.box.byClass("Magic360-progress-text")[0]),this.barBox=s(this.box.byClass("Magic360-progress-bar")[0]),this.stateBox=s(this.box.byClass("Magic360-progress-bar-state")[0]),s(this.stateBox)[!1===e?"jAddClass":"jRemoveClass"]("bar-state-unknown"),this.box.jSetOpacity(0).jAppendTo(this.parent),this.size=this.box.jGetSize(),!0===e&&this.stateBox.jSetCssProp("width",0),i.jBrowser.features.animation||e||(this.fx=new i.FX(this.stateBox,{duration:3e3,transition:"linear",cycles:1/0,direction:"alternate"}).start({"margin-left":["-10%","90%"]})),this.showTimer=setTimeout(function(){this.box.jSetCssProp("opacity",1)}.jBind(this),400)},hide:function(){this.fx&&this.fx.stop(),this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null),new i.FX(this.box,{onComplete:function(){this.box.jRemove()}.jBind(this)}).start({opacity:[this.box.jGetCss("opacity"),0]})},setIncrementalStyle:function(t){this.incremental=t||!1,s(this.stateBox)[!1===t?"jAddClass":"jRemoveClass"]("bar-state-unknown"),this.stateBox.jSetCssProp("width",!0===t?0:""),i.jBrowser.features.animation||t||(this.fx=new i.FX(this.stateBox,{duration:3e3,transition:"linear",cycles:1/0,direction:"alternate"}).start({"margin-left":["-10%","90%"]}))},increment:function(t){this.value+=t,this.setValue(this.value+"%")},incrementByVal:function(t){this.value=t,this.setValue(this.value+"%")},setValue:function(t){Math.round(this.value)>=100&&setTimeout(function(){this.hide()}.jBind(this),1),this.incremental&&this.stateBox.jSetCssProp("width",t)}},void this.preloadImages("small",this.op("start-row"),this.op("start-column")))):void new i.ImageLoader(this.prepareUrl(1,1,!0),{onload:s(function(t){this.zoomSize=this.fullScreenSize=t.jGetSize()}).jBind(this),onerror:s(function(){this._o.set("fullscreen",!1),this._o.set("magnify",!1)}).jBind(this),oncomplete:s(function(){this.preInit(!0)}).jBind(this)})},p.prototype.init=function(t){function e(t,e){var n,o,r,a=!1;if(!u&&h.canMagnify){if("event"==i.jTypeOf(t)){if(a=t.pointerType&&("touch"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_TOUCH)||/touch/i.test(t.type),(r=s(t.getTarget())).jHasClass("icon")){if(c&&r.jHasClass("magnify"))return;if(!c&&r.jHasClass("spin"))return}t.stop()}if(!(c&&e||!c&&0==e))return c&&!e?(h.magnifier.stop(),r&&r.jHasClass("spin")&&h._A.infinite&&h._A.play()):(n=h.checkJumpRowCol(h.C.row,h.C.col),o="event"==i.jTypeOf(t)?t.jGetPageXY():t,g&&g.toggle(!0),d=!0,l=!1,h._A.pause(),new i.ImageLoader(h.getImageURL(n.row+1,n.col+1,"zoom"),{onload:s(function(t,e){h.resizeCallback(),h.magnifier.start(e,o,t)}).jBind(null,a),onerror:function(){d=!1},oncomplete:function(){g&&g.toggle(!1)}})),!1}}function n(t,e,i){if(c){var n=i||!1;t&&(n=t.pointerType&&("touch"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_TOUCH)||/touch/i.test(t.type)),e=e||t.jGetPageXY(),e.x>h.boundaries.right||e.x<h.boundaries.left||e.y>h.boundaries.bottom||e.y<h.boundaries.top||(t&&n&&t.stop(),h.magnifier.touchEvent=n,n&&"inner"==h.op("magnifier-shape")&&(e.x-=h.magnifier.delta.x,e.y-=h.magnifier.delta.y,t||(e.x=h.boundaries.right-e.x+h.boundaries.left,e.y=h.boundaries.bottom-e.y+h.boundaries.top)),h.magnifier.x=e.x-h.boundaries.left,h.magnifier.y=e.y-h.boundaries.top,null==h.magnifier.moveTimer&&(h.magnifier.moveTimer=setTimeout(h.magnifier.moveBind,10)))}}if(!t)return this.C={row:1,col:1,tmp:{row:1,col:1}},this.jump(this.op("start-row")-1,this.op("start-column")-1),void this.init.jBind(this,!0).jDelay(300);this.o.firstChild.jSetOpacity(0);var r={x:0,y:0},a={x:0,y:0},h=this;this.ppf={x:this.size.width/this.op("columns")/Math.pow(this.op("speed")/50,2),y:this.size.height/this.op("rows")/Math.pow(this.op("speed")/50,2)};var l=!1,c=!1,u=!1,d=!1,p={date:!1},f=null;if(this._A={invoked:!1,infinite:"infinite"==this.op("autospin"),cancelable:"never"!=this.op("autospin-stop"),timer:null,runs:0,maxFrames:function(t,e){switch(t){case"once":return e;case"twice":return 2*e;case"infinite":return Number.MAX_VALUE;default:return 0}}(this.op("autospin"),this.op("columns")),frames:0,playedFrames:0,alternate:/^alternate\-(anti)?clockwise$/.test(this.op("autospin-direction")),fn:function(t,e){this._A.alternate&&(e*=(++this._A.playedFrames%this.op("columns")?-1:0)*(Math.floor(this._A.playedFrames/this.op("columns"))%2||-1)),this.jump(this.currentFrame.row,this.currentFrame.col+e),--this._A.frames>0&&(this._A.timer=this._A.fn.jDelay(t))||this._A.onpause()}.jBind(this,this.op("autospin-speed")/this.op("columns"),/^(alternate\-)?anticlockwise$/.test(this.op("autospin-direction"))?-1:1),play:function(t){this.frames=t||this.maxFrames,this.playedFrames=h.currentFrame.col,clearTimeout(this.timer),this.frames>0&&(this.timer=this.fn.jDelay(1),this.runs++,h.hintBox&&h.hideHintBox())},pause:function(){this.timer&&clearTimeout(this.timer),this.frames>0&&(this.frames=0,this.onpause())},onpause:function(){this._A.runs<2&&this.op("rows")*this.op("columns")>1&&this.op("hint")&&this.setupHint()}.jBind(this)},this.o.jSetCss({outline:"none"}),this.mMoveEvent=function(t){if(/touch/i.test(t.type)&&t.touches.length>1)return!0;if(c||d){if(d)return!0;e(t),l=!0}var n=t.jGetPageXY(),s=n.x-r.x,o=n.y-r.y,a=s>0?Math.floor(s/h.ppf.x):Math.ceil(s/h.ppf.x),m=o>0?Math.floor(o/h.ppf.y):Math.ceil(o/h.ppf.y);return("hover"==h.op("spin")||"drag"==h.op("spin")&&l)&&(u=!0,clearTimeout(f),(h.op("columns")>1&&Math.abs(s)>10||h.op("rows")>1)&&t.stopDefaults(),h.op("columns")>1&&Math.abs(s)>=h.ppf.x&&(r.x=r.x+a*h.ppf.x,h.jump(h.C.row,h.C.col+(0-a))),h.op("rows")>1&&Math.abs(o)>=h.ppf.y&&(r.y=r.y+m*h.ppf.y,h.jump(h.C.row+m,h.C.col)),f=setTimeout(function(t){this.spos=t,this.date=i.now()}.jBind(p,n),50)),!1},this._A.cancelable&&(s("drag"==this.op("spin")?document:this.o).jAddEvent(o.mousemove,this.mMoveEvent),i.jBrowser.touchScreen&&s("drag"==this.op("spin")?document:this.o).jAddEvent("touchmove",this.mMoveEvent)),this.mHoverEvent=function(t){return!t.pointerType||"touch"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_TOUCH?c||d?(c&&h.magnifier.div.show()&&n(t),!1):(h._A.frames>0&&"hover"==h.op("autospin-stop")?h._A.pause():!h._A.invoked&&s(h.op("autospin-start")).contains("hover")&&(h._A.invoked=!h._A.infinite)&&h._A.play(),r=t.jGetPageXY(),"hover"==h.op("spin")&&(h.spinStarted=!0),!1):!0},this._A.cancelable&&this.o.jAddEvent(o.mouseover,this.mHoverEvent),this.mOutEvent=function(t){return!t.pointerType||"touch"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_TOUCH?h.o.hasChild(t.getRelated())?!0:(h._A.infinite&&"hover"==h.op("autospin-stop")?(c&&e(t),h._A.play()):c&&t.stop()&&e(t),!1):!0},this._A.cancelable&&this.o.jAddEvent(o.mouseout,this.mOutEvent),this.mDownEvent=function(t){var e=t.pointerType&&("touch"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_TOUCH)||/touch/i.test(t.type);return 3==t.getButton()?!0:(h.hintBox&&h.hideHintBox(),/touch/i.test(t.type)&&t.touches.length>1?!0:(a=t.jGetPageXY(),a.autospinStopped=!1,c&&(h.magnifier.delta.x=e?a.x-h.magnifier.pos.x-h.boundaries.left:0,h.magnifier.delta.y=e?a.y-h.magnifier.pos.y-h.boundaries.top:0,h.magnifier.ddx=h.magnifier.pos.x,h.magnifier.ddy=h.magnifier.pos.y),p.spos=t.jGetPageXY(),p.date=i.now(),"drag"==h.op("spin")&&(r=t.jGetPageXY()),c||d?(!e&&(d=!1),!0):(h._A.frames>0&&"click"==h.op("autospin-stop")&&(a.autospinStopped=!0,h._A.pause(),t.stopDefaults()),l=!0,u=!1,"drag"==h.op("spin")&&(h.spinStarted=!0)&&(r=t.jGetPageXY()),!1)))},this._A.cancelable&&(i.jBrowser.mobile&&i.jBrowser.touchScreen||this.o.jAddEvent(o.mousedown,this.mDownEvent),i.jBrowser.touchScreen&&this.mDownEvent&&this.o.jAddEvent("touchstart",this.mDownEvent)),this.mDocUpEvent=function(t){t.pointerType&&("touch"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_TOUCH)||/touch/i.test(t.type);return 3==t.getButton()?!0:void(c||d||!l||(h._checkDragFrames(p,t.jGetPageXY(),r),l=!1))},this._A.cancelable&&(s(document).jAddEvent(o.mouseup,this.mDocUpEvent),i.jBrowser.touchScreen&&s(document).jAddEvent("touchend",this.mDocUpEvent),s(document).jAddEvent(o.mouseout,function(t){(null===t.getRelated()||document.documentElement===t.getRelated())&&(l=!1)})),this.mUpEvent=function(t){var i=(t.pointerType&&("touch"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_TOUCH)||/touch/i.test(t.type),t.jGetPageXY());if(0==Math.abs(i.x-a.x)&&0==Math.abs(i.y-a.y)){if(!c&&!d){if(a.autospinStopped)return;if(!h._A.invoked&&h._A.frames<1&&s(h.op("autospin-start")).contains("click"))return h._A.invoked=!h._A.infinite,h._A.play(),!1}return h.op("magnify")&&(u=!1,e(t)),!1}return c||d?!1:(h._checkDragFrames(p,t.jGetPageXY(),r),l=!1,!1)},this._A.cancelable&&(i.jBrowser.mobile&&i.jBrowser.touchScreen||this.o.jAddEvent(o.mouseup,this.mUpEvent),i.jBrowser.touchScreen&&this.o.jAddEvent("touchend",this.mUpEvent)),this._A.cancelable&&this.op("mousewheel-step")>0&&this.o.jAddEvent("mousescroll",function(t){if(!(c||d||h._A.frames>0)){s(t).stop();var e=t.isMouse?t.delta/Math.abs(t.delta)*h.op("mousewheel-step"):t.delta*(8/54);1===h.op("columns")&&h.op("rows")>1?h.jump(h.C.row+(t.isMouse?-1:1)*e,h.C.col,t.isMouse,300):h.jump(h.C.row,h.C.col+e,t.isMouse,300)}}),this._A.cancelable&&("infinite"!=this.op("autospin")||!s(this.op("autospin-start")).contains("click"))&&this.op("magnify")){if(c=!1,"inner"!=this.op("magnifier-shape")){var m=""+this.op("magnifier-width");m=m.match(/\%$/i)?Math.round(this.size.width*parseInt(m)/100):parseInt(m)}this.o.jAddClass("zoom-in"),this.magnifier={div:i.$new("div",null,{position:"absolute","z-index":9999,left:0,top:0,width:(m||this.size.width)+"px",height:(m||this.size.height)+"px","background-repeat":"no-repeat","border-radius":"circle"!=h.op("magnifier-shape")?0:m/2}),ratio:{x:0,y:0},pos:{x:0,y:0},delta:{x:0,y:0},size:{width:m||this.size.width,height:m||this.size.width},ddx:0,ddy:0,fadeFX:null,moveTimer:null,start:function(t,e,i){h.canMagnify&&(this.ratio.x=t.jGetSize().width/h.size.width,this.ratio.y=t.jGetSize().height/h.size.height,c=!0,l=!1,"inner"==h.op("magnifier-shape")&&(this.size=t.jGetSize(),this.div.jSetCss({width:this.size.width,height:this.size.height})),this.div.jSetCssProp("background-image","url('"+t.img.src+"')"),this.div.jSetOpacity(0),h.o.jRemoveClass("zoom-in"),h.o.append(this.div),i&&(e.x=h.boundaries.right-e.x+h.boundaries.left,e.y=h.boundaries.bottom-e.y+h.boundaries.top),this.x=e.x-h.boundaries.left,this.y=e.y-h.boundaries.top,this.touchEvent=i,this.move(1),this.fadeFX.stop(),this.fadeFX.options.duration=400,this.fadeFX.options.onComplete=function(){h.op("onzoomin").call(null,h.o)},this.fadeFX.start({opacity:[0,1]}))},stop:function(){c=!1,d=!1,this.fadeFX.stop(),this.fadeFX.options.onComplete=function(){h.magnifier.div.jRemove(),h.magnifier.pos={x:0,y:0},h.magnifier.delta={x:0,y:0},h.magnifier.ddx=0,h.magnifier.ddy=0,h.o.jAddClass("zoom-in"),h.op("onzoomout").call(null,h.o)},this.fadeFX.options.duration=200,this.fadeFX.start({opacity:[this.fadeFX.el.jGetCss("opacity"),0]})},move:function(t){var e,i,n,s,o,r,a,l;if(isFinite(t)||(t=.4),"inner"!=h.op("magnifier-shape"))e=this.x,i=this.y,this.moveTimer=null;else{if(n=Math.ceil((this.x-this.ddx)*t),s=Math.ceil((this.y-this.ddy)*t),!n&&!s)return void(this.moveTimer=null);this.ddx+=n,this.ddy+=s,e=this.pos.x+n,i=this.pos.y+s,e>h.size.width&&(e=h.size.width),i>h.size.height&&(i=h.size.height),0>e&&(e=0),0>i&&(i=0),this.pos={x:e,y:i},this.touchEvent&&"inner"==h.op("magnifier-shape")&&(e=h.size.width-e,i=h.size.height-i)}o=e-this.size.width/2,r=i-this.size.height/2,a=Math.round(0-e*this.ratio.x+this.size.width/2),l=Math.round(0-i*this.ratio.y+this.size.height/2),"inner"==h.op("magnifier-shape")&&(o=o<h.size.width-this.size.width?h.size.width-this.size.width:o>0?0:o,r=r<h.size.height-this.size.height?h.size.height-this.size.height:r>0?0:r,0>a&&a<h.size.width-this.size.width&&(a=h.size.width-this.size.width),a>0&&a>this.size.width-h.size.width&&(a=this.size.width-h.size.width),0>l&&l<h.size.height-this.size.height&&(l=h.size.height-this.size.height),l>0&&l>this.size.height-h.size.height&&(l=this.size.height-h.size.height)),c&&this.div.jSetCss({left:o,top:r,"background-position":a+"px "+l+"px"}),this.moveTimer&&(this.moveTimer=setTimeout(this.moveBind,40))}},this.magnifier.fadeFX=new i.FX(this.magnifier.div),this.magnifier.moveBind=this.magnifier.move.jBind(this.magnifier),this.magnifier.div.jAddClass("magnifier").jAddClass(this.op("magnifier-shape")),"inner"!=this.op("magnifier-shape")&&h.magnifier.div.jAddEvent("mousescroll",function(t){var e,i=t.isMouse?5:8/54;s(t).stop(),i=(100+i*Math.abs(t.delta))/100,t.delta<0&&(i=1/i),e=Math.max(100,Math.round(h.magnifier.size.width*i)),e=Math.min(e,h.size.width),this.jSetCss({width:e,height:e,"border-radius":"circle"!=h.op("magnifier-shape")?0:e/2}),h.magnifier.size=this.jGetSize(),h.magnifier.move(1)});var g=this.loader=i.$new("div").jAddClass("Magic360-wait");g.toggle=function(t){t?g.timer=setTimeout(function(){h.o.append(g)},400):(g.timer&&(clearTimeout(g.timer),g.timer=!1),h.o===this.parentNode&&h.o.removeChild(g))},this._showM=e.jBind(this,{x:h.boundaries.left+(h.boundaries.right-h.boundaries.left)/2,y:h.boundaries.top+(h.boundaries.bottom-h.boundaries.top)/2},!0),this._hideM=e.jBind(this,null,!1),this.o.jAddEvent(o.mousemove,n),i.jBrowser.touchScreen&&this.o.jAddEvent("touchmove",n)}this._A.cancelable&&this.op("fullscreen")&&(this.fullscreenIcon=i.$new("div",null,{position:"absolute"}).jAddClass("Magic360-button").jAddClass("fullscreen").jAddEvent(o.mousedown,function(t){t.stopDistribution()}).jAddEvent("click",function(t){return 3==t.getButton()?!0:(t.stop(),this.enterFullscreen(),!1)}.jBindAsEvent(this)).jAppendTo(this.wrapper),i.jBrowser.touchScreen&&this.fullscreenIcon.jAddEvent("touchstart",function(t){t.stopDistribution()})),this.resizeCallback(),this._A.maxFrames>0&&s(this.op("autospin-start")).contains("load")?this._A.play():(this.jump(this.currentFrame.row,this.currentFrame.col),this.op("rows")*this.op("columns")>1&&this.op("hint")&&this._A.cancelable&&this.setupHint());"function"==i.jTypeOf(this.op("onready"))&&this.op("onready").call(null,this.o)},p.prototype._checkDragFrames=function(t,e,n){function s(e){var i,s="x"==e?dx:dy,a=s/o,h=a/2*(a/r);return"x"==e?(i=Math.abs(s+(s>0?h:0-h))-Math.abs(t.spos.x-n.x),i=s>0?0-i:i):i=h-(t.spos.y-n.y),i/=ppf[e],i>0?Math.floor(i):Math.ceil(i)}if(this.op("smoothing")&&t.date){var o=i.now()-t.date;if(t.date=!1,!(0>=o)){50>o&&(o=50);var r=.01;ppf=this.ppf,dx=e.x-t.spos.x,dy=e.y-t.spos.y,this.jump(this.C.row+s("y"),this.C.col+s("x"),!0,2*Math.abs(Math.floor(dx/o/r)))}}},p.prototype.jump=function(t,e,n,s){return this.C.row=t,this.C.col=e,this.fx&&this.fx.stop(),n?void(this.fx=new i.FX(this.o,{duration:s,transition:i.FX.Transition.quadOut,onBeforeRender:function(t){this.C.tmp.col=t.col,this.C.tmp.row=t.row,this.jump_(t.row,t.col)}.jBind(this)}).start({col:[this.C.tmp.col,e],row:[this.C.tmp.row,t]})):(this.C.tmp.row=t,this.C.tmp.col=e,void this.jump_(t,e))},p.prototype.checkJumpRowCol=function(t,e){return t=Math.round(t),e=Math.round(e),this.op("loop-row")||(t>this.loadedRows.count-1&&(t=this.loadedRows.count-1),0>t&&(t=0)),this.op("loop-column")||this._A&&!(this._A.frames<1)||(e>this.op("columns")-1&&(e=this.op("columns")-1),0>e&&(e=0)),t%=this.loadedRows.count,e%=this.op("columns"),0>t&&(t+=this.loadedRows.count),0>e&&(e+=this.op("columns")),!this.op("loop-row")&&(this.C.row=t),!this.op("loop-column")&&(this.C.col=e),this.currentFrame={row:this.loadedRows.indexes[t],col:e},this.currentFrame},p.prototype.jump_=function(t,e){var n,s,o,r=this.checkJumpRowCol(t,e);t=r.row,e=r.col,n=this.images.small[t][e],this.isFullScreen&&(!h||!this.imageQueue.fullscreen.length)&&this.images.fullscreen[t]&&this.images.fullscreen[t][e]&&this.images.fullscreen[t][e].loaded&&(n=this.images.fullscreen[t][e]),void 0!==this.lastBgIndex&&(this.bgImages.position[this.lastBgIndex]="0px -10000px"),this.bgImages.position[n.bgIndex]=n.left*this.size.width+"px 0px",this.lastBgIndex=n.bgIndex,(this.lastBgSize.width!==this.size.width*n.framesOnImage||this.lastBgSize.height!==this.size.height)&&(this.o.jSetCssProp("background-size",this.size.width*n.framesOnImage+"px "+this.size.height+"px"),this.lastBgSize={width:this.size.width*n.framesOnImage,height:this.size.height}),s=this.useMultiBackground?this.bgURL:n.bgURL,o=this.useMultiBackground?this.bgImages.position.join(","):n.left*this.size.width+"px "+n.top*this.size.height+"px",this.lastBgURL&&this.lastBgURL===s?(this.o.jSetCss({"background-position":o}),this.lastBgPos=o):(11==i.jBrowser.ieMode&&6.3===l&&this.o.jSetCss({"background-image":"none"}).jGetSize(),this.o.jSetCss(i.extend({"background-image":s},this.lastBgPos===o?{}:{"background-position":o})),this.lastBgPos=o,this.lastBgURL=s,i.jBrowser.trident&&i.jBrowser.ieMode<9&&this.o.jSetCss({"background-image":"none",filter:'progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod="scale", src="'+n.url+'")'})),!this.spinStarted||this.lastFrame&&this.lastFrame.row==t&&this.lastFrame.col==e||(this.op("onspin").call(null,this.o),this.spinStarted=!1,this.hintBox&&this.hideHintBox()),this.lastFrame=r},p.prototype.spin=function(t){this._hideM&&this._hideM(),this.hintBox&&this.hideHintBox(),this.spinStarted=!0,t?this.jump(this.C.row,this.C.col+t,!0,100*Math.log(Math.abs(t)/Math.log(2))):this._A.play(Number.MAX_VALUE)},p.prototype.magnify=function(t){(i.defined(t)?t:!0)?this._showM&&this._showM():this._hideM&&this._hideM()},p.prototype.stop=function(){var t,e,n,r=window.URL||window.webkitURL||null;for(this._A&&this._A.frames>0&&this._A.pause(),this.isFullScreen&&(this.o.firstChild.jSetCss({}),this.o.jSetCss({width:"",height:"100%","max-height":"","max-width":""}).jAppendTo(this.wrapper)),this.fullScreenBox&&(this.fullScreenScrollCallback&&s(window).jRemoveEvent("scroll",this.fullScreenScrollCallback),this.fullScreenScrollCallbackTimer&&clearTimeout(this.fullScreenScrollCallbackTimer),this.fullScreenBox.kill(),this.fullScreenBox=null),this.magnifier&&this.magnifier.div&&(this.magnifier.div.kill(),this.magnifier=null),this.fullscreenIcon&&(this.fullscreenIcon.kill(),this.fullscreenIcon=null),s(window).jRemoveEvent("resize",this.resizeCallback),this.o.jClearEvents();this.o.firstChild!=this.o.lastChild;)this.o.removeChild(this.o.lastChild);for("drag"==this.op("spin")&&s(document).jRemoveEvent([o.mousemove,"touchmove"],this.mMoveEvent),s(document).jRemoveEvent([o.mouseup,o.mouseout,"touchend"],this.mDocUpEvent),this.o.replaceChild(this.oi,this.o.firstChild),this.o.jSetCssProp("background",""),this.o.jRemoveClass("zoom-in"),this.wrapper&&(this.wrapper.parentNode.replaceChild(this.o,this.wrapper),this.wrapper.kill(),this.wrapper=null),t=0,e=this.addedCSS.length;e>t;t++)i.removeCSS("magic360-css",this.addedCSS[t]);if(r)for(n in this.imageMap)s(this.imageMap[n]).jEach(function(t){var e=t.img.bgURL.replace(/^url\s*\(\s*["']?/,"").replace(/["']?\s*\)$/,"");/^blob\:/.test(e)&&r.revokeObjectURL(e)})},p.prototype.enterFullscreen=function(){if(this._A.cancelable&&this.op("fullscreen")){this._hideM&&this._hideM();var t=s(document).jGetSize(),n=s(window).jGetScroll(),o=s(document).jGetFullSize(),r=window.parent!==window.window;r&&(o.height<=t.height&&(n.y=this.boxBoundaries.top),t.height=Math.min(t.height,this.fullScreenSize.height),t.height+n.y>o.height&&(t.width-=i.jBrowser.scrollbarsWidth)),this.fullScreenBox||(this.fullScreenBox=i.$new("div",{},{display:"block",overflow:"hidden",position:"absolute",zIndex:2e4,"text-align":"center","vertical-align":"middle",opacity:1,width:this.boxSize.width,height:this.boxSize.height,top:this.boxBoundaries.top,left:this.boxBoundaries.left}).jAddClass("Magic360-fullscreen"),i.jBrowser.touchScreen&&i.jBrowser.mobile||this.fullScreenBox.jAddClass("desktop"),i.jBrowser.ieMode&&this.fullScreenBox.jAddClass("magic-for-ie"+i.jBrowser.ieMode),i.jBrowser.ieMode&&i.jBrowser.ieMode<8&&this.fullScreenBox.append(i.$new("span",null,{display:"inline-block",height:"100%",width:1,"vertical-align":"middle"})),this.adjustFSSize=function(t){var e,i,n=this.fullScreenSize.width/this.fullScreenSize.height;return e=Math.min(this.fullScreenSize.width,.98*t.width),i=Math.min(this.fullScreenSize.height,.98*t.height),e/i>n?e=i*n:n>=e/i&&(i=e/n),{width:Math.floor(e),height:Math.floor(i)}},i.jBrowser.trident&&i.jBrowser.backCompat&&(this.fullScreenScrollCallback=function(){var t=s(window).jGetScroll(),e=this.fullScreenBox.jGetPosition();this.fullScreenScrollCallbackTimer&&clearTimeout(this.fullScreenScrollCallbackTimer),this.fullScreenScrollCallbackTimer=setTimeout(function(){new i.FX(this.fullScreenBox,{duration:250}).start({top:[e.top,t.y],left:[e.left,t.x]})}.jBind(this),300)}.jBind(this))),this.fullScreenImage||(this.fullScreenImage=s(this.o.firstChild.cloneNode(!1)).jSetCss({position:"relative","z-index":1})),this.fullScreenImage.jSetCss({"margin-top":"-100%","margin-left":"100%"}).jSetOpacity(0),this.fullScreenImage.jSetCss(t.width/t.height>this.fullScreenSize.width/this.fullScreenSize.height?{width:"auto",height:"98%","max-height":this.fullScreenSize.height,display:"inline-block","vertical-align":"middle"}:{width:"98%","max-width":this.fullScreenSize.width,height:"auto",display:"inline-block","vertical-align":"middle"}),this.fullScreenBox.jAppendTo(i.body).append(this.fullScreenImage),this.fullScreenBox.show(),this.o.jSetCss({width:this.fullScreenImage.jGetSize().width+this.borders,height:"auto","background-size":this.fullScreenImage.jGetSize().width+"px "+this.fullScreenImage.jGetSize().height+"px","z-index":2}).jAppendTo(this.fullScreenBox,"top"),e.jBrowser.features.fullScreen&&this.fullScreenBox.jSetOpacity(1),e.jBrowser.fullScreen.request(this.fullScreenBox,{onEnter:this.onEnteredFullScreen.jBind(this),onExit:this.onExitFullScreen.jBind(this),fallback:function(){this.fullScreenFX||(this.fullScreenFX=new i.FX(this.fullScreenBox,{duration:400,transition:i.FX.Transition.expoOut,onStart:function(){this.fullScreenBox.jSetCss({width:this.boxSize.width,height:this.boxSize.height,top:this.boxBoundaries.top,left:this.boxBoundaries.left}).jAppendTo(i.body)}.jBind(this),onAfterRender:function(){this.o.jSetCss(this.fullScreenImage.jGetSize()),this.size=this.o.jGetSize(),this.jump_(this.C.row,this.C.col)}.jBind(this),onComplete:function(){this.onEnteredFullScreen(!0)}.jBind(this)})),this.fullScreenFX.start({width:[this.boxSize.width,t.width],height:[this.boxSize.height,t.height],top:[this.boxBoundaries.top,0+n.y],left:[this.boxBoundaries.left,0+n.x],opacity:[0,1]})}.jBind(this)})}},p.prototype.onEnteredFullScreen=function(t){var e=window.parent!==window.window;if(!t||this.isFullScreen||e||i.jBrowser.trident&&i.jBrowser.backCompat||this.fullScreenBox.jSetCss({display:"block",position:"fixed",top:0,bottom:0,left:0,right:0,width:"auto",height:"auto"}),this.isFullScreen=!0,this.o.firstChild.jSetCss({width:"100%",height:"auto","max-width":this.fullScreenSize.width,"max-height":this.fullScreenSize.height}),this.resizeCallback(),this.firstFullScreenRun&&(setTimeout(function(){s(this.progressBar.textBox).jAppendTo(this.progressBar.barBox).replaceChild(i.doc.createTextNode(this.localString("fullscreen-loading-text")),this.progressBar.textBox.firstChild),this.progressBar.box.jAddClass("Magic360-loading-box-fs"),this.preloadImages("fullscreen",this.currentFrame.row+1,this.currentFrame.col+1)}.jBind(this),1),this.firstFullScreenRun=!1),this.jump_(this.C.row,this.C.col),this.fullScreenScrollCallback&&s(window).jAddEvent("scroll",this.fullScreenScrollCallback),this.leaveFSButton||(this.leaveFSButton=i.$new("div",{},{zIndex:20}).jAddClass("Magic360-button").jAddClass("fullscreen-exit").jAppendTo(this.fullScreenBox).jAddEvent(o.mousedown,function(t){t.stopDistribution()}).jAddEvent("click",function(t){var e;return 3==t.getButton()?!0:(t.stop(),(e=this.fullScreenBox.jFetch("fullscreen:pseudo:event:keydown"))&&(i.doc.jRemoveEvent("keydown",e),this.fullScreenBox.jDel("fullscreen:pseudo:event:keydown")),this.exitFullscreen(),!1)}.jBindAsEvent(this)),i.jBrowser.touchScreen&&this.leaveFSButton.jAddEvent("touchstart",function(t){t.stopDistribution()
})),this.leaveFSButton.show(),t){var n=function(t){27==t.keyCode&&(i.doc.jRemoveEvent("keydown",n),this.exitFullscreen())}.jBindAsEvent(this);this.fullScreenBox.jStore("fullscreen:pseudo:event:keydown",n),i.doc.jAddEvent("keydown",n),!i.jBrowser.touchScreen&&(this.leaveFSMessage=new i.Message("Press ESC key to leave full-screen",4e3,this.fullScreenBox,"Magic360-message"))}this.fullscreenIcon.hide()},p.prototype.exitFullscreen=function(){{var t=this.fullScreenBox.jGetSize(),n=this.fullScreenBox.jGetRect();this.checkJumpRowCol(this.C.row,this.C.col)}this.leaveFSMessage&&this.leaveFSMessage.hide(0),this._hideM&&this._hideM(),this.fullScreenImage.jSetCss(t.width/t.height>this.fullScreenSize.width/this.fullScreenSize.height?{width:"auto",height:"98%","max-height":this.fullScreenSize.height,display:"inline-block","vertical-align":"middle"}:{width:"98%","max-width":this.fullScreenSize.width,height:"auto",display:"inline-block","vertical-align":"middle"}),e.jBrowser.fullScreen.capable&&e.jBrowser.fullScreen.enabled()?e.jBrowser.fullScreen.cancel():(this.leaveFSButton.hide(),this.fullScreenExitFX||(this.fullScreenExitFX=new i.FX(this.fullScreenBox,{duration:300,transition:i.FX.Transition.expoOut,onStart:function(){this.isFullScreen=!1,this.fullScreenBox.jSetCss({position:"absolute"}).jAppendTo(i.body)}.jBind(this),onAfterRender:function(){this.o.jSetCss(this.fullScreenImage.jGetSize()),this.size=this.o.jGetSize(),this.jump_(this.C.row,this.C.col)}.jBind(this),onComplete:function(){this.onExitFullScreen(!0)}.jBind(this)})),this.fullScreenExitFX.start({width:[t.width,this.boxSize.width],height:[t.height,this.boxSize.height],top:[0+n.top,this.boxBoundaries.top],left:[0+n.left,this.boxBoundaries.left],opacity:[1,.5]}))},p.prototype.onExitFullScreen=function(){this.fullScreenBox&&(this.fullscreenProgressBox&&this.fullscreenProgressBox.jRemove()&&delete this.fullscreenProgressBox,this.fullScreenScrollCallback&&s(window).jRemoveEvent("scroll",this.fullScreenScrollCallback),this.isFullScreen=!1,this.o.jAppendTo(this.wrapper).jSetOpacity(0).jSetCss({width:"",height:"","max-height":"","max-width":"100%","z-index":""}),this.resizeCallback(),this.leaveFSButton.hide(),this.fullscreenIcon.show(),this.o.jSetOpacity(1),this.fullScreenBox.hide(),this.canMagnify=!0)},p.prototype.setupHint=function(){if(this.hintBox=i.$new("span",null,{position:"absolute","z-index":999,visibility:"hidden"}).jAddClass("Magic360-hint").jAppendTo(this.o),i.$new("span").jAddClass("hint-side").jAddClass("right").jAppendTo(this.hintBox),i.$new("span").jAddClass("hint-side").jAddClass("left").jAppendTo(this.hintBox),this.hintBox.append(i.$new("span",null,{display:"inline-block",height:"100%",width:1,"vertical-align":"middle"})),i.$new("span").jSetCss({position:"relative",margin:"auto",display:"inline-block","vertical-align":"middle"}).jAddClass("hint-text").append(document.createTextNode(this.localString(i.jBrowser.touchScreen?"mobile-hint-text":"hint-text"))).jAppendTo(this.hintBox),5==i.jBrowser.ieMode&&this.hintBox.jSetCss({height:this.hintBox.jGetSize().height}),this.hintBox.show(),this.op("mousewheel-step")>0){var t=function(){this.o.jRemoveEvent("mousescroll",t),this.hideHintBox()}.jBindAsEvent(this);this.o.jAddEvent("mousescroll",t)}if("hover"===this.op("spin")){var e=function(){this.hideHintBox(),this.o.jRemoveEvent("mousemove",e)}.jBindAsEvent(this);this.o.jAddEvent("mousemove",e)}},p.prototype.hideHintBox=function(){this.hintBox&&!this.hintBox.hidding&&(this.hintBox.hidding=!0,new i.FX(this.hintBox,{duration:200,onComplete:function(){this.hintBox.jRemove(),delete this.hintBox}.jBind(this)}).start({opacity:[this.hintBox.jGetCss("opacity"),0]}))},p.prototype.getCurrentFrame=function(){var t=this.checkJumpRowCol(this.C.row,this.C.col);return t.row++,t.col++,t};var f={version:"v4.5.16",tools:s([]),options:{},lang:{},callbacks:{},start:function(t){var e=null;return i.$A(t?[s(t)]:document.byClass("Magic360")).jEach(function(t){s(t)&&!f.tools.filter(function(e){return e.o===t}).length&&f.tools.push(e=new p(t))}.jBind(this)),e},stop:function(e){var i,n;if(e)return void((n=t(e))&&(n=f.tools.splice(f.tools.indexOf(n),1))&&n[0].stop()&&delete n[0]);for(;i=f.tools.length;)n=f.tools.splice(i-1,1),n[0].stop(),delete n[0]},spin:function(e,i){var n;(n=t(e))&&n.spin(i)},jump:function(e,i){var n=null;(n=t(e))&&(n._hideM&&n._hideM(),n.hintBox&&n.hideHintBox(),n.jump(n.C.row+i,n.C.col))},pause:function(e){var i;(i=t(e))&&i._A.pause()},magnifyOn:function(e){var i;(i=t(e))&&i.magnify(!0)},magnifyOff:function(e){var i;(i=t(e))&&i.magnify(!1)},fullscreen:function(e){var i;(i=t(e))&&i.enterFullscreen()},getCurrentFrame:function(e){var i,n=null;return(i=t(e))&&(n=i.getCurrentFrame(),n.column=n.col,delete n.col),n},registerCallback:function(t,e){f.callbacks[t]=e}};return s(document).jAddEvent("domready",function(){i.addCSS(".Magic360",{padding:"0 !important",outline:"0 !important",display:"inline-block","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box","box-sizing":"border-box","font-size":"0 !important","line-height":"100% !important","max-width":"100%","-webkit-transition":"none !important","-moz-transition":"none !important","-o-transition":"none !important",transition:"none !important"},"magic360-css"),i.addCSS(".Magic360 img",{border:"0 !important",padding:"0 !important",margin:"0 !important",height:"auto"},"magic360-css"),i.addCSS(".Magic360 > img",{width:"100%"},"magic360-css"),8===i.jBrowser.ieMode&&i.addCSS(".ie8-magic .Magic360 > img",{"max-width":"none !important"},"magic360-css"),7===i.jBrowser.ieMode&&i.addCSS(".ie7-magic .Magic360 > img",{width:"auto !important"},"magic360-css"),5===i.jBrowser.ieMode&&i.addCSS(".ie5-magic .MagicZoom img",{width:"auto !important"},"magic360-css"),i.addCSS(".Magic360-box",{"text-align":"center !important;"},"magic360-css"),i.addCSS(".Magic360-box:after",{content:'""',display:"inline-block","vertical-align":"middle"},"magic360-css"),i.addCSS(".Magic360-box .Magic360",{display:"inline-block !important","vertical-align":"middle"},"magic360-css"),i.addCSS(".magic-temporary-img img",{"max-height":"none !important","max-width":"none !important"},"magic360-css"),f.start()}),f}();!function(t){t.fn.loupe=function(e){var i=t.extend({loupe:"loupe",width:200,height:150},e||{});return this.length?this.each(function(){var n,s,o,r,a=t(this),h=a.is("img")?a:a.find("img:first"),l=function(){s.hide()};return null!=a.data("loupe")?a.data("loupe",e):(o=function(t){var e=h.offset(),o=h.outerWidth(),c=h.outerHeight(),u=i.width/2,d=i.height/2;return!a.data("loupe")||t.pageX>o+e.left+10||t.pageX<e.left-10||t.pageY>c+e.top+10||t.pageY<e.top-10?l():(r=r?clearTimeout(r):0,s.show().css({left:t.pageX-u,top:t.pageY-d}),void n.css({left:0|-((t.pageX-e.left)/o*n.width()-u),top:0|-((t.pageY-e.top)/c*n.height()-d)}))},s=t("<div />").addClass(i.loupe).css({width:i.width,height:i.height,position:"absolute",overflow:"hidden"}).append(n=t("<img />").attr("src",a.attr(a.is("img")?"src":"href")).css("position","absolute")).mousemove(o).hide().appendTo("body"),void a.data("loupe",!0).mouseenter(o).mouseout(function(){r=setTimeout(l,10)}))}):this}}(jQuery);var withMq=function(){this.MQ={PHONE:"phone",MEDIUM_SCREENS:"medium-screens",HANDHELDS:"handhelds",NOT_HANDHELDS:"not-handhelds",REGULAR_SCREENS:"regular-screens",WIDE_SCREENS:"wide-screens",XS:"Xs",SM:"Sm",MD:"Md",LG:"Lg"};var t={2:["handhelds","phone","xs"],3:["handhelds","medium-screens","sm"],4:["not-handhelds","regular-screens","md"],5:["not-handhelds","wide-screens","lg"]};this.mq=function(){return this._currentMq||this.initMq(),arguments.length?_.indexOf(this._currentMq,arguments[0])>=0:this._currentMq},this.hasMq=function(){return Modernizr.mq("only all")},this.getBreakpoint=function(){var e;try{e=parseInt(window.getComputedStyle(this.mqElement,null).getPropertyValue("z-index"),10)}catch(i){}return e?t[e]:[]},this.mqGroup=function(){return this.mq()[0]},this.mqDevice=function(){return this.mq()[1]},this.mqShorthand=function(){return this.mq()[2]},this.mqResize=function(){var t=this.getBreakpoint();_.difference(this._currentMq,t).length&&(this._currentMq=t,this.trigger("mq:change",[{mqs:t}]))},this.initMq=function(){this.mqElement=this.getMqElement(),this._currentMq=this.getBreakpoint()},this.createMqElement=function(){var t=document.createElement("div");return t.className="mqState",document.body.appendChild(t),t},this.getMqElement=function(){var t=$("body > .mqState");return t.length?t[0]:this.createMqElement()},this.after("initialize",function(){this.on(document,"app:resize",this.mqResize),this._currentMq||this.initMq()})},withOptions=function(){this.collectData=function(t){var e=t?$(t):this.$node,i=e.data();void 0!=i.datetime&&(i.datetime=i.datetime.length&&new Date(i.datetime),("object"!=typeof i.datetime||isNaN(i.datetime.getDate()))&&delete i.datetime),this.attr=$.extend(this.attr,i)},this.isMetaEvent=function(t){return t.metaKey||t.ctrlKey||t.shiftKey||t.altKey},this.onTeardown=function(t){this.teardown(),t.preventDefault(),t.stopImmediatePropagation()},this.hasOption=function(t,e){return e?this.attr[t]===!0:!!this.attr[t]},this.isInitialized=function(){return 0==this._initialized?!1:!0},this.before("initialize",function(){this._initialized=!1}),this.after("initialize",function(){this.on("teardown",this.onTeardown),this._initialized=!0})},withTouch=function(){this.defaultAttrs({drag_vertical:!1,swipe_time:20,swipe:!1,drag_min_distance:2,tap_max_distance:2}),this.enableDrag=function(t){this.hasTouch()&&(t||this.$node).hammer({drag_vertical:this.attr.drag_vertical,swipe_time:this.attr.swipe_time,swipe:this.attr.swipe,drag_min_distance:this.attr.drag_min_distance,tap_max_distance:this.attr.tap_max_distance})},this.hasTouch=function(){return Modernizr.touch}};(function(){this.JST||(this.JST={}),this.JST["templates/modal"]=function(obj){var __p=[];with(obj||{})__p.push("<aside class='modal ",cssClass,"' data-modal-container>\n  <div class='modal-container'>\n    <a href='#' class='modal-close icon-search_icon_close' data-modal-close> </a>\n    <div class='modal-body' data-modal-body>\n      ",html,"\n    </div>\n  </div>\n  <div class='backdrop modal-backdrop' data-modal-backdrop> </div>\n</aside>\n");return __p.join("")}}).call(this),function(){this.JST||(this.JST={}),this.JST["templates/pager"]=function(obj){var __p=[];with(obj||{})__p.push(""),_.each(pages,function(t,e){__p.push("\n  <a href='#",e,"' data-action='",e,"'>\n    ",e+1,"\n  </a>\n")}),__p.push("\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tooltip"]=function(obj){var __p=[];with(obj||{})__p.push("<div class='tooltip-container'>\n  ",html,"\n</div>\n");return __p.join("")}}.call(this);var Affix=flight.component(function(){this.defaultAttrs({$affixContainer:$(".js-affix"),$affixContent:$(".js-affix-content"),isAffixed:!1,affixContainerHeight:0,maxAffixWidth:1146,affixPadding:0}),this.refreshContainerDimensions=function(){var t=$(window).width();this.attr.maxAffixWidth=1185>t&&t>=938?938:1146;var e=t-this.attr.maxAffixWidth;this.attr.$affixContent.css(this.attr.isAffixed&&e>=0?{"padding-left":e/2,"padding-right":e/2}:{"padding-left":0,"padding-right":0})},this.fixContainerToBrowser=function(){this.attr.isAffixed=!0,this.attr.$affixContent.addClass("active"),this.attr.$affixContainer.css({height:this.attr.affixContainerHeight}),this.refreshContainerDimensions()},this.returnContainerToPage=function(){this.attr.isAffixed=!1,this.attr.$affixContent.removeClass("active"),this.attr.$affixContainer.css({height:"auto"}),this.refreshContainerDimensions()},this.checkIfContainerIsAboveBrowser=function(){this.attr.$affixContainer.offset().top-$(window).scrollTop()<-40?this.fixContainerToBrowser():this.returnContainerToPage()},this.after("initialize",function(){this.attr.$affixContainer.length>0&&this.attr.$affixContent.length>0&&(this.refreshContainerDimensions(),this.checkIfContainerIsAboveBrowser(),this.attr.affixContainerHeight=this.attr.$affixContent.height(),this.on(window,"scroll",this.checkIfContainerIsAboveBrowser),this.on(window,"resize",this.refreshContainerDimensions))})},withOptions),Carousel=flight.component(function(){this.defaultAttrs({rowSelector:".row",colSelector:".col",controlSelector:'[data-flight="control"]',pagerSelector:'[data-flight="pager"]',firstImageSelector:"img:first",threshold:.1,thresholdVelocity:.1,autoCycleDuration:7e3,index:0}),this.slideTo=function(t,e,i){t=Math.max(Math.min(t,this.length()-1),0);var n=t<this._currentIndex?"left":t>this._currentIndex?"right":"none";return this._currentIndex=t,e?(this.$cols().css("left",this.offset()),this.slid()):this.hasTransitions()?(i||this.setTransitionsDelays(n),this.startTransition(this.$cols()),this.$cols().css("left",this.offset()),this.slid()):this.$cols().animate({left:this.offset()},250,"swing",$.proxy(this.slid,this)),this.change(),!0},this.offset=function(){return-this._currentIndex*this.width()},this.next=function(t){this.slideTo(this._currentIndex+1),t&&t.stopPropagation()},this.cycle=function(){this.slideTo(this._currentIndex+1<this.length()?this._currentIndex+1:0)},this.prev=function(t){this.slideTo(this._currentIndex-1),t&&t.stopPropagation()},this.page=function(t,e,i){"click"==e&&this.slideTo(i),t&&t.stopPropagation()},this.dragstart=function(t){t.gesture&&(this._dragged=!0)},this.drag=function(t){t.gesture&&this._dragged&&("left"==t.gesture.direction||"right"==t.gesture.direction)&&(this.$cols().css({left:this.offset()+t.gesture.deltaX}),t.gesture.preventDefault(),t.gesture.stopPropagation())},this.dragend=function(t){if(t.gesture&&this._dragged){if("left"!=t.gesture.direction&&"right"!=t.gesture.direction)return void this.slideTo(this._currentIndex);var e=this.width()*this.attr.threshold,i=Math.abs(t.gesture.deltaX)>e,n=t.gesture.velocityX>this.attr.thresholdVelocity;if(!i&&!n)return void this.slideTo(this._currentIndex,!1,!0);t.gesture.deltaX>0?this.slideTo(this._currentIndex-1,!1,!0):this.slideTo(this._currentIndex+1,!1,!0),t.gesture.preventDefault(),t.gesture.stopPropagation()}},this.tap=function(){this._dragged=!1},this.click=function(t){this._dragged&&(t.preventDefault(),t.stopPropagation()),this._dragged=!1},this.length=function(){return Math.ceil(this.$cols().length/this.rowItems())},this.layout=function(){var t=this;this.$cols().each(function(){var e=$(this),i=t.colWidth();e.css("width",i+"px")});t.$node.css("opacity","1")},this.valignControls=function(){this.select("firstImageSelector").length&&this.select("controlsSelector").css("top",this.select("firstImageSelector").height()/2)},this.update=function(){this.trigger("update",[this._currentIndex,this.length()])},this.change=function(){this.trigger("change",[this._currentIndex,this.length()])},this.setTransitionsDelays=function(t){var e=this,i=.07,n=this.$cols().length;this.$cols().each(function(s){var o=$(this);"left"==t?e.delayTransition(o,(n-s)*i):"right"==t&&e.delayTransition(o,s*i)})},this.slid=function(){this.trigger("carousel:slid")},this.rowItems=function(){return this.hasMq()?this.attr["col"+this.mqShorthand()]:this.attr.coldefault},this.colWidth=function(){return this.width()/this.rowItems()},this.width=function(){return this.$node.width()+this.rowMargins()},this.rowMargins=function(){return Math.abs(parseInt(this.$row().css("marginLeft"))+parseInt(this.$row().css("marginRight")))},this.$row=function(){return this.select("rowSelector")},this.$cols=function(){return this._$cols?this._$cols:this._$cols=this.select("colSelector")},this.resize=function(t){("mq:change"==t.type||"xs"==this.mqShorthand())&&this.reset()},this.reset=function(){this.layout(),this.slideTo(this._currentIndex,!0),this.update()},this.slid=function(){this.trigger("carousel:slid")},this.transitionEnd=function(){this.endTransition(this.$cols())},this.attachUi=function(){Control.attachTo(this.select("controlSelector"),{$target:this.$node}),Pager.attachTo(this.select("pagerSelector"),{$target:this.$node})},this.initListeners=function(){this.on("control:prev",this.prev),this.on("control:next",this.next),this.on("pager:page",this.page),this.hasMq()&&(this.on(document,"app:resize",this.resize),this.on("mq:change",this.resize)),this.hasTouch()&&(this.enableDrag(this.$node),this.on("drag",this.drag),this.on("dragstart",this.dragstart),this.on("dragend",this.dragend),this.on("click",this.click),this.on("tap",this.tap)),this.hasTransitions()&&this.on(this.whichTransitionEnd(),this.transitionEnd)},this.after("initialize",function(){this.collectData(),this._currentIndex=this.attr.index,this.attachUi(),this.initListeners(),this.reset()})},withOptions,withMq,withTouch,withTransitions),Close=flight.component(function(){this.click=function(t){this.isActive()&&(this.$for().trigger("close"),t.preventDefault(),t.stopPropagation())},this.$for=function(t){return t=t||this.attr.$for,$(document.getElementById(t))},this.isActive=function(){return this.$node.is(".active")},this.after("initialize",function(){this.collectData(),this.on("click",this.click)})},withOptions),Control=flight.component(function(){this.defaultAttrs({$target:$(document)}),this.click=function(t){this.$node.hasClass("disabled")||this.trigger("control:"+this.attr.action),t.preventDefault(),t.stopPropagation()},this.change=function(t,e,i){var n="prev"==this.attr.action&&!e||"next"==this.attr.action&&!(e-i+1);this.$node.toggleClass("disabled",n),t.preventDefault(),t.stopPropagation()},this.after("initialize",function(){return this.collectData(),void 0===this.attr.action?void this.$node.hide():(this.on(this.attr.$target,"change",this.change),void this.on("click",this.click))})},withOptions),Datepicker=flight.component(function(){this.defaultAttrs({format:"dd.mm.yyyy",startDate:"02.08.2014",endDate:"29.08.2014",language:"de",daysOfWeekDisabled:"0"}),this.focus=function(t){t.preventDefault(),this.node.blur()},this.after("initialize",function(){this.collectData(),this.on("focus",this.focus),this.$node.datepicker({format:this.attr.format,startDate:this.attr.startDate,endDate:this.attr.endDate,language:this.attr.language,daysOfWeekDisabled:this.attr.daysOfWeekDisabled,autoclose:!0,disableSwitch:!0,todayBtn:!1,beforeShowDay:function(){return!1}})})},withOptions),Email=flight.component(function(){this.defaultAttrs({label:'[data-label="email"]'}),this.after("initialize",function(){this.collectData();var t=this.attr.local+"@"+this.attr.domain;this.node.href="mailto:"+t,this.select("label").text(t)})},withOptions),Equalize=flight.component(function(){this.reset=function(){$(".js-equalize-target").css({height:"auto"}),this.equalizeBoxes()},this.equalizeBoxes=function(){$.each($(".js-equalize-container"),function(){var t=0,e=$(this).find(".js-equalize-target");$.each(e,function(){myHeight=$(this).height(),t=myHeight>=t?myHeight:t}),e.css({height:t+"px"})})},this.after("initialize",function(){this.reset(),this.equalizeBoxes(),this.on(document,"app:resize",this.reset),this.on("mq:change",this.reset)})},withOptions),Grid=flight.component(function(){this.defaultAttrs({type:"",colSelector:".col",colDoubleSelector:".col-double"}),this.dynamic=function(){for(var t=[].repeat(0,this.rowItems()),e=this.$cols().length,i=this.colWidth(),n=0;e>n;n++){var s=$(this.$cols().get(n)),o=s.is(this.attr.colDoubleSelector),r=o?2*i:i,a=t.indexOf(Math.min.apply(Math,t));s.css({width:r,top:t[a],left:a*i});var h=s.outerHeight();t[a]+=h,o&&(t[a+1]+=h)}this.$node.height(Math.max.apply(Math,t))},this.imagesLoaded=function(){this.$cols().addClass("img-loaded"),this.reset()},this.width=function(){return this.$node.width()},this.rowItems=function(){return this.hasMq()?this.attr["col"+this.mqShorthand()]:this.attr.coldefault},this.colWidth=function(){return this.width()/this.rowItems()},this.$row=function(){return this.select("rowSelector")},this.$cols=function(){return this._$cols?this._$cols:this._$cols=this.select("colSelector")},this.resize=function(t){("mq:change"==t.type||"xs"==this.mqShorthand())&&this.reset()},this.reset=function(){"dynamic"==this.attr.type&&this.dynamic()},this.loadImages=function(t){var e=imagesLoaded(t);e.on("done",$.proxy(this.imagesLoaded,this))},this.after("initialize",function(){this.collectData(),this.hasMq()&&(this.on(document,"app:resize",this.resize),this.on("mq:change",this.resize)),this.loadImages(this.node)})},withOptions,withMq),InputNumber=flight.component(function(){this.defaultAttrs({tooltipSelector:"[data-form-tooltip-update]"}),this.click=function(){this.$node.closest("form").submit()},this.keypress=function(t){var e=t.which;e>=48&&t.which<=57||0!=e&&8!=e&&t.preventDefault()},this.blur=function(){var t=this.$node.val();(""==t||isNaN(t))&&this.$node.val(this._startValue)},this.change=function(t){if(console.log(this.$node.val()),!this.isMetaEvent(t)){var e=this.$node.val();""==e||isNaN(e)||e==this._startValue?this.hide():this.show()}},this.show=function(){if(this._enableTooltip&&!this._active){this._active=!0,this.$node.tooltip("show");var t=this.$node.siblings(this.attr.tooltipSelector);t.on("click",$.proxy(this.click,this))}},this.hide=function(){this._enableTooltip&&this._active&&(this._active=!1,this.$node.tooltip("hide"))},this.isNumberInputEnabled=function(){$(".input-number").length},this.resize=function(){this._active&&this.$node.tooltip("show")},this.after("initialize",function(){this.collectData(),this._enableTooltip=this.attr.title&&this.attr.title.length>0,this._enableTooltip&&this.$node.tooltip({trigger:"manual",placement:"bottom",animation:!0,template:'<div class="tooltip form-tooltip-update" data-form-tooltip-update><div class="tooltip-arrow"></div><button class="btn-empty tooltip-inner"></button></div>'}),this._startValue=this.$node.val(),this.isNumberInputEnabled()&&this.on("keypress",this.keypress),this.on("input change keyup",this.change),this.on("blur",this.blur),this.hasMq()&&this.on(document,"app:resize",this.resize)})},withOptions,withMq),Map=flight.component(function(){this.defaultAttrs({lat:47.137425,lng:7.745361,locationSelector:"[data-location]",inputSelector:"[data-location-input]",mapSelector:"#map"}),this.centerChanged=function(){var t=this.map.getCenter();this.sortLocation(t.lat(),t.lng())},this.sortLocation=function(t,e){var i=this;this.locations=this.locations.sort(function(n,s){var o=i.distance(t,e,n.lat,n.lng),r=i.distance(t,e,s.lat,s.lng);return o>r?1:r>o?-1:0}),$.each(this.locations,function(){var t=this.$element.parent();t.appendTo(t.parent())})},this.placeChanged=function(){this.setLocationByInput()},this.$input=function(){return $(this.attr.inputSelector)},this.submit=function(){arguments.length&&arguments[0].preventDefault(),this.setLocationByInput()},this.setLocationByInput=function(){var t=this.$input().val();$.cookie("map-location",t),this.geocode(t)},this.geocode=function(t){GMaps.geocode({address:t,callback:$.proxy(this.geocoded,this)})},this.geocoded=function(t,e){if("OK"==e){var i=t[0].geometry.location;this.map.setCenter(i.lat(),i.lng())}},this.distance=function(t,e,i,n){var s=Math.PI*t/180,o=Math.PI*i/180,r=(Math.PI*e/180,Math.PI*n/180,e-n),a=Math.PI*r/180,h=Math.sin(s)*Math.sin(o)+Math.cos(s)*Math.cos(o)*Math.cos(a);return h=Math.acos(h),h=180*h/Math.PI,h=60*h*1.1515,1.609344*h},this.initLocations=function(){var t=this;this.locations=[],$(this.attr.locationSelector).each(function(){var e=$(this),i=e.data("location").split(","),n=i[0].trim(),s=i[1].trim(),o=e.data("marker"),r=e.data("title");t.locations.push({lat:n,lng:s,$element:e});var a=new google.maps.InfoWindow({content:'<p class="map-infowindow">'+r+"</p>"}),o=t.map.addMarker({lat:n,lng:s,icon:o,title:r,click:function(){e.data("href")&&(document.location.href=e.data("href"))}});google.maps.event.addListener(o,"mouseover",function(){a.open(t.map,o)}),google.maps.event.addListener(o,"mouseout",function(){a.close(t.map,o)})})},this.after("initialize",function(){if(this.collectData(),this.map=new GMaps({div:this.node,lat:this.attr.lat,lng:this.attr.lng,zoom:8}),this.map.setOptions({styles:t,scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!0,panControl:!1,streetViewControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},mapTypeId:google.maps.MapTypeId.ROADMAP}),this.on(this.$input().closest("form"),"submit",this.submit),!this.hasTouch()&&this.$input().length){var e={types:["geocode"],componentRestrictions:{country:"ch"}};this.autocomplete=new google.maps.places.Autocomplete(this.$input()[0],e),google.maps.event.addListener(this.autocomplete,"place_changed",$.proxy(this.placeChanged,this))}this.initLocations(),google.maps.event.addListener(this.map.map,"center_changed",$.proxy(this.centerChanged,this)),$.cookie("map-location")&&(this.$input().val($.cookie("map-location")),this.submit())});var t=[{featureType:"landscape",stylers:[{visibility:"simplified"}]},{featureType:"poi",stylers:[{visibility:"simplified"}]},{featureType:"road",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"simplified"}]},{featureType:"transit",stylers:[{visibility:"simplified"}]},{stylers:[{weight:1},{saturation:.5},{gamma:1.5}]}]},withOptions,withTouch),Modal=flight.component(function(){this.defaultAttrs({containerSelector:"[data-modal-container]",backdropSelector:"[data-modal-backdrop]",modalSelector:"[data-modal]",closeSelector:"[data-modal-container] [data-modal-close]",parentSelector:"body"}),this.show=function(t,e,i){this.isOpen()&&this.remove(),this._id=i,this._open=!0,e instanceof Object||console.error("modal:show, wrong argument type: data"),this.fix(),this.render(e),this._showTransitionCycles=0,this.showTransition()},this.showTransition=function(){return clearTimeout(this._showTransitionTimeout),this.$container().length?(this.$container().addClass("open"),clearTimeout(this._transitionEndTimeout),void(this._transitionEndTimeout=setTimeout($.proxy(this.showTransitionEnd,this),420))):(this._showTransitionCycles++,void(this._showTransitionCycles>40?this.destroy():this._showTransitionTimeout=setTimeout($.proxy(this.showTransition,this),20)))},this.showTransitionEnd=function(){clearTimeout(this._transitionEndTimeout),this.$container().addClass("opened")},this.render=function(t){var e=JST["templates/modal"](t);$(e).appendTo($(document.body)),this.trigger("modal:render")},this.fix=function(){this._scrollTop=this._scrollTop||$(document).scrollTop(),this.$parent().addClass("modal-open").css("top",-1*parseInt(this._scrollTop)),$(document).scrollTop(0)},this.hide=function(t,e){!this.isOpen()||void 0!=e&&e!=this._id||(this._id=void 0,this.$container().removeClass("open"),clearTimeout(this._transitionEndTimeout),this._transitionEndTimeout=setTimeout($.proxy(this.hideTransitionEnd,this),420))},this.hideTransitionEnd=function(){clearTimeout(this._transitionEndTimeout),this.$container().removeClass("opened"),this.destroy()},this.destroy=function(){this.unfix(),this.remove(),this._open=!1,this.trigger("modal:destroy")},this.remove=function(){this.$container().remove()},this.unfix=function(){this.$parent().removeClass("modal-open").css("top",0),$(document).scrollTop(this._scrollTop||0),this._scrollTop=void 0},this.keydown=function(t){27===t.which&&this.isOpen()&&this.hide()},this.isOpen=function(){return this._open},this.open=function(t){if(!this.isMetaEvent(t)){try{var e=$(t.target),e=e.is(this.attr.modalSelector)?e:e.closest(this.attr.modalSelector),i=$(e.data("modal-html")).html(),n=e.data("modal-cssClass");this.show(t,{html:i,cssClass:n},e[0].id)}catch(s){console.log("error rendering modal: "+s)}t.preventDefault()}},this.close=function(t){this.isMetaEvent(t)||(this.hide(),t.preventDefault())},this.$parent=function(){return $(this.attr.parentSelector)},this.$container=function(){return $(this.attr.containerSelector)},this.after("initialize",function(){this.on("click",{modalSelector:this.open,closeSelector:this.close,backdropSelector:this.close}),this.on(document,"modal:show",this.show),this.on(document,"modal:hide",this.hide),this.on(document,"keydown",this.keydown)})},withOptions),Pager=flight.component(function(){this.defaultAttrs({linkSelector:"a[data-action]",$target:$(document),render:!1}),this.click=function(t){var e=$(t.target);e.is(this.attr.linkSelector)||(e=e.closest(this.attr.linkSelector)),e.length&&(this.page("click",e.data("action")),t.preventDefault())},this.mouseenter=function(){this.page("mouseenter")},this.change=function(t,e){$(this.$children().removeClass("active").get(e)).addClass("active")},this.$children=function(){return this.select("linkSelector")},this.update=function(t,e,i){"auto"==this.attr.render&&this.render(i),this.change(void 0,e)},this.render=function(t){if(this.select("linkSelector").length!==t){var e=new Array(t),i={pages:e},n=JST["templates/pager"](i);this.$node.html(n)}},this.page=function(t,e){this.trigger("pager:page",[t,e])},this.after("initialize",function(){this.collectData(),this.on(this.attr.$target,"update",this.update),this.on(this.attr.$target,"change",this.change),this.on("click",this.click),this.on("mouseenter",this.mouseenter)})},withOptions),ResponsiveImage=flight.component(function(){this.defaultAttrs({imageSelector:"img"}),this.isNotMobile=function(){return!(this.hasMq()&&this.mq("phone"))},this.setImage=function(){this.$node.is(this.attr.imageSelector)?this.node.src=this.attr.src:this.$node.css({backgroundImage:"url("+this.attr.backgroundImage+")"}),this.teardown()},this.mqChange=function(){this.isNotMobile()&&this.setImage()},this.after("initialize",function(){this.collectData(),this.isNotMobile()&&this.setImage(),this.on("mq:change",this.mqChange)})},withOptions,withMq),Toggle=flight.component(function(){this.defaultAttrs({radioSelector:"input[type=radio]",checkboxSelector:"input[type=checkbox]",selectSelector:"select",selectedSelector:":selected",toggleContainerSelector:".toggle-container",inputSelector:"input[type=text]:first"}),this.show=function(t){t.preventDefault(),this.hasClass("active")||(this.toggleClickListeners(!1),this.toggleCloseListeners(!0),this.addClass("active"),this.focus())},this.hide=function(t){t.preventDefault(),this.hasClass("active")&&(this.toggleClickListeners(!0),this.toggleCloseListeners(!1),this.removeClass("active"))},this.click=function(t){this.node===t.target||this.$node.find(t.target).length||this.$for().find(t.target).length||(this.removeClass("active"),this.toggleCloseListeners(!1),clearTimeout(this.timeout),this.timeout=setTimeout($.proxy(this.toggleClickListeners,this,!0),500))},this.blur=function(){this.removeClass("active"),this.toggleCloseListeners(!1),clearTimeout(this.timeout),this.timeout=setTimeout($.proxy(this.toggleClickListeners,this,!0),500)},this.keydown=function(t){27===t.which&&(this.removeClass("active"),this.toggleClickListeners(!0),this.toggleCloseListeners(!1))},this.close=function(){this.removeClass("active"),this.toggleClickListeners(!0),this.toggleCloseListeners(!1)},this.radioOrCheckboxchange=function(){this.$node.data("group")?$('input[name="'+this.$node.data("group")+'"]').trigger("toggle:radio_checkbox:change"):this.$for().toggleClass("active",this.node.checked)},this.toggleRadioOrCheckboxChange=function(){this.$node.closest(this.attr.toggleContainerSelector).toggleClass("active",this.node.checked),this.$for().toggleClass("active",this.node.checked),this.node.checked&&this.focus()},this.selectChange=function(){$('[data-group="'+this.$node.data("group")+'"]').removeClass("active"),this.$for(this.select("selectedSelector")[0].id).addClass("active"),this.focus()},this.focus=function(){this.hasOption("focus",!0)&&this.$forInput().focus(),this.isInitialized()&&this.hasOption("anchor")&&(document.location.hash="#"+this.attr.anchor)},this.toggleClickListeners=function(t){this.isClick()&&(t?(this.off("click",this.hide),this.on("click",this.show)):(this.off("click",this.show),this.on("click",this.hide)))},this.toggleCloseListeners=function(t){var e=t?"on":"off";this.hasClose("blur")&&this[e](this.$forInput(),"blur",this.blur),this.hasClose("esc")&&this[e](document,"keydown",this.keydown),this.hasClose("document")&&this[e](document,"click",this.click),this[e]("close",this.close)},this.hasClass=function(t){return this.$node.hasClass(t)},this.addClass=function(t){this.$node.addClass(t),this.$for().addClass(t)},this.removeClass=function(t){this.$node.removeClass(t),this.$for().removeClass(t)},this.$for=function(t){return t=t||this.node.id,$('[data-for="'+t+'"]')},this.isClick=function(){return!this.isRadioOrCheckbox()&&!this.isSelect()},this.isRadioOrCheckbox=function(){return this.$node.is(this.attr.radioSelector)||this.$node.is(this.attr.checkboxSelector)},this.isSelect=function(){return this.$node.is(this.attr.selectSelector)},this.$forInput=function(t){return this.$for(t).find(this.attr.inputSelector)},this.hasClose=function(t){return this.attr["close"+t.capitalize()]===!0},this.initRadioOrCheckbox=function(){this.on("change",this.radioOrCheckboxchange),this.on("toggle:radio_checkbox:change",this.toggleRadioOrCheckboxChange),this.toggleRadioOrCheckboxChange()
},this.initSelect=function(){this.on("change",this.selectChange),this.selectChange()},this.after("initialize",function(){this.collectData(),this.isRadioOrCheckbox()?this.initRadioOrCheckbox():this.isSelect()?this.initSelect():this.toggleClickListeners(!0)})},withOptions),Tooltip=flight.component(function(){this.defaultAttrs({tooltipSelector:".tooltip-container"}),this.create=function(){var t=JST["templates/tooltip"]({html:this.node.title});this.$node.append(t),this.node.title=""},this.show=function(){var t=this.select("tooltipSelector");t.stop().show()},this.hide=function(){var t=this.select("tooltipSelector");t.stop().hide()},this.move=function(t){var e=this.select("tooltipSelector"),i=t.clientX,n=t.clientY,s=$(window).width()-i<200;e.css({left:i+(s?-150:5),top:n+15})},this.after("initialize",function(){""!==this.node.title&&(this.create(),this.on("mouseover",this.show),this.on("mousedown",this.show),this.on("mouseleave",this.hide),this.on(window,"scroll",this.hide),this.on(window,"touchstart",this.hide),this.on("mousemove",this.move))})},withOptions),Zoom=flight.component(function(){this.defaultAttrs({containerSelector:"[data-zoom-container]",zoomSelector:"[data-zoom]",parentSelector:"body",modalCssClass:"modal-zoom",modalId:"modal-zoom",carouselSelector:'[data-flight="carousel"]'}),this.open=function(t,e){if(this.isAllowedMq()&&!(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey))try{var i=$(e.el),n=$(i.data("zoom-html")).html(),s=i.data("action"),o={html:n,cssClass:this.attr.modalCssClass};this.carouselIndex=s,this.on("modal:render",this.modalRender),this.trigger("modal:show",[o,this.attr.modalId]),t.preventDefault()}catch(r){console.log("error rendering zoom: "+r)}},this.resize=function(t){"mq:change"!=t.type||this.isAllowedMq()||this.trigger("modal:hide")},this.isAllowedMq=function(){return"xs"!=this.mqShorthand()},this.modalRender=function(){this.off("modal:render",this.modalRender),Carousel.attachTo($(this.attr.carouselSelector),{index:this.carouselIndex})},this.after("initialize",function(){this.on("click",{zoomSelector:this.open}),this.hasMq()&&this.on("mq:change",this.resize)})},withOptions,withMq),App=flight.component(function(){this.defaultAttrs({toggleSelector:'[data-flight="toggle"]',closeSelector:'[data-flight="close"]',carouselSelector:'[data-flight="carousel"]',mapSelector:'[data-flight="map"]',emailSelector:'[data-flight="email"]',inputNumberSelector:'[data-flight="input-number"]',responsiveImageSelector:'[data-flight="responsive-image"]',datepickerSelector:'[data-flight="datepicker"]',tooltipSelector:'[data-flight="tooltip"]'}),this.reset=function(){clearTimeout(this.resetTimeout),this.resetTimeout=setTimeout($.proxy(this.triggerReset,this),100)},this.triggerReset=function(){this.attachUI()},this.resize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout($.proxy(this.triggerResize,this),50)},this.triggerResize=function(){this.trigger("app:resize")},this.scroll=function(){this.scrollTop=this.$window.scrollTop(),this.$node.trigger("app:scroll",[{windowHeight:this.windowHeight,scrollTop:this.scrollTop}]),clearTimeout(this.scrollTimeout),$(document.documentElement).toggleClass("no-events",!0),this.scrollTimeout=setTimeout($.proxy(this.triggerScroll,this),50)},this.triggerScroll=function(){$(document.documentElement).removeClass("no-events")},this.attachUI=function(){Toggle.attachTo(this.select("toggleSelector")),Close.attachTo(this.select("closeSelector")),Carousel.attachTo(this.select("carouselSelector")),Map.attachTo(this.select("mapSelector")),InputNumber.attachTo(this.select("inputNumberSelector")),Email.attachTo(this.select("emailSelector")),ResponsiveImage.attachTo(this.select("responsiveImageSelector")),Datepicker.attachTo(this.select("datepickerSelector")),Tooltip.attachTo(this.select("tooltipSelector"))},this.attachToDocument=function(){Modal.attachTo(document),Zoom.attachTo(document),Affix.attachTo(document),$(window).load(function(){Equalize.attachTo(document)})},this.after("initialize",function(){this.$window=$(window),this.$document=$(document),this.windowHeight=this.$window.height(),this.scrollTop=this.$window.scrollTop(),this.attachUI(),this.attachToDocument(),this.on(window,"resize",this.resize),this.on(window,"scroll",this.scroll),this.on(document,"dom:reset",this.reset)})},withMq);$(document).ready(function(){var t="pulse-twice";t="animated-swing";var e;pulseAddToCart=function(){$(".js-animate-add-to-cart").removeClass(t),$(".js-animate-add-to-cart").addClass(t),e=setTimeout(function(){$(".js-animate-add-to-cart").removeClass(t)},1200)},showSuccessMessageOnButton=function(t){var e=$('<div class="btn-success-overlay animated zoom-in"><i class="icon-done"></i></div>');$(t).append(e),setTimeout(function(){$(e).slideUp(200)},1500)},$(".item-add-to-cart, .js-show-success").click(function(){showSuccessMessageOnButton(this)}),$(".js-btn-add-to-cart").click(function(){pulseAddToCart(),showSuccessMessageOnButton(this)})}),$(document).ready(function(){function t(){e=$(".list-blocks").offset().top,$(window).width()>992?$(window).scroll(function(){n=$("footer").offset().top,i=$(o).offset().top-$(window).scrollTop(),$(window).width()>=992&&(0>i&&$(window).scrollTop()>e&&$(window).scrollTop()+$(o).outerHeight()<n-s&&($(o).addClass("affix-active"),$(o).css("top",function(t,e){return parseInt(e,10)+Math.abs(i)+"px"})),i>0&&$(window).scrollTop()>e&&$(window).scrollTop()+$(o).outerHeight()<n-s&&($(o).addClass("affix-active"),$(o).css("top",function(t,e){return parseInt(e,10)-Math.abs(i)+"px"})),$(window).scrollTop()<e&&($(o).css("top","0px"),$(o).removeClass("affix-active")))}):($(o).css("top","0px"),$(o).removeClass("affix-active"))}var e,i,e,n,s,o=$(".js-block-cart-affix");$(o).length>0&&(e=$(".list-blocks").offset().top,i=e,n=$("footer").offset().top,s=100,$(window).resize(t),$(window).on("load",t))}),$(document).ready(function(){$(".js-hider-trigger").click(function(){$(this).closest(".js-hider-container").find(".js-hider-content").toggleClass("active"),$(this).closest(".js-hider-container").find(".js-hider-trigger").toggleClass("active")})}),$(document).ready(function(){$(".dropdown").hoverIntent({over:function(){$(this).find(".dropdown-content").show(),$(this).addClass("active")},out:function(){$(this).find(".dropdown-content").hide(),$(this).removeClass("active")},timeout:300})}),$(document).ready(function(){$(".no-touch .js-loupe").loupe({width:200,height:200,loupe:"loupe"})}),$(document).ready(function(){$(".multiselect").chosen({width:"100%"})}),$(document).ready(function(){$(".overlay-360-toggle").click(function(){$(".overlay-360").fadeToggle()})}),$(function(){$(".js-multiselect").multipleSelect({selectAll:!1,placeholder:$(".js-multiselect").attr("placeholder"),countSelected:"# von %",minimumCountSelected:"1",width:"100%"})}),!function(t){if(!t.console){var e=t.console={};e.log=e.error=e.info=e.debug=e.warn=e.trace=e.dir=e.dirxml=e.group=e.groupEnd=e.time=e.timeEnd=e.assert=e.profile=e.profileEnd=function(){}}}(window),App.attachTo(document);
/* Fancybox*/
!function(e,t,n,i){"use strict";var o=n("html"),a=n(e),r=n(t),s=n.fancybox=function(){s.open.apply(this,arguments)},l=navigator.userAgent.match(/msie/i),c=null,d=t.createTouch!==i,p=function(e){return e&&e.hasOwnProperty&&e instanceof n},h=function(e){return e&&"string"===n.type(e)},f=function(e){return h(e)&&e.indexOf("%")>0},u=function(e){return e&&!(e.style.overflow&&"hidden"===e.style.overflow)&&(e.clientWidth&&e.scrollWidth>e.clientWidth||e.clientHeight&&e.scrollHeight>e.clientHeight)},g=function(e,t){var n=parseInt(e,10)||0;return t&&f(e)&&(n=s.getViewport()[t]/100*n),Math.ceil(n)},m=function(e,t){return g(e,t)+"px"};n.extend(s,{version:"2.1.5",defaults:{padding:0,margin:0,width:800,height:600,minWidth:360,minHeight:180,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!d,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!1,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(l?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeChange:n.noop,beforeClose:n.noop,afterClose:n.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(e,t){return e&&(n.isPlainObject(t)||(t={}),!1!==s.close(!0))?(n.isArray(e)||(e=p(e)?n(e).get():[e]),n.each(e,function(o,a){var r,l,c,d,f,u,g,m={};"object"===n.type(a)&&(a.nodeType&&(a=n(a)),p(a)?(m={href:a.data("fancybox-href")||a.attr("href"),title:a.data("fancybox-title")||a.attr("title"),isDom:!0,element:a},n.metadata&&n.extend(!0,m,a.metadata())):m=a),r=t.href||m.href||(h(a)?a:null),l=t.title!==i?t.title:m.title||"",c=t.content||m.content,d=c?"html":t.type||m.type,!d&&m.isDom&&(d=a.data("fancybox-type"),d||(f=a.prop("class").match(/fancybox\.(\w+)/),d=f?f[1]:null)),h(r)&&(d||(s.isImage(r)?d="image":s.isSWF(r)?d="swf":"#"===r.charAt(0)?d="inline":h(a)&&(d="html",c=a)),"ajax"===d&&(u=r.split(/\s+/,2),r=u.shift(),g=u.shift())),c||("inline"===d?r?c=n(h(r)?r.replace(/.*(?=#[^\s]+$)/,""):r):m.isDom&&(c=a):"html"===d?c=r:d||r||!m.isDom||(d="inline",c=a)),n.extend(m,{href:r,type:d,content:c,title:l,selector:g}),e[o]=m}),s.opts=n.extend(!0,{},s.defaults,t),t.keys!==i&&(s.opts.keys=t.keys?n.extend({},s.defaults.keys,t.keys):!1),s.group=e,s._start(s.opts.index)):void 0},cancel:function(){var e=s.coming;e&&!1!==s.trigger("onCancel")&&(s.hideLoading(),s.ajaxLoad&&s.ajaxLoad.abort(),s.ajaxLoad=null,s.imgPreload&&(s.imgPreload.onload=s.imgPreload.onerror=null),e.wrap&&e.wrap.stop(!0,!0).trigger("onReset").remove(),s.coming=null,s.current||s._afterZoomOut(e))},close:function(e){s.cancel(),!1!==s.trigger("beforeClose")&&(s.unbindEvents(),s.isActive&&(s.isOpen&&e!==!0?(s.isOpen=s.isOpened=!1,s.isClosing=!0,n(".fancybox-item, .fancybox-nav").remove(),s.wrap.stop(!0,!0).removeClass("fancybox-opened"),s.transitions[s.current.closeMethod]()):(n(".fancybox-wrap").stop(!0).trigger("onReset").remove(),s._afterZoomOut())))},play:function(e){var t=function(){clearTimeout(s.player.timer)},n=function(){t(),s.current&&s.player.isActive&&(s.player.timer=setTimeout(s.next,s.current.playSpeed))},i=function(){t(),r.unbind(".player"),s.player.isActive=!1,s.trigger("onPlayEnd")},o=function(){s.current&&(s.current.loop||s.current.index<s.group.length-1)&&(s.player.isActive=!0,r.bind({"onCancel.player beforeClose.player":i,"onUpdate.player":n,"beforeLoad.player":t}),n(),s.trigger("onPlayStart"))};e===!0||!s.player.isActive&&e!==!1?o():i()},next:function(e){var t=s.current;t&&(h(e)||(e=t.direction.next),s.jumpto(t.index+1,e,"next"))},prev:function(e){var t=s.current;t&&(h(e)||(e=t.direction.prev),s.jumpto(t.index-1,e,"prev"))},jumpto:function(e,t,n){var o=s.current;o&&(e=g(e),s.direction=t||o.direction[e>=o.index?"next":"prev"],s.router=n||"jumpto",o.loop&&(0>e&&(e=o.group.length+e%o.group.length),e%=o.group.length),o.group[e]!==i&&(s.cancel(),s._start(e)))},reposition:function(e,t){var i,o=s.current,a=o?o.wrap:null;a&&(i=s._getPosition(t),e&&"scroll"===e.type?(delete i.position,a.stop(!0,!0).animate(i,200)):(a.css(i),o.pos=n.extend({},o.dim,i)))},update:function(e){var t=e&&e.type,n=!t||"orientationchange"===t;n&&(clearTimeout(c),c=null),s.isOpen&&!c&&(c=setTimeout(function(){var i=s.current;i&&!s.isClosing&&(s.wrap.removeClass("fancybox-tmp"),(n||"load"===t||"resize"===t&&i.autoResize)&&s._setDimension(),"scroll"===t&&i.canShrink||s.reposition(e),s.trigger("onUpdate"),c=null)},n&&!d?0:300))},toggle:function(e){s.isOpen&&(s.current.fitToView="boolean"===n.type(e)?e:!s.current.fitToView,d&&(s.wrap.removeAttr("style").addClass("fancybox-tmp"),s.trigger("onUpdate")),s.update())},hideLoading:function(){r.unbind(".loading"),n("#fancybox-loading").remove()},showLoading:function(){var e,t;s.hideLoading(),e=n('<div id="fancybox-loading"><div></div></div>').click(s.cancel).appendTo("body"),r.bind("keydown.loading",function(e){27===(e.which||e.keyCode)&&(e.preventDefault(),s.cancel())}),s.defaults.fixed||(t=s.getViewport(),e.css({position:"absolute",top:.5*t.h+t.y,left:.5*t.w+t.x}))},getViewport:function(){var t=s.current&&s.current.locked||!1,n={x:a.scrollLeft(),y:a.scrollTop()};return t?(n.w=t[0].clientWidth,n.h=t[0].clientHeight):(n.w=d&&e.innerWidth?e.innerWidth:a.width(),n.h=d&&e.innerHeight?e.innerHeight:a.height()),n},unbindEvents:function(){s.wrap&&p(s.wrap)&&s.wrap.unbind(".fb"),r.unbind(".fb"),a.unbind(".fb")},bindEvents:function(){var e,t=s.current;t&&(a.bind("orientationchange.fb"+(d?"":" resize.fb")+(t.autoCenter&&!t.locked?" scroll.fb":""),s.update),e=t.keys,e&&r.bind("keydown.fb",function(o){var a=o.which||o.keyCode,r=o.target||o.srcElement;return 27===a&&s.coming?!1:void(o.ctrlKey||o.altKey||o.shiftKey||o.metaKey||r&&(r.type||n(r).is("[contenteditable]"))||n.each(e,function(e,r){return t.group.length>1&&r[a]!==i?(s[e](r[a]),o.preventDefault(),!1):n.inArray(a,r)>-1?(s[e](),o.preventDefault(),!1):void 0}))}),n.fn.mousewheel&&t.mouseWheel&&s.wrap.bind("mousewheel.fb",function(e,i,o,a){for(var r=e.target||null,l=n(r),c=!1;l.length&&!(c||l.is(".fancybox-skin")||l.is(".fancybox-wrap"));)c=u(l[0]),l=n(l).parent();0===i||c||s.group.length>1&&!t.canShrink&&(a>0||o>0?s.prev(a>0?"down":"left"):(0>a||0>o)&&s.next(0>a?"up":"right"),e.preventDefault())}))},trigger:function(e,t){var i,o=t||s.coming||s.current;if(o){if(n.isFunction(o[e])&&(i=o[e].apply(o,Array.prototype.slice.call(arguments,1))),i===!1)return!1;o.helpers&&n.each(o.helpers,function(t,i){i&&s.helpers[t]&&n.isFunction(s.helpers[t][e])&&s.helpers[t][e](n.extend(!0,{},s.helpers[t].defaults,i),o)}),r.trigger(e)}},isImage:function(e){return h(e)&&e.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(e){return h(e)&&e.match(/\.(swf)((\?|#).*)?$/i)},_start:function(e){var t,i,o,a,r,l={};if(e=g(e),t=s.group[e]||null,!t)return!1;if(l=n.extend(!0,{},s.opts,t),a=l.margin,r=l.padding,"number"===n.type(a)&&(l.margin=[a,a,a,a]),"number"===n.type(r)&&(l.padding=[r,r,r,r]),l.modal&&n.extend(!0,l,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),l.autoSize&&(l.autoWidth=l.autoHeight=!0),"auto"===l.width&&(l.autoWidth=!0),"auto"===l.height&&(l.autoHeight=!0),l.group=s.group,l.index=e,s.coming=l,!1===s.trigger("beforeLoad"))return void(s.coming=null);if(o=l.type,i=l.href,!o)return s.coming=null,s.current&&s.router&&"jumpto"!==s.router?(s.current.index=e,s[s.router](s.direction)):!1;if(s.isActive=!0,("image"===o||"swf"===o)&&(l.autoHeight=l.autoWidth=!1,l.scrolling="visible"),"image"===o&&(l.aspectRatio=!0),"iframe"===o&&d&&(l.scrolling="scroll"),l.wrap=n(l.tpl.wrap).addClass("fancybox-"+(d?"mobile":"desktop")+" fancybox-type-"+o+" fancybox-tmp "+l.wrapCSS).appendTo(l.parent||"body"),n.extend(l,{skin:n(".fancybox-skin",l.wrap),outer:n(".fancybox-outer",l.wrap),inner:n(".fancybox-inner",l.wrap)}),n.each(["Top","Right","Bottom","Left"],function(e,t){l.skin.css("padding"+t,m(l.padding[e]))}),s.trigger("onReady"),"inline"===o||"html"===o){if(!l.content||!l.content.length)return s._error("content")}else if(!i)return s._error("href");"image"===o?s._loadImage():"ajax"===o?s._loadAjax():"iframe"===o?s._loadIframe():s._afterLoad()},_error:function(e){n.extend(s.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:e,content:s.coming.tpl.error}),s._afterLoad()},_loadImage:function(){var e=s.imgPreload=new Image;e.onload=function(){this.onload=this.onerror=null,s.coming.width=this.width/s.opts.pixelRatio,s.coming.height=this.height/s.opts.pixelRatio,s._afterLoad()},e.onerror=function(){this.onload=this.onerror=null,s._error("image")},e.src=s.coming.href,e.complete!==!0&&s.showLoading()},_loadAjax:function(){var e=s.coming;s.showLoading(),s.ajaxLoad=n.ajax(n.extend({},e.ajax,{url:e.href,error:function(e,t){s.coming&&"abort"!==t?s._error("ajax",e):s.hideLoading()},success:function(t,n){"success"===n&&(e.content=t,s._afterLoad())}}))},_loadIframe:function(){var e=s.coming,t=n(e.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",d?"auto":e.iframe.scrolling).attr("src",e.href);n(e.wrap).bind("onReset",function(){try{n(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(e){}}),e.iframe.preload&&(s.showLoading(),t.one("load",function(){n(this).data("ready",1),d||n(this).bind("load.fb",s.update),n(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),s._afterLoad()})),e.content=t.appendTo(e.inner),e.iframe.preload||s._afterLoad()},_preloadImages:function(){var e,t,n=s.group,i=s.current,o=n.length,a=i.preload?Math.min(i.preload,o-1):0;for(t=1;a>=t;t+=1)e=n[(i.index+t)%o],"image"===e.type&&e.href&&((new Image).src=e.href)},_afterLoad:function(){var e,t,i,o,a,r,l=s.coming,c=s.current,d="fancybox-placeholder";if(s.hideLoading(),l&&s.isActive!==!1){if(!1===s.trigger("afterLoad",l,c))return l.wrap.stop(!0).trigger("onReset").remove(),void(s.coming=null);switch(c&&(s.trigger("beforeChange",c),c.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),s.unbindEvents(),e=l,t=l.content,i=l.type,o=l.scrolling,n.extend(s,{wrap:e.wrap,skin:e.skin,outer:e.outer,inner:e.inner,current:e,previous:c}),a=e.href,i){case"inline":case"ajax":case"html":e.selector?t=n("<div>").html(t).find(e.selector):p(t)&&(t.data(d)||t.data(d,n('<div class="'+d+'"></div>').insertAfter(t).hide()),t=t.show().detach(),e.wrap.bind("onReset",function(){n(this).find(t).length&&t.hide().replaceAll(t.data(d)).data(d,!1)}));break;case"image":t=e.tpl.image.replace("{href}",a);break;case"swf":t='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+a+'"></param>',r="",n.each(e.swf,function(e,n){t+='<param name="'+e+'" value="'+n+'"></param>',r+=" "+e+'="'+n+'"'}),t+='<embed src="'+a+'" type="application/x-shockwave-flash" width="100%" height="100%"'+r+"></embed></object>"}p(t)&&t.parent().is(e.inner)||e.inner.append(t),s.trigger("beforeShow"),e.inner.css("overflow","yes"===o?"scroll":"no"===o?"hidden":o),s._setDimension(),s.reposition(),s.isOpen=!1,s.coming=null,s.bindEvents(),s.isOpened?c.prevMethod&&s.transitions[c.prevMethod]():n(".fancybox-wrap").not(e.wrap).stop(!0).trigger("onReset").remove(),s.transitions[s.isOpened?e.nextMethod:e.openMethod](),s._preloadImages()}},_setDimension:function(){var e,t,i,o,a,r,l,c,d,p,h,u,y,x,v,w=s.getViewport(),b=0,k=!1,C=!1,O=s.wrap,W=s.skin,_=s.inner,S=s.current,T=S.width,L=S.height,E=S.minWidth,R=S.minHeight,j=S.maxWidth,P=S.maxHeight,H=S.scrolling,M=S.scrollOutside?S.scrollbarWidth:0,A=S.margin,I=g(A[1]+A[3]),D=g(A[0]+A[2]);if(O.add(W).add(_).width("auto").height("auto").removeClass("fancybox-tmp"),e=g(W.outerWidth(!0)-W.width()),t=g(W.outerHeight(!0)-W.height()),i=I+e,o=D+t,a=f(T)?(w.w-i)*g(T)/100:T,r=f(L)?(w.h-o)*g(L)/100:L,"iframe"===S.type){if(x=S.content,S.autoHeight&&1===x.data("ready"))try{x[0].contentWindow.document.location&&(_.width(a).height(9999),v=x.contents().find("body"),M&&v.css("overflow-x","hidden"),r=v.outerHeight(!0))}catch(z){}}else(S.autoWidth||S.autoHeight)&&(_.addClass("fancybox-tmp"),S.autoWidth||_.width(a),S.autoHeight||_.height(r),S.autoWidth&&(a=_.width()),S.autoHeight&&(r=_.height()),_.removeClass("fancybox-tmp"));if(T=g(a),L=g(r),d=a/r,E=g(f(E)?g(E,"w")-i:E),j=g(f(j)?g(j,"w")-i:j),R=g(f(R)?g(R,"h")-o:R),P=g(f(P)?g(P,"h")-o:P),l=j,c=P,S.fitToView&&(j=Math.min(w.w-i,j),P=Math.min(w.h-o,P)),u=w.w-I,y=w.h-D,S.aspectRatio?(T>j&&(T=j,L=g(T/d)),L>P&&(L=P,T=g(L*d)),E>T&&(T=E,L=g(T/d)),R>L&&(L=R,T=g(L*d))):(T=Math.max(E,Math.min(T,j)),S.autoHeight&&"iframe"!==S.type&&(_.width(T),L=_.height()),L=Math.max(R,Math.min(L,P))),S.fitToView)if(_.width(T).height(L),O.width(T+e),p=O.width(),h=O.height(),S.aspectRatio)for(;(p>u||h>y)&&T>E&&L>R&&!(b++>19);)L=Math.max(R,Math.min(P,L-10)),T=g(L*d),E>T&&(T=E,L=g(T/d)),T>j&&(T=j,L=g(T/d)),_.width(T).height(L),O.width(T+e),p=O.width(),h=O.height();else T=Math.max(E,Math.min(T,T-(p-u))),L=Math.max(R,Math.min(L,L-(h-y)));M&&"auto"===H&&r>L&&u>T+e+M&&(T+=M),_.width(T).height(L),O.width(T+e),p=O.width(),h=O.height(),k=(p>u||h>y)&&T>E&&L>R,C=S.aspectRatio?l>T&&c>L&&a>T&&r>L:(l>T||c>L)&&(a>T||r>L),n.extend(S,{dim:{width:m(p),height:m(h)},origWidth:a,origHeight:r,canShrink:k,canExpand:C,wPadding:e,hPadding:t,wrapSpace:h-W.outerHeight(!0),skinSpace:W.height()-L}),!x&&S.autoHeight&&L>R&&P>L&&!C&&_.height("auto")},_getPosition:function(e){var t=s.current,n=s.getViewport(),i=t.margin,o=s.wrap.width()+i[1]+i[3],a=s.wrap.height()+i[0]+i[2],r={position:"absolute",top:i[0],left:i[3]};return t.autoCenter&&t.fixed&&!e&&a<=n.h&&o<=n.w?r.position="fixed":t.locked||(r.top+=n.y,r.left+=n.x),r.top=m(Math.max(r.top,r.top+(n.h-a)*t.topRatio)),r.left=m(Math.max(r.left,r.left+(n.w-o)*t.leftRatio)),r},_afterZoomIn:function(){var e=s.current;e&&(s.isOpen=s.isOpened=!0,s.wrap.css("overflow","visible").addClass("fancybox-opened"),s.update(),(e.closeClick||e.nextClick&&s.group.length>1)&&s.inner.css("cursor","pointer").bind("click.fb",function(t){n(t.target).is("a")||n(t.target).parent().is("a")||(t.preventDefault(),s[e.closeClick?"close":"next"]())}),e.closeBtn&&n(e.tpl.closeBtn).appendTo(s.skin).bind("click.fb",function(e){e.preventDefault(),s.close()}),e.arrows&&s.group.length>1&&((e.loop||e.index>0)&&n(e.tpl.prev).appendTo(s.outer).bind("click.fb",s.prev),(e.loop||e.index<s.group.length-1)&&n(e.tpl.next).appendTo(s.outer).bind("click.fb",s.next)),s.trigger("afterShow"),e.loop||e.index!==e.group.length-1?s.opts.autoPlay&&!s.player.isActive&&(s.opts.autoPlay=!1,s.play()):s.play(!1))},_afterZoomOut:function(e){e=e||s.current,n(".fancybox-wrap").trigger("onReset").remove(),n.extend(s,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),s.trigger("afterClose",e)}}),s.transitions={getOrigPosition:function(){var e=s.current,t=e.element,n=e.orig,i={},o=50,a=50,r=e.hPadding,l=e.wPadding,c=s.getViewport();return!n&&e.isDom&&t.is(":visible")&&(n=t.find("img:first"),n.length||(n=t)),p(n)?(i=n.offset(),n.is("img")&&(o=n.outerWidth(),a=n.outerHeight())):(i.top=c.y+(c.h-a)*e.topRatio,i.left=c.x+(c.w-o)*e.leftRatio),("fixed"===s.wrap.css("position")||e.locked)&&(i.top-=c.y,i.left-=c.x),i={top:m(i.top-r*e.topRatio),left:m(i.left-l*e.leftRatio),width:m(o+l),height:m(a+r)}},step:function(e,t){var n,i,o,a=t.prop,r=s.current,l=r.wrapSpace,c=r.skinSpace;("width"===a||"height"===a)&&(n=t.end===t.start?1:(e-t.start)/(t.end-t.start),s.isClosing&&(n=1-n),i="width"===a?r.wPadding:r.hPadding,o=e-i,s.skin[a](g("width"===a?o:o-l*n)),s.inner[a](g("width"===a?o:o-l*n-c*n)))},zoomIn:function(){var e=s.current,t=e.pos,i=e.openEffect,o="elastic"===i,a=n.extend({opacity:1},t);delete a.position,o?(t=this.getOrigPosition(),e.openOpacity&&(t.opacity=.1)):"fade"===i&&(t.opacity=.1),s.wrap.css(t).animate(a,{duration:"none"===i?0:e.openSpeed,easing:e.openEasing,step:o?this.step:null,complete:s._afterZoomIn})},zoomOut:function(){var e=s.current,t=e.closeEffect,n="elastic"===t,i={opacity:.1};n&&(i=this.getOrigPosition(),e.closeOpacity&&(i.opacity=.1)),s.wrap.animate(i,{duration:"none"===t?0:e.closeSpeed,easing:e.closeEasing,step:n?this.step:null,complete:s._afterZoomOut})},changeIn:function(){var e,t=s.current,n=t.nextEffect,i=t.pos,o={opacity:1},a=s.direction,r=200;i.opacity=.1,"elastic"===n&&(e="down"===a||"up"===a?"top":"left","down"===a||"right"===a?(i[e]=m(g(i[e])-r),o[e]="+="+r+"px"):(i[e]=m(g(i[e])+r),o[e]="-="+r+"px")),"none"===n?s._afterZoomIn():s.wrap.css(i).animate(o,{duration:t.nextSpeed,easing:t.nextEasing,complete:s._afterZoomIn})},changeOut:function(){var e=s.previous,t=e.prevEffect,i={opacity:.1},o=s.direction,a=200;"elastic"===t&&(i["down"===o||"up"===o?"top":"left"]=("up"===o||"left"===o?"-":"+")+"="+a+"px"),e.wrap.animate(i,{duration:"none"===t?0:e.prevSpeed,easing:e.prevEasing,complete:function(){n(this).trigger("onReset").remove()}})}},s.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!d,fixed:!0},overlay:null,fixed:!1,el:n("html"),create:function(e){e=n.extend({},this.defaults,e),this.overlay&&this.close(),this.overlay=n('<div class="fancybox-overlay"></div>').appendTo(s.coming?s.coming.parent:e.parent),this.fixed=!1,e.fixed&&s.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(e){var t=this;e=n.extend({},this.defaults,e),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(e),this.fixed||(a.bind("resize.overlay",n.proxy(this.update,this)),this.update()),e.closeClick&&this.overlay.bind("click.overlay",function(e){return n(e.target).hasClass("fancybox-overlay")?(s.isActive?s.close():t.close(),!1):void 0}),this.overlay.css(e.css).show()},close:function(){var e,t;a.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(n(".fancybox-margin").removeClass("fancybox-margin"),e=a.scrollTop(),t=a.scrollLeft(),this.el.removeClass("fancybox-lock"),a.scrollTop(e).scrollLeft(t)),n(".fancybox-overlay").remove().hide(),n.extend(this,{overlay:null,fixed:!1})},update:function(){var e,n="100%";this.overlay.width(n).height("100%"),l?(e=Math.max(t.documentElement.offsetWidth,t.body.offsetWidth),r.width()>e&&(n=r.width())):r.width()>a.width()&&(n=r.width()),this.overlay.width(n).height(r.height())},onReady:function(e,t){var i=this.overlay;n(".fancybox-overlay").stop(!0,!0),i||this.create(e),e.locked&&this.fixed&&t.fixed&&(i||(this.margin=r.height()>a.height()?n("html").css("margin-right").replace("px",""):!1),t.locked=this.overlay.append(t.wrap),t.fixed=!1),e.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(e,t){var i,o;t.locked&&(this.margin!==!1&&(n("*").filter(function(){return"fixed"===n(this).css("position")&&!n(this).hasClass("fancybox-overlay")&&!n(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),i=a.scrollTop(),o=a.scrollLeft(),this.el.addClass("fancybox-lock"),a.scrollTop(i).scrollLeft(o)),this.open(e)},onUpdate:function(){this.fixed||this.update()},afterClose:function(e){this.overlay&&!s.coming&&this.overlay.fadeOut(e.speedOut,n.proxy(this.close,this))}},s.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(e){var t,i,o=s.current,a=o.title,r=e.type;if(n.isFunction(a)&&(a=a.call(o.element,o)),h(a)&&""!==n.trim(a)){switch(t=n('<div class="fancybox-title fancybox-title-'+r+'-wrap">'+a+"</div>"),r){case"inside":i=s.skin;break;case"outside":i=s.wrap;break;case"over":i=s.inner;break;default:i=s.skin,t.appendTo("body"),l&&t.width(t.width()),t.wrapInner('<span class="child"></span>'),s.current.margin[2]+=Math.abs(g(t.css("margin-bottom")))}t["top"===e.position?"prependTo":"appendTo"](i)}}},n.fn.fancybox=function(e){var t,i=n(this),o=this.selector||"",a=function(a){var r,l,c=n(this).blur(),d=t;a.ctrlKey||a.altKey||a.shiftKey||a.metaKey||c.is(".fancybox-wrap")||(r=e.groupAttr||"data-fancybox-group",l=c.attr(r),l||(r="rel",l=c.get(0)[r]),l&&""!==l&&"nofollow"!==l&&(c=o.length?n(o):i,c=c.filter("["+r+'="'+l+'"]'),d=c.index(this)),e.index=d,s.open(c,e)!==!1&&a.preventDefault())};return e=e||{},t=e.index||0,o&&e.live!==!1?r.undelegate(o,"click.fb-start").delegate(o+":not('.fancybox-item, .fancybox-nav')","click.fb-start",a):i.unbind("click.fb-start").bind("click.fb-start",a),this.filter("[data-fancybox-start=1]").trigger("click"),this},r.ready(function(){var t,a;n.scrollbarWidth===i&&(n.scrollbarWidth=function(){var e=n('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),i=t.innerWidth()-t.height(99).innerWidth();return e.remove(),i}),n.support.fixedPosition===i&&(n.support.fixedPosition=function(){var e=n('<div style="position:fixed;top:20px;"></div>').appendTo("body"),t=20===e[0].offsetTop||15===e[0].offsetTop;return e.remove(),t}()),n.extend(s.defaults,{scrollbarWidth:n.scrollbarWidth(),fixed:n.support.fixedPosition,parent:n("body")}),t=n(e).width(),o.addClass("fancybox-lock-test"),a=n(e).width(),o.removeClass("fancybox-lock-test"),n("<style type='text/css'>.fancybox-margin{margin-right:"+(a-t)+"px;}</style>").appendTo("head")})}(window,document,jQuery);